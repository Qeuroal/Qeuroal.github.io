<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/avatar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.css" integrity="sha256-vQkngPS8jiHHH0I6ABTZroZk8NPZ7b+MUReOFE9UsXQ=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"qeuroal.top","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ssh key1ssh-keygen -t ed25519 -C &quot;comment&quot; -f file_name -N &#x27;&#x27; -q  选项说明 -t 选项（默认 rsa） 生成的密钥类型（不带默认为 rsa）, 类型有四种分别是 dsa | ecdsa | ed25519 | rsa  dsa 因安全性不高, 基本已经不再使用. ecdsa 因技术原因等, 基">
<meta property="og:type" content="article">
<meta property="og:title" content="77. Git 使用">
<meta property="og:url" content="http://qeuroal.top/2019/11/10/77/index.html">
<meta property="og:site_name" content="Qeuroal&#39;s Blog">
<meta property="og:description" content="ssh key1ssh-keygen -t ed25519 -C &quot;comment&quot; -f file_name -N &#x27;&#x27; -q  选项说明 -t 选项（默认 rsa） 生成的密钥类型（不带默认为 rsa）, 类型有四种分别是 dsa | ecdsa | ed25519 | rsa  dsa 因安全性不高, 基本已经不再使用. ecdsa 因技术原因等, 基">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0.jpeg">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0-20240120103356170.jpeg">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0-20240120103403910.jpeg">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0.png">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0-20240120144922049.png">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0-20240120151440047.png">
<meta property="og:image" content="http://qeuroal.top/2019/11/10/77/0-20240120151448264.png">
<meta property="article:published_time" content="2019-11-09T21:00:00.000Z">
<meta property="article:modified_time" content="2025-12-08T06:36:59.655Z">
<meta property="article:author" content="Qeuroal">
<meta property="article:tag" content="git">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://qeuroal.top/2019/11/10/77/0.jpeg">


<link rel="canonical" href="http://qeuroal.top/2019/11/10/77/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://qeuroal.top/2019/11/10/77/","path":"2019/11/10/77/","title":"77. Git 使用"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>77. Git 使用 | Qeuroal's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Qeuroal's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">静幽正治</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ssh-key"><span class="nav-number">1.</span> <span class="nav-text">ssh key</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E9%A1%B9%E8%AF%B4%E6%98%8E"><span class="nav-number">1.1.</span> <span class="nav-text">选项说明</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5Github"><span class="nav-number">2.</span> <span class="nav-text">连接Github</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#git%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">git简单使用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEvimdiff"><span class="nav-number">4.</span> <span class="nav-text">设置vimdiff</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%89%88%E6%9C%AC%E5%BA%93"><span class="nav-number">5.</span> <span class="nav-text">创建版本库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#init"><span class="nav-number">5.1.</span> <span class="nav-text">init</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#status"><span class="nav-number">5.2.</span> <span class="nav-text">status</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#add"><span class="nav-number">5.3.</span> <span class="nav-text">add</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#commit"><span class="nav-number">5.4.</span> <span class="nav-text">commit</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#diff"><span class="nav-number">5.5.</span> <span class="nav-text">diff</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%97%B6%E5%85%89%E7%A9%BF%E6%A2%AD%E6%9C%BA"><span class="nav-number">6.</span> <span class="nav-text">时光穿梭机</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E5%9B%9E%E9%80%80"><span class="nav-number">6.1.</span> <span class="nav-text">版本回退</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="nav-number">6.1.1.</span> <span class="nav-text">查看历史记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E5%9B%9E%E9%80%80-1"><span class="nav-number">6.1.2.</span> <span class="nav-text">版本回退</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">6.1.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E5%8C%BA%E4%B8%8E%E6%9A%82%E5%AD%98%E5%8C%BA"><span class="nav-number">6.2.</span> <span class="nav-text">工作区与暂存区</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E4%BD%9C%E5%8C%BA%EF%BC%88Working-Directory%EF%BC%89"><span class="nav-number">6.2.1.</span> <span class="nav-text">工作区（Working Directory）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E5%BA%93%EF%BC%88Repository%EF%BC%89"><span class="nav-number">6.2.2.</span> <span class="nav-text">版本库（Repository）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B"><span class="nav-number">6.2.3.</span> <span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%A1%E7%90%86%E4%BF%AE%E6%94%B9"><span class="nav-number">6.3.</span> <span class="nav-text">管理修改</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%92%A4%E9%94%80%E4%BF%AE%E6%94%B9"><span class="nav-number">6.4.</span> <span class="nav-text">撤销修改</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#add%E5%89%8D%E6%92%A4%E9%94%80"><span class="nav-number">6.4.1.</span> <span class="nav-text">add前撤销</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#add%E5%90%8E%E6%92%A4%E9%94%80"><span class="nav-number">6.4.2.</span> <span class="nav-text">add后撤销</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#comit%E5%90%8E%E6%92%A4%E9%94%80"><span class="nav-number">6.4.3.</span> <span class="nav-text">comit后撤销</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">6.4.4.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="nav-number">6.5.</span> <span class="nav-text">删除文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#case1-%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6"><span class="nav-number">6.5.1.</span> <span class="nav-text">case1: 删除文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case2-%E8%AF%AF%E5%88%A0%E6%96%87%E4%BB%B6"><span class="nav-number">6.5.2.</span> <span class="nav-text">case2: 误删文件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93"><span class="nav-number">7.</span> <span class="nav-text">远程仓库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93"><span class="nav-number">7.1.</span> <span class="nav-text">添加远程仓库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAGitHub%E4%BB%93%E5%BA%93"><span class="nav-number">7.1.1.</span> <span class="nav-text">创建GitHub仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E4%BB%93%E5%BA%93"><span class="nav-number">7.1.2.</span> <span class="nav-text">连接仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E9%80%81%E5%86%85%E5%AE%B9"><span class="nav-number">7.1.3.</span> <span class="nav-text">推送内容</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%BF%9C%E7%A8%8B%E5%BA%93"><span class="nav-number">7.2.</span> <span class="nav-text">删除远程库</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86"><span class="nav-number">8.</span> <span class="nav-text">分支管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6%E5%88%86%E6%94%AF"><span class="nav-number">8.1.</span> <span class="nav-text">创建与合并分支</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BD%A2%E8%B1%A1%E5%8C%96%E6%8F%8F%E8%BF%B0"><span class="nav-number">8.1.1.</span> <span class="nav-text">形象化描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E6%88%98"><span class="nav-number">8.1.2.</span> <span class="nav-text">实战</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%B9%B6%E5%88%87%E6%8D%A2%E5%88%B0dev%E5%88%86%E6%94%AF"><span class="nav-number">8.1.2.1.</span> <span class="nav-text">创建并切换到dev分支</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#switch"><span class="nav-number">8.1.2.2.</span> <span class="nav-text">switch</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-1"><span class="nav-number">8.1.3.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3%E5%86%B2%E7%AA%81"><span class="nav-number">8.2.</span> <span class="nav-text">解决冲突</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-2"><span class="nav-number">8.2.1.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86%E7%AD%96%E7%95%A5"><span class="nav-number">8.3.</span> <span class="nav-text">分支管理策略</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%94%AF%E7%AD%96%E7%95%A5"><span class="nav-number">8.3.1.</span> <span class="nav-text">分支策略</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93-3"><span class="nav-number">8.3.2.</span> <span class="nav-text">小结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#API%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">9.</span> <span class="nav-text">API的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%80%E6%96%B0Releases%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7"><span class="nav-number">9.1.</span> <span class="nav-text">获取最新Releases的版本号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">9.2.</span> <span class="nav-text">代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E9%87%8A"><span class="nav-number">9.3.</span> <span class="nav-text">代码解释</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BF%BD%E7%95%A5%E7%89%B9%E6%AE%8A%E6%96%87%E4%BB%B6"><span class="nav-number">10.</span> <span class="nav-text">忽略特殊文件</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA-SSH-Key"><span class="nav-number">11.</span> <span class="nav-text">配置多个 SSH Key</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%83%8C%E6%99%AF"><span class="nav-number">11.1.</span> <span class="nav-text">背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAssh-key"><span class="nav-number">11.2.</span> <span class="nav-text">创建ssh-key</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEssh%E4%BB%A3%E7%90%86"><span class="nav-number">11.3.</span> <span class="nav-text">配置ssh代理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E5%85%AC%E9%92%A5"><span class="nav-number">11.4.</span> <span class="nav-text">添加公钥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEconfig"><span class="nav-number">11.5.</span> <span class="nav-text">配置config</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81ssh-key"><span class="nav-number">11.6.</span> <span class="nav-text">验证ssh-key</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-number">11.7.</span> <span class="nav-text">使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%89%E5%8F%96%E4%BB%A3%E7%A0%81"><span class="nav-number">11.7.1.</span> <span class="nav-text">拉取代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E4%B8%AAgit%E8%B4%A6%E6%88%B7%E7%9A%84%E6%8F%90%E4%BA%A4%E9%97%AE%E9%A2%98"><span class="nav-number">11.7.2.</span> <span class="nav-text">多个git账户的提交问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%8B%E9%9A%86%E5%90%AB%E6%9C%89%E5%AD%90%E6%A8%A1%E5%9D%97%E7%9A%84%E9%A1%B9%E7%9B%AE"><span class="nav-number">12.</span> <span class="nav-text">克隆含有子模块的项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">12.1.</span> <span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">12.2.</span> <span class="nav-text">方法二</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">12.3.</span> <span class="nav-text">其他</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#submodule-%E7%9B%B8%E5%85%B3"><span class="nav-number">13.</span> <span class="nav-text">submodule 相关</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Qeuroal"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Qeuroal</p>
  <div class="site-description" itemprop="description">大人者，不失其赤子之心</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">188</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Qeuroal" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Qeuroal" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://qeuroal.top/2019/11/10/77/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Qeuroal">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Qeuroal's Blog">
      <meta itemprop="description" content="大人者，不失其赤子之心">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="77. Git 使用 | Qeuroal's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          77. Git 使用
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-11-10 05:00:00" itemprop="dateCreated datePublished" datetime="2019-11-10T05:00:00+08:00">2019-11-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-12-08 14:36:59" itemprop="dateModified" datetime="2025-12-08T14:36:59+08:00">2025-12-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/software/" itemprop="url" rel="index"><span itemprop="name">software</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="ssh-key"><a href="#ssh-key" class="headerlink" title="ssh key"></a>ssh key</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -C <span class="string">&quot;comment&quot;</span> -f file_name -N <span class="string">&#x27;&#x27;</span> -q</span><br></pre></td></tr></table></figure>

<h2 id="选项说明"><a href="#选项说明" class="headerlink" title="选项说明"></a>选项说明</h2><ul>
<li><p><code>-t</code> 选项（默认 rsa）</p>
<p>生成的密钥类型（不带默认为 rsa）, 类型有四种分别是 dsa | ecdsa | ed25519 | rsa</p>
<ul>
<li>dsa 因安全性不高, 基本已经不再使用.</li>
<li>ecdsa 因技术原因等, 基本已经不再使用.</li>
<li>ed25519 加解密速度快, 生成时间快, 且安全性更高.</li>
<li>rsa 加解密速度慢, 生成时间慢, 安全性没有 ed25519 高. (用的人多兼容性好）</li>
</ul>
</li>
<li><p>-b 选项</p>
<p>表示生成的密钥的大小（以字节：byte 为单位）<br>在生成时如果指定的 key size 太小也会有安全的问题, 建议指定 key size 为 2048 或更大.</p>
</li>
<li><p>-C 选项</p>
<p>生成密钥的描述信息. （会追加到公钥.pub 内容的末尾）</p>
</li>
<li><p>-f 选项</p>
<p>文件名称, 或者文件路径.</p>
</li>
<li><p>-N 选项</p>
<p>指定新密码, ‘’ 表示密码为空.</p>
</li>
<li><p>-q 选项</p>
<p>静默模式, 直接生成密钥对, 不现实过程中产生的信息.</p>
</li>
</ul>
<h1 id="连接Github"><a href="#连接Github" class="headerlink" title="连接Github"></a>连接Github</h1><ol>
<li><p>在 <code>terminal</code> 输入 <code>ssh-keygen</code></p>
</li>
<li><p>进入 <code>~/.ssh</code></p>
</li>
<li><p><code>id_rsa</code> 是 私钥</p>
</li>
<li><p><code>id_rsa.pub</code> 是 公钥</p>
</li>
<li><p>将公钥复制到 <code>Github</code>下</p>
<ol>
<li>点击头像, 选择 <code>Setting</code></li>
<li>选择 <code>SSH and GPG keys</code></li>
<li>选择 <code>New SSH key</code></li>
<li>Title 可以自己写; <code>Key</code> 中复制你的公钥</li>
<li>选择 <code>Add SSH key</code></li>
<li>下面就可以访问了</li>
</ol>
</li>
</ol>
<h1 id="git简单使用"><a href="#git简单使用" class="headerlink" title="git简单使用"></a>git简单使用</h1><ol>
<li><p>将git下载到本地 <code>git clone &lt;你的仓库地址&gt;</code></p>
</li>
<li><p>cd 进入 对应的文件夹</p>
</li>
<li><p><code>git pull</code> 更新你的仓库</p>
</li>
<li><p><code>git status</code> 以查看在你上次提交之后是否有修改</p>
<p>该命令加了 <code>-s</code> 参数, 以获得简短的结果输出. 如果没加该参数会详细输出内容.</p>
</li>
<li><p><code>git add</code> 将该文件添加到缓存</p>
<ul>
<li><code>git add *</code> 将所有更改的文件, 添加进暂存</li>
<li><code>git add &lt;文件名&gt;</code> 将对应的文件添加进暂存</li>
</ul>
</li>
<li><p><code>git commit -m &quot;备注&quot;</code> 使用 git add 命令将想要快照的内容写入缓存区,  而执行 git commit 将缓存区内容添加到仓库中.</p>
</li>
<li><p><code>git push</code> 将本地库中的最新信息发送给远程库.</p>
</li>
</ol>
<blockquote>
<p><strong>Notes</strong></p>
<ol>
<li><p>若已经有文件：</p>
<ol>
<li>创建完git连接之后, 先 <code>git pull</code> 一下.</li>
</ol>
</li>
<li><p><code>commit</code> 和 <code>push</code> 的区别</p>
<ol>
<li><p>git作为支持分布式版本管理的工具, 它管理的库（repository）分为本地库、远程库.</p>
</li>
<li><p>git commit操作的是本地库, git push操作的是远程库.</p>
</li>
<li><p>git commit是将本地修改过的文件提交到本地库中.</p>
</li>
<li><p>git push是将本地库中的最新信息发送给远程库.</p>
</li>
<li><p>那有人就会问, 为什么要分本地commit和服务器的push呢？</p>
</li>
</ol>
<blockquote>
<p>因为如果本地不commit的话, 修改的纪录可能会丢失. 而有些修改当前是不需要同步至服务器的, 所以什么时候同步过去由用户自己选择. 什么时候需要同步再push到服务器</p>
</blockquote>
</li>
</ol>
</blockquote>
<h1 id="设置vimdiff"><a href="#设置vimdiff" class="headerlink" title="设置vimdiff"></a>设置vimdiff</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git config --global diff.tool nvimdiff</span><br><span class="line">git config --global difftool.prompt <span class="literal">false</span></span><br><span class="line">git config --global alias.vd difftool</span><br></pre></td></tr></table></figure>

<blockquote>
<p>gitdiff 在打开每一个文件的 diff 时都会进行输入确认, 设置 <code>difftool.prompt</code> 可以禁用这一行为.<br>给 difftool 起个别名 vd</p>
</blockquote>
<p>此后使用 git difftool 时 Git 便会调用 vimdiff 逐一打开每个文件的 Diff. 查看完成一个文件的 diff 后使用 <code>:qa</code> 关闭该文件 diff.<br>这时 Git 会自动打开下一个文件的 diff. 如果中止本次 Diff 呢？首先需要让 Git 信任 difftool 的返回码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global difftool.trustExitCode <span class="literal">true</span></span><br><span class="line">git config --global mergetool.trustExitCode <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>然后让 vimdiff 返回 1：<code>:cq</code> (<code>:help cquit</code>) 退出 Vim.</p>
<h1 id="创建版本库"><a href="#创建版本库" class="headerlink" title="创建版本库"></a>创建版本库</h1><h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><p><code>git init</code> 命令把这个目录变成Git可以管理的仓库</p>
<p>也不一定必须在空目录下创建Git仓库, 选择一个已经有东西的目录也是可以的.</p>
<h2 id="status"><a href="#status" class="headerlink" title="status"></a>status</h2><p>运行<code>git status</code>命令查看仓库当前状态</p>
<p><code>git status</code>命令可以让我们时刻掌握仓库当前的状态</p>
<h2 id="add"><a href="#add" class="headerlink" title="add"></a>add</h2><p>命令<code>git add</code>告诉Git, 把文件添加到仓库</p>
<h2 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h2><p>命令<code>git commit</code>告诉Git, 把文件提交到仓库</p>
<p><code>-m</code>后面输入的是本次提交的说明, 可以输入任意内容, 当然最好是有意义的, 这样你就能从历史记录里方便地找到改动记录.</p>
<h2 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h2><p><code>git diff</code>顾名思义就是查看difference, 显示的格式正是Unix通用的diff格式, 看具体修改了什么内容</p>
<h1 id="时光穿梭机"><a href="#时光穿梭机" class="headerlink" title="时光穿梭机"></a>时光穿梭机</h1><h2 id="版本回退"><a href="#版本回退" class="headerlink" title="版本回退"></a>版本回退</h2><p>你不断对文件进行修改, 然后不断提交修改到版本库里, 就好比玩RPG游戏时, 每通过一关就会自动把游戏状态存盘, 如果某一关没过去, 你还可以选择读取前一关的状态. 有些时候, 在打Boss之前, 你会手动存盘, 以便万一打Boss失败了, 可以从最近的地方重新开始. Git也是一样, 每当你觉得文件修改到一定程度的时候, 就可以“保存一个快照”, 这个快照在Git中被称为<code>commit</code>. 一旦你把文件改乱了, 或者误删了文件, 还可以从最近的一个<code>commit</code>恢复, 然后继续工作, 而不是把几个月的工作成果全部丢失.</p>
<h3 id="查看历史记录"><a href="#查看历史记录" class="headerlink" title="查看历史记录"></a>查看历史记录</h3><p>在实际工作中, 我们脑子里怎么可能记得一个几千行的文件每次都改了什么内容, 不然要版本控制系统干什么. 版本控制系统肯定有某个命令可以告诉我们历史记录, 在Git中, 我们用<code>git log</code>命令查看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 1094adb7b9b3807259d8cb349e7df1d4d6477073 (HEAD -&gt; master)</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 21:06:15 2018 +0800</span><br><span class="line"></span><br><span class="line">    append GPL</span><br><span class="line"></span><br><span class="line">commit e475afc93c209a690c39c13a46716e8fa000c366</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 21:03:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add distributed</span><br><span class="line"></span><br><span class="line">commit eaadf4e385e865d25c48e7ca9c8395c3f7dfaef0</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 20:59:18 2018 +0800</span><br><span class="line"></span><br><span class="line">    wrote a readme file</span><br></pre></td></tr></table></figure>

<p><code>git log</code>命令显示从最近到最远的提交日志, 我们可以看到3次提交, 最近的一次是<code>append GPL</code>, 上一次是<code>add distributed</code>, 最早的一次是<code>wrote a readme file</code>.</p>
<p>如果嫌输出信息太多, 看得眼花缭乱的, 可以试试加上<code>--pretty=oneline</code>参数：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --pretty=oneline</span><br><span class="line">1094adb7b9b3807259d8cb349e7df1d4d6477073 (HEAD -&gt; master) append GPL</span><br><span class="line">e475afc93c209a690c39c13a46716e8fa000c366 add distributed</span><br><span class="line">eaadf4e385e865d25c48e7ca9c8395c3f7dfaef0 wrote a readme file</span><br></pre></td></tr></table></figure>

<p>需要友情提示的是, 你看到的一大串类似<code>1094adb...</code>的是<code>commit id</code>（版本号）, 和SVN不一样, Git的<code>commit id</code>不是1, 2, 3……递增的数字, 而是一个SHA1计算出来的一个非常大的数字, 用十六进制表示, 而且你看到的<code>commit id</code>和我的肯定不一样, 以你自己的为准. 为什么<code>commit id</code>需要用这么一大串数字表示呢？因为Git是分布式的版本控制系统, 后面我们还要研究多人在同一个版本库里工作, 如果大家都用1, 2, 3……作为版本号, 那肯定就冲突了.</p>
<p>每提交一个新版本, 实际上Git就会把它们自动串成一条时间线. 如果使用可视化工具查看Git历史, 就可以更清楚地看到提交历史的时间线</p>
<h3 id="版本回退-1"><a href="#版本回退-1" class="headerlink" title="版本回退"></a>版本回退</h3><p>准备把<code>readme.txt</code>回退到上一个版本, 也就是<code>add distributed</code>的那个版本</p>
<p>首先, Git必须知道当前版本是哪个版本, 在Git中, 用<code>HEAD</code>表示当前版本, 也就是最新的提交<code>1094adb...</code>（注意我的提交ID和你的肯定不一样）, 上一个版本就是<code>HEAD^</code>, 上上一个版本就是<code>HEAD^^</code>, 当然往上100个版本写100个<code>^</code>比较容易数不过来, 所以写成<code>HEAD~100</code>.</p>
<p>现在, 我们要把当前版本<code>append GPL</code>回退到上一个版本<code>add distributed</code>, 就可以使用<code>git reset</code>命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard HEAD^</span><br><span class="line">HEAD is now at e475afc add distributed</span><br></pre></td></tr></table></figure>

<p><code>--hard</code>参数有啥意义？这个后面再讲, 现在你先放心使用.</p>
<p>还可以继续回退到上一个版本<code>wrote a readme file</code>, 不过且慢, 让我们用<code>git log</code>再看看现在版本库的状态：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit e475afc93c209a690c39c13a46716e8fa000c366 (HEAD -&gt; master)</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 21:03:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add distributed</span><br><span class="line"></span><br><span class="line">commit eaadf4e385e865d25c48e7ca9c8395c3f7dfaef0</span><br><span class="line">Author: Michael Liao &lt;askxuefeng@gmail.com&gt;</span><br><span class="line">Date:   Fri May 18 20:59:18 2018 +0800</span><br><span class="line"></span><br><span class="line">    wrote a readme file</span><br></pre></td></tr></table></figure>

<p>最新的那个版本<code>append GPL</code>已经看不到了！好比你从21世纪坐时光穿梭机来到了19世纪, 想再回去已经回不去了, 肿么办？</p>
<p>办法其实还是有的, 只要上面的命令行窗口还没有被关掉, 你就可以顺着往上找啊找啊, 找到那个<code>append GPL</code>的<code>commit id</code>是<code>1094adb...</code>, 于是就可以指定回到未来的某个版本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git reset --hard 1094a</span><br><span class="line">HEAD is now at 83b0afe append GPL</span><br></pre></td></tr></table></figure>

<p>版本号没必要写全, 前几位就可以了, Git会自动去找. 当然也不能只写前一两位, 因为Git可能会找到多个版本号, 就无法确定是哪一个了.</p>
<p>再小心翼翼地看看<code>readme.txt</code>的内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> readme.txt</span><br><span class="line">Git is a distributed version control system.</span><br><span class="line">Git is free software distributed under the GPL.</span><br></pre></td></tr></table></figure>

<p>果然, 我胡汉三又回来了.</p>
<p>Git的版本回退速度非常快, 因为Git在内部有个指向当前版本的<code>HEAD</code>指针, 当你回退版本的时候, Git仅仅是把HEAD从指向<code>append GPL</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌────┐</span><br><span class="line">│HEAD│</span><br><span class="line">└────┘</span><br><span class="line">   │</span><br><span class="line">   └──▶ ○ append GPL</span><br><span class="line">        │</span><br><span class="line">        ○ add distributed</span><br><span class="line">        │</span><br><span class="line">        ○ wrote a readme file</span><br></pre></td></tr></table></figure>

<p>改为指向<code>add distributed</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌────┐</span><br><span class="line">│HEAD│</span><br><span class="line">└────┘</span><br><span class="line">   │</span><br><span class="line">   │    ○ append GPL</span><br><span class="line">   │    │</span><br><span class="line">   └──▶ ○ add distributed</span><br><span class="line">        │</span><br><span class="line">        ○ wrote a readme file</span><br></pre></td></tr></table></figure>

<p>然后顺便把工作区的文件更新了. 所以你让<code>HEAD</code>指向哪个版本号, 你就把当前版本定位在哪.</p>
<p>现在, 你回退到了某个版本, 关掉了电脑, 第二天早上就后悔了, 想恢复到新版本怎么办？找不到新版本的<code>commit id</code>怎么办？</p>
<p>在Git中, 总是有后悔药可以吃的. 当你用<code>$ git reset --hard HEAD^</code>回退到<code>add distributed</code>版本时, 再想恢复到<code>append GPL</code>, 就必须找到<code>append GPL</code>的commit id. Git提供了一个命令<code>git reflog</code>用来记录你的每一次命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git reflog</span><br><span class="line">e475afc HEAD@&#123;1&#125;: reset: moving to HEAD^</span><br><span class="line">1094adb (HEAD -&gt; master) HEAD@&#123;2&#125;: commit: append GPL</span><br><span class="line">e475afc HEAD@&#123;3&#125;: commit: add distributed</span><br><span class="line">eaadf4e HEAD@&#123;4&#125;: commit (initial): wrote a readme file</span><br></pre></td></tr></table></figure>

<p>终于舒了口气, 从输出可知, <code>append GPL</code>的commit id是<code>1094adb</code>, 现在, 你又可以乘坐时光机回到未来了.</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li><code>HEAD</code>指向的版本就是当前版本, 因此, Git允许我们在版本的历史之间穿梭, 使用命令<code>git reset --hard commit_id</code>.</li>
<li>穿梭前, 用<code>git log</code>可以查看提交历史, 以便确定要回退到哪个版本.</li>
<li>要重返未来, 用<code>git reflog</code>查看命令历史, 以便确定要回到未来的哪个版本.</li>
</ul>
<h2 id="工作区与暂存区"><a href="#工作区与暂存区" class="headerlink" title="工作区与暂存区"></a>工作区与暂存区</h2><h3 id="工作区（Working-Directory）"><a href="#工作区（Working-Directory）" class="headerlink" title="工作区（Working Directory）"></a>工作区（Working Directory）</h3><p>就是你在电脑里能看到的目录, 比如我的<code>learngit</code>文件夹就是一个工作区：</p>
<h3 id="版本库（Repository）"><a href="#版本库（Repository）" class="headerlink" title="版本库（Repository）"></a>版本库（Repository）</h3><p>工作区有一个隐藏目录<code>.git</code>, 这个不算工作区, 而是Git的版本库.</p>
<p>Git的版本库里存了很多东西, 其中最重要的就是称为stage（或者叫index）的暂存区, 还有Git为我们自动创建的第一个分支<code>master</code>, 以及指向<code>master</code>的一个指针叫<code>HEAD</code>.</p>
<img data-src="/2019/11/10/77/0.jpeg" class="" title="git-repo">

<p>分支和<code>HEAD</code>的概念我们以后再讲.</p>
<p>前面讲了我们把文件往Git版本库里添加的时候, 是分两步执行的：</p>
<p>第一步是用<code>git add</code>把文件添加进去, 实际上就是把文件修改添加到暂存区；</p>
<p>第二步是用<code>git commit</code>提交更改, 实际上就是把暂存区的所有内容提交到当前分支.</p>
<p>因为我们创建Git版本库时, Git自动为我们创建了唯一一个<code>master</code>分支, 所以, 现在, <code>git commit</code>就是往<code>master</code>分支上提交更改.</p>
<p>你可以简单理解为, <strong>需要提交的文件修改通通放到暂存区, 然后, 一次性提交暂存区的所有修改.</strong></p>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>现在, 使用两次命令<code>git add</code>, 把<code>readme.txt</code>和<code>LICENSE</code>都添加后, 用<code>git status</code>再查看一下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use <span class="string">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage)</span><br><span class="line"></span><br><span class="line">   new file:   LICENSE</span><br><span class="line">   modified:   readme.txt</span><br></pre></td></tr></table></figure>

<p>所以, <code>git add</code>命令实际上就是把要提交的所有修改放到暂存区（Stage）, 然后, 执行<code>git commit</code>就可以一次性把暂存区的所有修改提交到分支.</p>
<img data-src="/2019/11/10/77/0-20240120103356170.jpeg" class="" title="git-stage">

<p>一旦提交后, 如果你又没有对工作区做任何修改, 那么工作区就是“干净”的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">nothing to commit, working tree clean</span><br></pre></td></tr></table></figure>

<p>现在版本库变成了这样, 暂存区就没有任何内容了：</p>
<img data-src="/2019/11/10/77/0-20240120103403910.jpeg" class="" title="git-stage-after-commit">

<h2 id="管理修改"><a href="#管理修改" class="headerlink" title="管理修改"></a>管理修改</h2><p>什么是修改？比如你新增了一行, 这就是一个修改, 删除了一行, 也是一个修改, 更改了某些字符, 也是一个修改, 删了一些又加了一些, 也是一个修改, 甚至创建一个新文件, 也算一个修改.</p>
<p>现有操作过程：</p>
<p>第一次修改 -&gt; <code>git add</code> -&gt; 第二次修改 -&gt; <code>git commit</code></p>
<p>Git管理的是修改, 当你用<code>git add</code>命令后, 在工作区的第一次修改被放入暂存区, 准备提交, 但是, 在工作区的第二次修改并没有放入暂存区, 所以, <code>git commit</code>只负责把暂存区的修改提交了, 也就是第一次的修改被提交了, 第二次的修改不会被提交.</p>
<p><code>git diff HEAD -- readme.txt</code>命令可以查看工作区和版本库里面最新版本的区别</p>
<p>你可以继续<code>git add</code>再<code>git commit</code>, 也可以别着急提交第一次修改, 先<code>git add</code>第二次修改, 再<code>git commit</code>, 就相当于把两次修改合并后一块提交了：</p>
<p>第一次修改 -&gt; <code>git add</code> -&gt; 第二次修改 -&gt; <code>git add</code> -&gt; <code>git commit</code></p>
<h2 id="撤销修改"><a href="#撤销修改" class="headerlink" title="撤销修改"></a>撤销修改</h2><h3 id="add前撤销"><a href="#add前撤销" class="headerlink" title="add前撤销"></a>add前撤销</h3><p>在准备提交前, 发现了错误. 既然错误发现得很及时, 就可以很容易地纠正它. 你可以删掉最后一行, 手动把文件恢复到上一个版本的状态. 如果用<code>git status</code>查看一下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">  modified:   readme.txt</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">&quot;git add&quot;</span> and/or <span class="string">&quot;git commit -a&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>你可以发现, Git会告诉你, <code>git checkout -- file</code>可以丢弃工作区的修改：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -- readme.txt</span><br></pre></td></tr></table></figure>

<p>命令<code>git checkout -- readme.txt</code>意思就是, 把<code>readme.txt</code>文件在工作区的修改全部撤销, 这里有两种情况：</p>
<p>一种是<code>readme.txt</code>自修改后还没有被放到暂存区, 现在, 撤销修改就回到和版本库一模一样的状态；</p>
<p>一种是<code>readme.txt</code>已经添加到暂存区后, 又作了修改, 现在, 撤销修改就回到添加到暂存区后的状态.</p>
<p>总之, 就是让这个文件回到最近一次<code>git commit</code>或<code>git add</code>时的状态.</p>
<blockquote>
<p><code>git checkout -- file</code>命令中的<code>--</code>很重要, 没有<code>--</code>, 就变成了“切换到另一个分支”的命令, 我们在后面的分支管理中会再次遇到<code>git checkout</code>命令.</p>
</blockquote>
<h3 id="add后撤销"><a href="#add后撤销" class="headerlink" title="add后撤销"></a>add后撤销</h3><p>将文件<code>git add</code>到暂存区了</p>
<p>庆幸的是, 在<code>commit</code>之前, 你发现了这个问题. 用<code>git status</code>查看一下, 修改只是添加到了暂存区, 还没有提交：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use <span class="string">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage)</span><br><span class="line"></span><br><span class="line">   modified:   readme.txt</span><br></pre></td></tr></table></figure>

<p>Git同样告诉我们, 用命令<code>git reset HEAD &lt;file&gt;</code>可以把暂存区的修改撤销掉（unstage）, 重新放回工作区：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git reset HEAD readme.txt</span><br><span class="line">Unstaged changes after reset:</span><br><span class="line">M  readme.txt</span><br></pre></td></tr></table></figure>

<p><code>git reset</code>命令既可以回退版本, 也可以把暂存区的修改回退到工作区. 当我们用<code>HEAD</code>时, 表示最新的版本.</p>
<p>再用<code>git status</code>查看一下, 现在暂存区是干净的, 工作区有修改：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">  modified:   readme.txt</span><br></pre></td></tr></table></figure>

<h3 id="comit后撤销"><a href="#comit后撤销" class="headerlink" title="comit后撤销"></a>comit后撤销</h3><p>假设你不但改错了东西, 还从暂存区提交到了版本库, 怎么办呢？还记得<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192">版本回退</a>一节吗？可以回退到上一个版本. 不过, 这是有条件的, 就是你还没有把自己的本地版本库推送到远程. 还记得Git是分布式版本控制系统吗？我们后面会讲到远程版本库, 一旦你把<code>stupid boss</code>提交推送到远程版本库, 你就真的惨了……</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li>场景1：当你改乱了工作区某个文件的内容, 想直接丢弃工作区的修改时, 用命令<code>git checkout -- file</code>.</li>
<li>场景2：当你不但改乱了工作区某个文件的内容, 还添加到了暂存区时, 想丢弃修改, 分两步, 第一步用命令<code>git reset HEAD &lt;file&gt;</code>, 就回到了场景1, 第二步按场景1操作.</li>
<li>场景3：已经提交了不合适的修改到版本库时, 想要撤销本次提交, 参考<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192">版本回退</a>一节, 不过前提是没有推送到远程库.</li>
</ul>
<h2 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h2><h3 id="case1-删除文件"><a href="#case1-删除文件" class="headerlink" title="case1: 删除文件"></a>case1: 删除文件</h3><p>确实要从版本库中删除该文件, 那就用命令<code>git rm</code>删掉, 并且<code>git commit</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">rm</span> test.txt</span><br><span class="line"><span class="built_in">rm</span> <span class="string">&#x27;test.txt&#x27;</span></span><br><span class="line"></span><br><span class="line">$ git commit -m <span class="string">&quot;remove test.txt&quot;</span></span><br><span class="line">[master d46f35e] remove test.txt</span><br><span class="line"> 1 file changed, 1 deletion(-)</span><br><span class="line"> delete mode 100644 test.txt</span><br></pre></td></tr></table></figure>

<h3 id="case2-误删文件"><a href="#case2-误删文件" class="headerlink" title="case2: 误删文件"></a>case2: 误删文件</h3><p>另一种情况是删错了, 因为版本库里还有呢, 所以可以很轻松地把误删的文件恢复到最新版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -- test.txt</span><br></pre></td></tr></table></figure>

<p><code>git checkout</code>其实是用版本库里的版本替换工作区的版本, 无论工作区是修改还是删除, 都可以“一键还原”.</p>
<h1 id="远程仓库"><a href="#远程仓库" class="headerlink" title="远程仓库"></a>远程仓库</h1><h2 id="添加远程仓库"><a href="#添加远程仓库" class="headerlink" title="添加远程仓库"></a>添加远程仓库</h2><h3 id="创建GitHub仓库"><a href="#创建GitHub仓库" class="headerlink" title="创建GitHub仓库"></a>创建GitHub仓库</h3><p>create a new repo</p>
<h3 id="连接仓库"><a href="#连接仓库" class="headerlink" title="连接仓库"></a>连接仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github.com:&lt;github账户名&gt;/&lt;仓库名&gt;.git</span><br></pre></td></tr></table></figure>

<p>添加后, 远程库的名字就是<code>origin</code>, 这是Git默认的叫法, 也可以改成别的, 但是<code>origin</code>这个名字一看就知道是远程库.</p>
<p>关联一个远程库时必须给远程库指定一个名字, <code>origin</code>是默认习惯命名.</p>
<h3 id="推送内容"><a href="#推送内容" class="headerlink" title="推送内容"></a>推送内容</h3><p>就可以把本地库的所有内容推送到远程库上</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git push -u origin master</span><br><span class="line">Counting objects: 20, <span class="keyword">done</span>.</span><br><span class="line">Delta compression using up to 4 threads.</span><br><span class="line">Compressing objects: 100% (15/15), <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (20/20), 1.64 KiB | 560.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Total 20 (delta 5), reused 0 (delta 0)</span><br><span class="line">remote: Resolving deltas: 100% (5/5), <span class="keyword">done</span>.</span><br><span class="line">To github.com:michaelliao/learngit.git</span><br><span class="line"> * [new branch]      master -&gt; master</span><br><span class="line">Branch <span class="string">&#x27;master&#x27;</span> <span class="built_in">set</span> up to track remote branch <span class="string">&#x27;master&#x27;</span> from <span class="string">&#x27;origin&#x27;</span>.</span><br></pre></td></tr></table></figure>

<p>把本地库的内容推送到远程, 用<code>git push</code>命令, 实际上是把当前分支<code>master</code>推送到远程.</p>
<p>由于远程库是空的, 我们第一次推送<code>master</code>分支时, 加上了<code>-u</code>参数, Git不但会把本地的<code>master</code>分支内容推送的远程新的<code>master</code>分支, 还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来, 在以后的推送或者拉取时就可以简化命令.</p>
<p>推送成功后, 可以立刻在GitHub页面中看到远程库的内容已经和本地一模一样</p>
<p>从现在起, 只要本地作了提交, 就可以通过命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<p>把本地<code>master</code>分支的最新修改推送至GitHub, 现在, 你就拥有了真正的分布式版本库！</p>
<h2 id="删除远程库"><a href="#删除远程库" class="headerlink" title="删除远程库"></a>删除远程库</h2><p>如果添加的时候地址写错了, 或者就是想删除远程库, 可以用<code>git remote rm &lt;name&gt;</code>命令. 使用前, 建议先用<code>git remote -v</code>查看远程库信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origin  git@github.com:michaelliao/learn-git.git (fetch)</span><br><span class="line">origin  git@github.com:michaelliao/learn-git.git (push)</span><br></pre></td></tr></table></figure>

<p>然后, 根据名字删除, 比如删除<code>origin</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote <span class="built_in">rm</span> origin</span><br></pre></td></tr></table></figure>

<p>此处的“删除”其实是解除了本地和远程的绑定关系, 并不是物理上删除了远程库. 远程库本身并没有任何改动. 要真正删除远程库, 需要登录到GitHub, 在后台页面找到删除按钮再删除.</p>
<h1 id="分支管理"><a href="#分支管理" class="headerlink" title="分支管理"></a>分支管理</h1><p>分支就是科幻电影里面的平行宇宙, 当你正在电脑前努力学习Git的时候, 另一个你正在另一个平行宇宙里努力学习SVN.</p>
<p>如果两个平行宇宙互不干扰, 那对现在的你也没啥影响. 不过, 在某个时间点, 两个平行宇宙合并了, 结果, 你既学会了Git又学会了SVN！</p>
<img data-src="/2019/11/10/77/0.png" class="" title="learn-branches">

<h2 id="创建与合并分支"><a href="#创建与合并分支" class="headerlink" title="创建与合并分支"></a>创建与合并分支</h2><h3 id="形象化描述"><a href="#形象化描述" class="headerlink" title="形象化描述"></a>形象化描述</h3><p>在<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192">版本回退</a>里, 你已经知道, 每次提交, Git都把它们串成一条时间线, 这条时间线就是一个分支. 截止到目前, 只有一条时间线, 在Git里, 这个分支叫主分支, 即<code>master</code>分支. <code>HEAD</code>严格来说不是指向提交, 而是指向<code>master</code>, <code>master</code>才是指向提交的, 所以, <code>HEAD</code>指向的就是当前分支.</p>
<p>一开始的时候, <code>master</code>分支是一条线, Git用<code>master</code>指向最新的提交, 再用<code>HEAD</code>指向<code>master</code>, 就能确定当前分支, 以及当前分支的提交点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">                  HEAD</span><br><span class="line">                    │</span><br><span class="line">                    │</span><br><span class="line">                    ▼</span><br><span class="line">                 master</span><br><span class="line">                    │</span><br><span class="line">                    │</span><br><span class="line">                    ▼</span><br><span class="line">┌───┐    ┌───┐    ┌───┐</span><br><span class="line">│   │───▶│   │───▶│   │</span><br><span class="line">└───┘    └───┘    └───┘</span><br></pre></td></tr></table></figure>

<p>每次提交, <code>master</code>分支都会向前移动一步, 这样, 随着你不断提交, <code>master</code>分支的线也越来越长.</p>
<p>当我们创建新的分支, 例如<code>dev</code>时, Git新建了一个指针叫<code>dev</code>, 指向<code>master</code>相同的提交, 再把<code>HEAD</code>指向<code>dev</code>, 就表示当前分支在<code>dev</code>上：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">                 master</span><br><span class="line">                    │</span><br><span class="line">                    │</span><br><span class="line">                    ▼</span><br><span class="line">┌───┐    ┌───┐    ┌───┐</span><br><span class="line">│   │───▶│   │───▶│   │</span><br><span class="line">└───┘    └───┘    └───┘</span><br><span class="line">                    ▲</span><br><span class="line">                    │</span><br><span class="line">                    │</span><br><span class="line">                   dev</span><br><span class="line">                    ▲</span><br><span class="line">                    │</span><br><span class="line">                    │</span><br><span class="line">                  HEAD</span><br></pre></td></tr></table></figure>

<p>你看, Git创建一个分支很快, 因为除了增加一个<code>dev</code>指针, 改改<code>HEAD</code>的指向, 工作区的文件都没有任何变化！</p>
<p>不过, 从现在开始, 对工作区的修改和提交就是针对<code>dev</code>分支了, 比如新提交一次后, <code>dev</code>指针往前移动一步, 而<code>master</code>指针不变：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">                 master</span><br><span class="line">                    │</span><br><span class="line">                    │</span><br><span class="line">                    ▼</span><br><span class="line">┌───┐    ┌───┐    ┌───┐    ┌───┐</span><br><span class="line">│   │───▶│   │───▶│   │───▶│   │</span><br><span class="line">└───┘    └───┘    └───┘    └───┘</span><br><span class="line">                             ▲</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                            dev</span><br><span class="line">                             ▲</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                           HEAD</span><br></pre></td></tr></table></figure>

<p>假如我们在<code>dev</code>上的工作完成了, 就可以把<code>dev</code>合并到<code>master</code>上. Git怎么合并呢？最简单的方法, 就是直接把<code>master</code>指向<code>dev</code>的当前提交, 就完成了合并：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">                           HEAD</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                             ▼</span><br><span class="line">                          master</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                             ▼</span><br><span class="line">┌───┐    ┌───┐    ┌───┐    ┌───┐</span><br><span class="line">│   │───▶│   │───▶│   │───▶│   │</span><br><span class="line">└───┘    └───┘    └───┘    └───┘</span><br><span class="line">                             ▲</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                            dev</span><br></pre></td></tr></table></figure>

<p>所以Git合并分支也很快！就改改指针, 工作区内容也不变！</p>
<p>合并完分支后, 甚至可以删除<code>dev</code>分支. 删除<code>dev</code>分支就是把<code>dev</code>指针给删掉, 删掉后, 我们就剩下了一条<code>master</code>分支：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">                           HEAD</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                             ▼</span><br><span class="line">                          master</span><br><span class="line">                             │</span><br><span class="line">                             │</span><br><span class="line">                             ▼</span><br><span class="line">┌───┐    ┌───┐    ┌───┐    ┌───┐</span><br><span class="line">│   │───▶│   │───▶│   │───▶│   │</span><br><span class="line">└───┘    └───┘    └───┘    └───┘</span><br></pre></td></tr></table></figure>

<h3 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h3><h4 id="创建并切换到dev分支"><a href="#创建并切换到dev分支" class="headerlink" title="创建并切换到dev分支"></a>创建并切换到dev分支</h4><p>创建<code>dev</code>分支, 然后切换到<code>dev</code>分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout -b dev</span><br><span class="line">Switched to a new branch <span class="string">&#x27;dev&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>git checkout</code>命令加上<code>-b</code>参数表示创建并切换, 相当于以下两条命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git branch dev</span><br><span class="line">$ git checkout dev</span><br><span class="line">Switched to branch <span class="string">&#x27;dev&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后, 用<code>git branch</code>命令查看当前分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">* dev</span><br><span class="line">  master</span><br></pre></td></tr></table></figure>

<p><code>git branch</code>命令会列出所有分支, 当前分支前面会标一个<code>*</code>号.</p>
<p>然后, 我们就可以在<code>dev</code>分支上正常提交, 比如对<code>readme.txt</code>做个修改, 加上一行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Creating a new branch is quick.</span><br></pre></td></tr></table></figure>

<p>然后提交：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git add readme.txt </span><br><span class="line">$ git commit -m <span class="string">&quot;branch test&quot;</span></span><br><span class="line">[dev b17d20e] branch <span class="built_in">test</span></span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>

<p>现在, <code>dev</code>分支的工作完成, 我们就可以切换回<code>master</code>分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout master</span><br><span class="line">Switched to branch <span class="string">&#x27;master&#x27;</span></span><br></pre></td></tr></table></figure>

<p>切换回<code>master</code>分支后, 再查看一个<code>readme.txt</code>文件, 刚才添加的内容不见了！因为那个提交是在<code>dev</code>分支上, 而<code>master</code>分支此刻的提交点并没有变：</p>
<img data-src="/2019/11/10/77/0-20240120144922049.png" class="" title="git-br-on-master">

<p>现在, 我们把<code>dev</code>分支的工作成果合并到<code>master</code>分支上：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git merge dev</span><br><span class="line">Updating d46f35e..b17d20e</span><br><span class="line">Fast-forward</span><br><span class="line"> readme.txt | 1 +</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>

<p><code>git merge</code>命令用于合并指定分支到当前分支. 合并后, 再查看<code>readme.txt</code>的内容, 就可以看到, 和<code>dev</code>分支的最新提交是完全一样的.</p>
<p>注意到上面的<code>Fast-forward</code>信息, Git告诉我们, 这次合并是“快进模式”, 也就是直接把<code>master</code>指向<code>dev</code>的当前提交, 所以合并速度非常快.</p>
<p>当然, 也不是每次合并都能<code>Fast-forward</code>, 我们后面会讲其他方式的合并.</p>
<p>合并完成后, 就可以放心地删除<code>dev</code>分支了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d dev</span><br><span class="line">Deleted branch dev (was b17d20e).</span><br></pre></td></tr></table></figure>

<p>删除后, 查看<code>branch</code>, 就只剩下<code>master</code>分支了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git branch</span><br><span class="line">* master</span><br></pre></td></tr></table></figure>

<p>因为创建、合并和删除分支非常快, 所以Git鼓励你使用分支完成某个任务, 合并后再删掉分支, 这和直接在<code>master</code>分支上工作效果是一样的, 但过程更安全.</p>
<h4 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h4><p>我们注意到切换分支使用<code>git checkout &lt;branch&gt;</code>, 而前面讲过的撤销修改则是<code>git checkout -- &lt;file&gt;</code>, 同一个命令, 有两种作用, 确实有点令人迷惑.</p>
<p>实际上, 切换分支这个动作, 用<code>switch</code>更科学. 因此, 最新版本的Git提供了新的<code>git switch</code>命令来切换分支：</p>
<p>创建并切换到新的<code>dev</code>分支, 可以使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git switch -c dev</span><br></pre></td></tr></table></figure>

<p>直接切换到已有的<code>master</code>分支, 可以使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git switch master</span><br></pre></td></tr></table></figure>

<p>使用新的<code>git switch</code>命令, 比<code>git checkout</code>要更容易理解.</p>
<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><ul>
<li>查看分支：<code>git branch</code></li>
<li>创建分支：<code>git branch &lt;name&gt;</code></li>
<li>切换分支：<code>git checkout &lt;name&gt;</code>或者<code>git switch &lt;name&gt;</code></li>
<li>创建+切换分支：<code>git checkout -b &lt;name&gt;</code>或者<code>git switch -c &lt;name&gt;</code></li>
<li>合并某分支到当前分支：<code>git merge &lt;name&gt;</code></li>
<li>删除分支：<code>git branch -d &lt;name&gt;</code></li>
</ul>
<h2 id="解决冲突"><a href="#解决冲突" class="headerlink" title="解决冲突"></a>解决冲突</h2><p>准备新的<code>feature1</code>分支, 继续我们的新分支开发：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git switch -c feature1</span><br><span class="line">Switched to a new branch <span class="string">&#x27;feature1&#x27;</span></span><br></pre></td></tr></table></figure>

<p>修改<code>readme.txt</code>最后一行, 改为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Creating a new branch is quick AND simple.</span><br></pre></td></tr></table></figure>

<p>在<code>feature1</code>分支上提交：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git add readme.txt</span><br><span class="line"></span><br><span class="line">$ git commit -m <span class="string">&quot;AND simple&quot;</span></span><br><span class="line">[feature1 14096d0] AND simple</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br></pre></td></tr></table></figure>

<p>切换到<code>master</code>分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git switch master</span><br><span class="line">Switched to branch <span class="string">&#x27;master&#x27;</span></span><br><span class="line">Your branch is ahead of <span class="string">&#x27;origin/master&#x27;</span> by 1 commit.</span><br><span class="line">  (use <span class="string">&quot;git push&quot;</span> to publish your <span class="built_in">local</span> commits)</span><br></pre></td></tr></table></figure>

<p>Git还会自动提示我们当前<code>master</code>分支比远程的<code>master</code>分支要超前1个提交.</p>
<p>在<code>master</code>分支上把<code>readme.txt</code>文件的最后一行改为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Creating a new branch is quick &amp; simple.</span><br></pre></td></tr></table></figure>

<p>提交：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git add readme.txt </span><br><span class="line">$ git commit -m <span class="string">&quot;&amp; simple&quot;</span></span><br><span class="line">[master 5dc6824] &amp; simple</span><br><span class="line"> 1 file changed, 1 insertion(+), 1 deletion(-)</span><br></pre></td></tr></table></figure>

<p>现在, <code>master</code>分支和<code>feature1</code>分支各自都分别有新的提交, 变成了这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">                            HEAD</span><br><span class="line">                              │</span><br><span class="line">                              │</span><br><span class="line">                              ▼</span><br><span class="line">                           master</span><br><span class="line">                              │</span><br><span class="line">                              │</span><br><span class="line">                              ▼</span><br><span class="line">                            ┌───┐</span><br><span class="line">                         ┌─▶│   │</span><br><span class="line">┌───┐    ┌───┐    ┌───┐  │  └───┘</span><br><span class="line">│   │───▶│   │───▶│   │──┤</span><br><span class="line">└───┘    └───┘    └───┘  │  ┌───┐</span><br><span class="line">                         └─▶│   │</span><br><span class="line">                            └───┘</span><br><span class="line">                              ▲</span><br><span class="line">                              │</span><br><span class="line">                              │</span><br><span class="line">                          feature1</span><br></pre></td></tr></table></figure>

<p>这种情况下, Git无法执行“快速合并”, 只能试图把各自的修改合并起来, 但这种合并就可能会有冲突, 我们试试看：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git merge feature1</span><br><span class="line">Auto-merging readme.txt</span><br><span class="line">CONFLICT (content): Merge conflict <span class="keyword">in</span> readme.txt</span><br><span class="line">Automatic merge failed; fix conflicts and <span class="keyword">then</span> commit the result.</span><br></pre></td></tr></table></figure>

<p>果然冲突了！Git告诉我们, <code>readme.txt</code>文件存在冲突, 必须手动解决冲突后再提交. <code>git status</code>也可以告诉我们冲突的文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is ahead of <span class="string">&#x27;origin/master&#x27;</span> by 2 commits.</span><br><span class="line">  (use <span class="string">&quot;git push&quot;</span> to publish your <span class="built_in">local</span> commits)</span><br><span class="line"></span><br><span class="line">You have unmerged paths.</span><br><span class="line">  (fix conflicts and run <span class="string">&quot;git commit&quot;</span>)</span><br><span class="line">  (use <span class="string">&quot;git merge --abort&quot;</span> to abort the merge)</span><br><span class="line"></span><br><span class="line">Unmerged paths:</span><br><span class="line">  (use <span class="string">&quot;git add &lt;file&gt;...&quot;</span> to mark resolution)</span><br><span class="line"></span><br><span class="line">   both modified:   readme.txt</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">&quot;git add&quot;</span> and/or <span class="string">&quot;git commit -a&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>我们可以直接查看readme.txt的内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Git is a distributed version control system.</span><br><span class="line">Git is free software distributed under the GPL.</span><br><span class="line">Git has a mutable index called stage.</span><br><span class="line">Git tracks changes of files.</span><br><span class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; <span class="string">HEAD</span></span><br><span class="line"><span class="string">Creating a new branch is quick &amp; simple.</span></span><br><span class="line"><span class="string">=======</span></span><br><span class="line"><span class="string">Creating a new branch is quick AND simple.</span></span><br><span class="line"><span class="string">&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature1</span></span><br></pre></td></tr></table></figure>

<p>Git用<code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>, <code>=======</code>, <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>标记出不同分支的内容, 我们修改如下后保存：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Creating a new branch is quick and simple.</span><br></pre></td></tr></table></figure>

<p>再提交：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add readme.txt </span><br><span class="line">$ git commit -m <span class="string">&quot;conflict fixed&quot;</span></span><br><span class="line">[master cf810e4] conflict fixed</span><br></pre></td></tr></table></figure>

<p>现在, <code>master</code>分支和<code>feature1</code>分支变成了下图所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">                                     HEAD</span><br><span class="line">                                       │</span><br><span class="line">                                       │</span><br><span class="line">                                       ▼</span><br><span class="line">                                    master</span><br><span class="line">                                       │</span><br><span class="line">                                       │</span><br><span class="line">                                       ▼</span><br><span class="line">                            ┌───┐    ┌───┐</span><br><span class="line">                         ┌─▶│   │───▶│   │</span><br><span class="line">┌───┐    ┌───┐    ┌───┐  │  └───┘    └───┘</span><br><span class="line">│   │───▶│   │───▶│   │──┤             ▲</span><br><span class="line">└───┘    └───┘    └───┘  │  ┌───┐      │</span><br><span class="line">                         └─▶│   │──────┘</span><br><span class="line">                            └───┘</span><br><span class="line">                              ▲</span><br><span class="line">                              │</span><br><span class="line">                              │</span><br><span class="line">                          feature1</span><br></pre></td></tr></table></figure>

<p>用带参数的<code>git log</code>也可以看到分支的合并情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --graph --pretty=oneline --abbrev-commit</span><br><span class="line">*   cf810e4 (HEAD -&gt; master) conflict fixed</span><br><span class="line">|\  </span><br><span class="line">| * 14096d0 (feature1) AND simple</span><br><span class="line">* | 5dc6824 &amp; simple</span><br><span class="line">|/  </span><br><span class="line">* b17d20e branch <span class="built_in">test</span></span><br><span class="line">* d46f35e (origin/master) remove test.txt</span><br><span class="line">* b84166e add test.txt</span><br><span class="line">* 519219b git tracks changes</span><br><span class="line">* e43a48b understand how stage works</span><br><span class="line">* 1094adb append GPL</span><br><span class="line">* e475afc add distributed</span><br><span class="line">* eaadf4e wrote a readme file</span><br></pre></td></tr></table></figure>

<p>最后, 删除<code>feature1</code>分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d feature1</span><br><span class="line">Deleted branch feature1 (was 14096d0).</span><br></pre></td></tr></table></figure>

<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><p>当Git无法自动合并分支时, 就必须首先解决冲突. 解决冲突后, 再提交, 合并完成.</p>
<p>解决冲突就是把Git合并失败的文件手动编辑为我们希望的内容, 再提交.</p>
<p>用 <code>git log --graph</code> 命令可以看到分支合并图.</p>
<h2 id="分支管理策略"><a href="#分支管理策略" class="headerlink" title="分支管理策略"></a>分支管理策略</h2><p>通常, 合并分支时, 如果可能, Git会用<code>Fast forward</code>模式, 但这种模式下, 删除分支后, 会丢掉分支信息.</p>
<p>如果要强制禁用<code>Fast forward</code>模式, Git就会在merge时生成一个新的commit, 这样, 从分支历史上就可以看出分支信息.</p>
<p>下面我们实战一下<code>--no-ff</code>方式的<code>git merge</code>：</p>
<p>首先, 仍然创建并切换<code>dev</code>分支：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git switch -c dev</span><br><span class="line">Switched to a new branch <span class="string">&#x27;dev&#x27;</span></span><br></pre></td></tr></table></figure>

<p>修改readme.txt文件, 并提交一个新的commit：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git add readme.txt </span><br><span class="line">$ git commit -m <span class="string">&quot;add merge&quot;</span></span><br><span class="line">[dev f52c633] add merge</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>

<p>现在, 我们切换回<code>master</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git switch master</span><br><span class="line">Switched to branch <span class="string">&#x27;master&#x27;</span></span><br></pre></td></tr></table></figure>

<p>准备合并<code>dev</code>分支, 请注意<code>--no-ff</code>参数, 表示禁用<code>Fast forward</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git merge --no-ff -m <span class="string">&quot;merge with no-ff&quot;</span> dev</span><br><span class="line">Merge made by the <span class="string">&#x27;recursive&#x27;</span> strategy.</span><br><span class="line"> readme.txt | 1 +</span><br><span class="line"> 1 file changed, 1 insertion(+)</span><br></pre></td></tr></table></figure>

<p>因为本次合并要创建一个新的commit, 所以加上<code>-m</code>参数, 把commit描述写进去.</p>
<p>合并后, 我们用<code>git log</code>看看分支历史：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">log</span> --graph --pretty=oneline --abbrev-commit</span><br><span class="line">*   e1e9c68 (HEAD -&gt; master) merge with no-ff</span><br><span class="line">|\  </span><br><span class="line">| * f52c633 (dev) add merge</span><br><span class="line">|/  </span><br><span class="line">*   cf810e4 conflict fixed</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>可以看到, 不使用<code>Fast forward</code>模式, merge后就像这样：</p>
<img data-src="/2019/11/10/77/0-20240120151440047.png" class="" title="git-no-ff-mode">

<h3 id="分支策略"><a href="#分支策略" class="headerlink" title="分支策略"></a>分支策略</h3><p>在实际开发中, 我们应该按照几个基本原则进行分支管理：</p>
<p>首先, <code>master</code>分支应该是非常稳定的, 也就是仅用来发布新版本, 平时不能在上面干活；</p>
<p>那在哪干活呢？干活都在<code>dev</code>分支上, 也就是说, <code>dev</code>分支是不稳定的, 到某个时候, 比如1.0版本发布时, 再把<code>dev</code>分支合并到<code>master</code>上, 在<code>master</code>分支发布1.0版本；</p>
<p>你和你的小伙伴们每个人都在<code>dev</code>分支上干活, 每个人都有自己的分支, 时不时地往<code>dev</code>分支上合并就可以了.</p>
<p>所以, 团队合作的分支看起来就像这样：</p>
<img data-src="/2019/11/10/77/0-20240120151448264.png" class="" title="git-br-policy">

<h3 id="小结-3"><a href="#小结-3" class="headerlink" title="小结"></a>小结</h3><p>Git分支十分强大, 在团队开发中应该充分应用.</p>
<p>合并分支时, 加上<code>--no-ff</code>参数就可以用普通模式合并, 合并后的历史有分支, 能看出来曾经做过合并, 而<code>fast forward</code>合并就看不出来曾经做过合并.</p>
<h1 id="API的使用"><a href="#API的使用" class="headerlink" title="API的使用"></a>API的使用</h1><h2 id="获取最新Releases的版本号"><a href="#获取最新Releases的版本号" class="headerlink" title="获取最新Releases的版本号"></a>获取最新Releases的版本号</h2><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -qO- -t1 -T2 <span class="string">&quot;https://api.github.com/repos/ryanoasis/nerd-fonts/releases/latest&quot;</span> | grep <span class="string">&quot;tag_name&quot;</span> | <span class="built_in">head</span> -n 1 | awk -F <span class="string">&quot;:&quot;</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | sed <span class="string">&#x27;s/\&quot;//g;s/,//g;s/ //g&#x27;</span></span><br></pre></td></tr></table></figure>

<p>可以搭配 <code>xargs</code> 进行自定义命令</p>
<h2 id="代码解释"><a href="#代码解释" class="headerlink" title="代码解释"></a>代码解释</h2><ul>
<li><p>主字段</p>
<p> <code>https://api.github.com/repos/ryanoasis/nerd-fonts/releases/latest</code> 这里用的是 GitHub 的官方 API, 格式为 <code>https://api.github.com/repos/&#123;项目名&#125;/releases/latest</code></p>
<p> 打开上述链接后, 可见包含下述字段的内容：</p>
 <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;html_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://github.com/ryanoasis/nerd-fonts/releases/tag/v3.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">131468221</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;node_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RE_kwDOAaTAks4H1gu9&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;tag_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;v3.1.1&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;target_commitish&quot;</span><span class="punctuation">:</span> <span class="string">&quot;master&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;v3.1.1&quot;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p> 那么这里的<code>tag_name</code>就是我们所需要的东西啦</p>
</li>
<li><p>wget 参数</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -qO- -t1 -T2`, 在这里, 我们使用了 4 个参数, 分别是`q,O-,t1,T2</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-q</code>: q 就是 quiet 的意思了, 没有该参数将会显示从请求到输出全过程的所有内容, 这肯定不是我们想要的.</li>
<li><code>-O-</code>: <code>-O</code>是指把文档写入文件中, 而<code>-O-</code>是将内容写入标准输出, 而不保存为文件. （注：这里是大写英文字母 O (Out), 不是数字 0）</li>
<li><code>-t1,-T2</code>: 前者是设定最大尝试链接次数为 1 次, 后者是设定响应超时的秒数为 2 秒, 两者可以防止失败后反复获取, 导致后续脚本无法执行.</li>
</ul>
</li>
<li><p>筛选参数</p>
<ul>
<li><code>grep &quot;tag_name&quot;</code>: grep 是 Linux 一个强大的文本搜索工具, 在本代码中输出 tag_name 所在行, 即输出<code>&quot;tag_name&quot;: &quot;v3.1.1&quot;,</code></li>
<li><code>head -n 1</code>: <code>head -n</code>用于显示输出的行数, 考虑到某些项目可能存在多个不同版本的 tag_name, 这里我们只要第一个.</li>
<li><code>awk -F &quot;:&quot; &#39;&#123;print $2&#125;&#39;</code>: awk 主要用于文本分析, 在这里指定<code>:</code>为分隔符, 将该行切分成多列, 并输出第二列. 于是我们得到了<code>(空格)&quot;v3.1.1&quot;,</code></li>
<li><code>sed &#39;s/\&quot;//g;s/,//g;s/ //g&#39;</code>: 在这里 sed 用于数据查找替换, 如<code>sed &#39;s/要被取代的字串/新的字串/g&#39;</code> , 因此本段命令可分为 3 个, 以分号分隔. <code>s/\&quot;//g</code>即将引号删除（反斜杠是为了防止引号被转义）, 以此类推, 最终留下我们需要的内容：<code>v3.1.1</code>.</li>
</ul>
</li>
</ul>
<h1 id="忽略特殊文件"><a href="#忽略特殊文件" class="headerlink" title="忽略特殊文件"></a>忽略特殊文件</h1><p>有些时候, 你必须把某些文件放到Git工作目录中, 但又不能提交它们, 比如保存了数据库密码的配置文件啦, 等等, 每次<code>git status</code>都会显示<code>Untracked files ...</code>, 有强迫症的童鞋心里肯定不爽.</p>
<p>好在Git考虑到了大家的感受, 这个问题解决起来也很简单, 在Git工作区的根目录下创建一个特殊的<code>.gitignore</code>文件, 然后把要忽略的文件名填进去, Git就会自动忽略这些文件.</p>
<blockquote>
<p>[!NOTE]</p>
<p><code>.gitignore</code>文件本身应该提交给Git管理, 这样可以确保所有人在同一项目下都使用相同的<code>.gitignore</code>文件.</p>
</blockquote>
<p>不需要从头写<code>.gitignore</code>文件, GitHub已经为我们准备了各种配置文件, 只需要组合一下就可以使用了. 所有配置文件可以直接在线浏览：<a target="_blank" rel="noopener" href="https://github.com/github/gitignore">GitHub&#x2F;gitignore</a></p>
<p>忽略文件的原则是：</p>
<ol>
<li>忽略操作系统自动生成的文件, 比如缩略图等；</li>
<li>忽略编译生成的中间文件、可执行文件等, 也就是如果一个文件是通过另一个文件自动生成的, 那自动生成的文件就没必要放进版本库, 比如Java编译产生的<code>.class</code>文件；</li>
<li>忽略你自己的带有敏感信息的配置文件, 比如存放口令的配置文件.</li>
</ol>
<p>举个例子：</p>
<p>假设你在Windows下进行Python开发, Windows会自动在有图片的目录下生成隐藏的缩略图文件, 如果有自定义目录, 目录下就会有<code>Desktop.ini</code>文件, 因此你需要忽略Windows自动生成的垃圾文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Windows:</span><br><span class="line">Thumbs.db</span><br><span class="line">ehthumbs.db</span><br><span class="line">Desktop.ini</span><br></pre></td></tr></table></figure>

<p>然后, 继续忽略Python编译产生的<code>.pyc</code>、<code>.pyo</code>、<code>dist</code>等文件或目录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Python:</span><br><span class="line">*.py[cod]</span><br><span class="line">*.so</span><br><span class="line">*.egg</span><br><span class="line">*.egg-info</span><br><span class="line">dist</span><br><span class="line">build</span><br></pre></td></tr></table></figure>

<p>加上你自己定义的文件, 最终得到一个完整的<code>.gitignore</code>文件, 内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># Windows:</span><br><span class="line">Thumbs.db</span><br><span class="line">ehthumbs.db</span><br><span class="line">Desktop.ini</span><br><span class="line"></span><br><span class="line"># Python:</span><br><span class="line">*.py[cod]</span><br><span class="line">*.so</span><br><span class="line">*.egg</span><br><span class="line">*.egg-info</span><br><span class="line">dist</span><br><span class="line">build</span><br><span class="line"></span><br><span class="line"># My configurations:</span><br><span class="line">db.ini</span><br><span class="line">deploy_key_rsa</span><br></pre></td></tr></table></figure>

<p>最后一步就是把<code>.gitignore</code>也提交到Git, 就完成了！当然检验<code>.gitignore</code>的标准是<code>git status</code>命令是不是说<code>working directory clean</code>.</p>
<p>使用Windows的童鞋注意了, 如果你在资源管理器里新建一个<code>.gitignore</code>文件, 它会非常弱智地提示你必须输入文件名, 但是在文本编辑器里“保存”或者“另存为”就可以把文件保存为<code>.gitignore</code>了.</p>
<p>有些时候, 你想添加一个文件到Git, 但发现添加不了, 原因是这个文件被<code>.gitignore</code>忽略了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git add App.class</span><br><span class="line">The following paths are ignored by one of your .gitignore files:</span><br><span class="line">App.class</span><br><span class="line">Use -f if you really want to add them.</span><br></pre></td></tr></table></figure>

<p>如果你确实想添加该文件, 可以用<code>-f</code>强制添加到Git：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add -f App.class</span><br></pre></td></tr></table></figure>

<p>或者你发现, 可能是<code>.gitignore</code>写得有问题, 需要找出来到底哪个规则写错了, 可以用<code>git check-ignore</code>命令检查：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git check-ignore -v App.class</span><br><span class="line">.gitignore:3:*.class App.class</span><br></pre></td></tr></table></figure>

<p>Git会告诉我们, <code>.gitignore</code>的第3行规则忽略了该文件, 于是我们就可以知道应该修订哪个规则.</p>
<p>还有些时候, 当我们编写了规则排除了部分文件时：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 排除所有.开头的隐藏文件:</span><br><span class="line">.*</span><br><span class="line"># 排除所有.class文件:</span><br><span class="line">*.class</span><br></pre></td></tr></table></figure>

<p>但是我们发现<code>.*</code>这个规则把<code>.gitignore</code>也排除了, 并且<code>App.class</code>需要被添加到版本库, 但是被<code>*.class</code>规则排除了.</p>
<p>虽然可以用<code>git add -f</code>强制添加进去, 但有强迫症的童鞋还是希望不要破坏<code>.gitignore</code>规则, 这个时候, 可以添加两条例外规则：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 排除所有.开头的隐藏文件:</span><br><span class="line">.*</span><br><span class="line"># 排除所有.class文件:</span><br><span class="line">*.class</span><br><span class="line"></span><br><span class="line"># 不排除.gitignore和App.class:</span><br><span class="line">!.gitignore</span><br><span class="line">!App.class</span><br></pre></td></tr></table></figure>

<p>把指定文件排除在<code>.gitignore</code>规则外的写法就是<code>!</code>+文件名, 所以, 只需把例外文件添加进去即可.</p>
<p>可以通过<a target="_blank" rel="noopener" href="https://michaelliao.github.io/gitignore-online-generator/">GitIgnore Online Generator</a>在线生成<code>.gitignore</code>文件并直接下载.</p>
<p>最后一个问题：<code>.gitignore</code>文件放哪？答案是放Git仓库根目录下, 但其实一个Git仓库也可以有多个<code>.gitignore</code>文件, <code>.gitignore</code>文件放在哪个目录下, 就对哪个目录（包括子目录）起作用.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">myproject          &lt;- Git仓库根目录</span><br><span class="line">├── .gitigore      &lt;- 针对整个仓库生效的.gitignore</span><br><span class="line">├── LICENSE</span><br><span class="line">├── README.md</span><br><span class="line">├── docs</span><br><span class="line">│   └── .gitigore  &lt;- 仅针对docs目录生效的.gitignore</span><br><span class="line">└── source</span><br></pre></td></tr></table></figure>

<h1 id="配置多个-SSH-Key"><a href="#配置多个-SSH-Key" class="headerlink" title="配置多个 SSH Key"></a>配置多个 SSH Key</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>同时使用两个 GitHub 帐号, 需要为两个帐号配置不同的 SSH Key：</p>
<ul>
<li>帐号 A 用于公司；</li>
<li>帐号 B 用于个人</li>
</ul>
<h2 id="创建ssh-key"><a href="#创建ssh-key" class="headerlink" title="创建ssh-key"></a>创建ssh-key</h2><p>生成帐号 A 的 SSH Key, 并在帐号 A 的 GitHub 设置页面添加 SSH 公钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -C <span class="string">&quot;GitHub User A&quot;</span> -f ~/.ssh/github_user_a_ed25519</span><br></pre></td></tr></table></figure>

<p>生成帐号 B 的 SSH-Key, 并在帐号 B 的 GitHub 设置页面添加 SSH 公钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -C <span class="string">&quot;GitHub User B&quot;</span> -f ~/.ssh/github_user_b_ed25519</span><br></pre></td></tr></table></figure>

<h2 id="配置ssh代理"><a href="#配置ssh代理" class="headerlink" title="配置ssh代理"></a>配置ssh代理</h2><p>创建好了上面的多个ssh key就可以开始管理他们了.  在终端中输入如下命令, 查询系统ssh key的代理：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -l</span><br></pre></td></tr></table></figure>

<p>如果系统已经设置了代理, 需要删除：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -D</span><br><span class="line">All identities removed.</span><br></pre></td></tr></table></figure>

<p>如果提示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not open a connection to your authentication agent.</span><br></pre></td></tr></table></figure>

<p>执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span> ssh-agent bash</span><br></pre></td></tr></table></figure>

<p>接下来添加刚才创建的ssh key的私钥：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一个</span></span><br><span class="line">$ ssh-add ~/.ssh/github_user_a_ed25519</span><br><span class="line">Enter passphrase <span class="keyword">for</span> /Users/XXX/.ssh/github_user_a_ed25519: </span><br><span class="line">Identity added: /Users/XXX/.ssh/github_user_a_ed25519 (/Users/XXX/.ssh/github_user_a_ed25519)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二个</span></span><br><span class="line">$ ssh-add ~/.ssh/github_user_b_ed25519</span><br><span class="line">Enter passphrase <span class="keyword">for</span> /Users/XXX/.ssh/github_user_b_ed25519: </span><br><span class="line">Identity added: /Users/XXX/.ssh/github_user_b_ed25519 (/Users/XXX/.ssh/github_user_b_ed25519)</span><br></pre></td></tr></table></figure>

<h2 id="添加公钥"><a href="#添加公钥" class="headerlink" title="添加公钥"></a>添加公钥</h2><p>其实就是将对应的.pub中的内容, 复制到对应平台的ssh key管理栏目中, 不同的平台, 位置不同, 可以去对应的个人中心的设置中查看, 很容易找到.</p>
<h2 id="配置config"><a href="#配置config" class="headerlink" title="配置config"></a>配置config</h2><p>创建或者修改文件 <code>~/.ssh/config</code>, 添加如下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Host gt_a</span><br><span class="line">   User git</span><br><span class="line">   Hostname github.com</span><br><span class="line">   Port 22</span><br><span class="line">   IdentityFile ~/.ssh/github_user_a_ed25519</span><br><span class="line">   PreferredAuthentications publickey</span><br><span class="line">   IdentitiesOnly <span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line">Host gt_b</span><br><span class="line">   User git</span><br><span class="line">   Hostname github.com</span><br><span class="line">   Port 22</span><br><span class="line">   IdentityFile ~/.ssh/github_user_b_ed25519</span><br><span class="line">   PreferredAuthentications publickey</span><br><span class="line">   IdentitiesOnly <span class="built_in">yes</span></span><br></pre></td></tr></table></figure>

<h2 id="验证ssh-key"><a href="#验证ssh-key" class="headerlink" title="验证ssh-key"></a>验证ssh-key</h2><p>用 ssh 命令分别测试两个 SSH Key：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T gt_a</span><br><span class="line">Hi Qeuroal! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br><span class="line"></span><br><span class="line">$ ssh -T gt_b</span><br><span class="line">Hi Qeuroal! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure>

<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="拉取代码"><a href="#拉取代码" class="headerlink" title="拉取代码"></a>拉取代码</h3><p>将 <code>git@github.com</code> 替换为 SSH 配置文件中对应的 <code>Host</code>, 如原仓库 SSH 链接为：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git@github.com:owner/repo.git</span><br></pre></td></tr></table></figure>

<p>使用帐号 A 推拉仓库时, 需要将连接修改为：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gt_a:owner/repo.git</span><br></pre></td></tr></table></figure>

<h3 id="多个git账户的提交问题"><a href="#多个git账户的提交问题" class="headerlink" title="多个git账户的提交问题"></a>多个git账户的提交问题</h3><p>我们大多数人都会使用第三方工具进行git提交, 比如source tree之类的, 这些工具在提交时, 如果不对对应的git仓库进行专门的配置, 会默认走git的全局配置, 也就是会用默认的全局配置的账户进行git提交. 一不小心, 就会用我们私人的账户, 进行了公司项目的git提交, 生成了对应的提交记录, 也有可能因为权限问题, 导致直接提交失败.<br>这时, 我们需要对不同的仓库, 进行对应的配置.</p>
<ol>
<li><p>检查全局配置</p>
<p>在终端中, 分别输入如下命令, 可以检查目前电脑中的git的全局配置信息, 如果没有返回, 说明没有全局配置, 如果有, 就可以看到对应的默认的账户是那个了.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name</span><br><span class="line">git config --global user.email</span><br></pre></td></tr></table></figure>

<p>为了避免麻烦, 我们可以取消全局配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global --<span class="built_in">unset</span> user.name</span><br><span class="line">git config --global --<span class="built_in">unset</span> user.email</span><br></pre></td></tr></table></figure>
</li>
<li><p>全局配置和局部配置</p>
<p>此时已经取消了电脑中默认的git全局配置信息, 此时进行git提交, 会报对应的找不到账户信息的错误.<br>我们可以cd到对应的git仓库的根目录下, 执行局部git配置命令. 比如 <code>~/github/DemoProject</code> 是一个在github平台托管的本地git仓库的根目录, 我们可以执行如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/github/DemoProject</span><br><span class="line">git config user.name</span><br><span class="line">git config user.email</span><br></pre></td></tr></table></figure>

<p>如果返回均为空, 说明没有进行过局部配置, 可以分别配置github的账户名和邮箱：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config user.name <span class="string">&quot;github账户名&quot;</span></span><br><span class="line">git config user.email <span class="string">&quot;github@example.com&quot;</span></span><br></pre></td></tr></table></figure>

<p>同理, 在不同的git仓库下, 可以分别配置不同平台的git账户名和git邮箱. 这虽然看起来麻烦, 不过, 只要设置完成, 之后只要不再更改对应的git仓库的路径, 就不需要再更换配置了.<br>而且, 即便我们没有取消默认的全局git配置, 在进行了局部配置后, 后者的优先级会更高.  执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure>

<p>可以查看查看当前仓库的具体配置信息, 在当前仓库目录下查看的配置是全局配置+当前项目的局部配置, 使用的时候会优先使用当前仓库的局部配置, 如果没有, 才会去读取全局配置.</p>
</li>
</ol>
<h1 id="克隆含有子模块的项目"><a href="#克隆含有子模块的项目" class="headerlink" title="克隆含有子模块的项目"></a>克隆含有子模块的项目</h1><p>当一个 git 项目包含子模块（submodule) 时, 直接克隆下来的子模块目录里面是空的.</p>
<p>有两种方法解决：</p>
<h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><p>如果项目已经克隆到了本地, 执行下面的步骤：</p>
<ol>
<li><p>初始化本地子模块配置文件</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule <span class="keyword">init</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>更新项目, 抓取子模块内容.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git submodule <span class="keyword">update</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h2><p>另外一种更简单的方法, 就是在执行 <code>git clone</code> 时加上 <code>--recursive</code> 参数. 它会自动初始化并更新每一个子模块. 例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Copygit <span class="built_in">clone</span> --recursive https://github.com/example/example.git</span><br></pre></td></tr></table></figure>

<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>关于 git 子模块更多内容, 参见<a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E5%AD%90%E6%A8%A1%E5%9D%97">官方文档</a>.</p>
<h1 id="submodule-相关"><a href="#submodule-相关" class="headerlink" title="submodule 相关"></a>submodule 相关</h1><ul>
<li><p>查看子模块: <code>git submodule</code></p>
</li>
<li><p>更新子模块:</p>
<ul>
<li>更新项目内子模块到最新版本: <code>git submodule update</code></li>
<li>更新子模块为远程项目的最新版本: <code>git submodule update --remote</code></li>
</ul>
</li>
<li><p>克隆包含子模块的项目</p>
<ul>
<li><p>克隆父项目: <code>git clone https://github.com/demo.git assets</code></p>
</li>
<li><p>初始化子模块: <code>git submodule init</code></p>
</li>
<li><p>更新子模块: <code>git submodule update</code></p>
</li>
<li><p>递归克隆整个项目submodule: <code>git clone https://github.com/user/demo.git ./demo --recursive</code></p>
<pre><code>&gt; `--recursive` 表示递归地克隆 git_parent 依赖的所有子版本库.
</code></pre>
</li>
<li><p>递归更新整个项目submodule: <code>git submodule foreach git pull</code></p>
</li>
<li><p>删除子模块: <code>git rm --cached subModulesA rm -rf subModulesA</code></p>
</li>
</ul>
</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Qeuroal
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://qeuroal.top/2019/11/10/77/" title="77. Git 使用">http://qeuroal.top/2019/11/10/77/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/git/" rel="tag"><i class="fa fa-tag"></i> git</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2019/11/10/76/" rel="prev" title="76. Ubuntu Spyder 添加桌面快捷方式">
                  <i class="fa fa-angle-left"></i> 76. Ubuntu Spyder 添加桌面快捷方式
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2019/12/01/174/" rel="next" title="174. 别让自己“墙”了自己">
                  174. 别让自己“墙”了自己 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Qeuroal</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Qeuroal" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.umd.js" integrity="sha256-oyhjPiYRWGXaAt+ny/mTMWOnN1GBoZDUQnzzgC7FRI4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
