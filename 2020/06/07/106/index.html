<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/avatar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.css" integrity="sha256-vQkngPS8jiHHH0I6ABTZroZk8NPZ7b+MUReOFE9UsXQ=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"qeuroal.top","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="ArchLinux一条龙教程">
<meta property="og:type" content="article">
<meta property="og:title" content="106. ArchLinux安装与配置">
<meta property="og:url" content="http://qeuroal.top/2020/06/07/106/index.html">
<meta property="og:site_name" content="Qeuroal&#39;s Blog">
<meta property="og:description" content="ArchLinux一条龙教程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230512164413647.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230512165115342.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230525145603785.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230512165139951.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230512164127212.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230512165321543.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20230525145635511.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/pre-virt_vb-14.f584a45d.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/pre-virt_vb-15.a31fe3d1.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_reflector.bec7fc17.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_check-efi.3587e9b5.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_ping.e5fdc927.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_time.8c373965.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mirrorlist-1.2fbb4cac.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mirrorlist-2.d629c732.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-1.9b193f41.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-2.7f37722f.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-3.6e0ec78d.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-4.663d6a2c.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-5.7730dea4.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-6.3737931f.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-7.0f3c6bbd.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-8.6b57cad5.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-9.fba9a5fd.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-10.f9b2012a.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-11.83f16eaa.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-12.0de4b9b6.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-14.75c5863b.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_partition-13.a9c4fea3.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mkswap.92fdda71.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mkbtrfs-1.8feffffd.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mkbtrfs-2.74f8990b.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mkbtrfs-3.84a4679a.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mkbtrfs-4.8e3e329b.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mkbtrfs-5.fac45751.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mount-1.28218290.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mount-2.8f986f8d.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mount-3.c6d2697c.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_mount-4.f161aad4.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_pacstrap-1.5e46be8d.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_pacstrap-2.4c230553.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_fstab.2facd1ee.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_chroot.673ef529.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_set-name-and-timezone-1.a309cba5.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_set-name-and-timezone-2.15374034.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_set-name-and-timezone-3.fd00d670.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_set-name-and-timezone-4.48ebabec.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_locale-1.59ffa6db.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_locale-2.25d6b784.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_locale-3.ee2c4269.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_passwd.72a75688.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_grub-1.53b319a1.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_grub-2.e9c8c11f.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_grub-3.d220f785.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/os-prober-1.d6dd12a6.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_finish.3543840a.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_last-step-1.5ed5cd59.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_last-step-2.c76786d2.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_last-step-3.59f72c70.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/basic-install_neofetch.d338d5c5.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/btrfs-logo.1e008039.svg">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/image-20231231101859855.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/resize-partition-efi.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/drage-efi-partition.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/apply.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_update.457f4324.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_add-user.4be22c6e.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_visudo.d1333ce0.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_multilib.26b3c128.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_archlinuxcn.9cf33e22.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_syyu.5317b0de.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_install-kde.8c320ccd.png">
<meta property="og:image" content="https://arch.icekylin.online/assets/desktop-env-and-app_sign-in.f000e4d3.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_desktop.0a567cbc.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_sddm.38c7878b.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_konsole.5943a6a3.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_mkdir.93abe33a.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_language.166a6bff.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_effect.007423fd.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_fcitx5-1.12c3b346.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_fcitx5-2.f9355fb6.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_fcitx5-3.3c06dd53.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_fcitx5-4.9b027a55.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_fcitx5-5.cc71ac31.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_fcitx5-6.63c4d105.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_timeshift-install.e7a38ed8.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_timeshift-cfg-1.c882772d.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_timeshift-cfg-2.9d0b654b.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_timeshift-cfg-3.a0e8464e.png">
<meta property="og:image" content="http://qeuroal.top/2020/06/07/106/desktop-env-and-app_timeshift-cfg-4.72089020.png">
<meta property="article:published_time" content="2020-06-06T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-01T23:18:39.255Z">
<meta property="article:author" content="Qeuroal">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="archlinux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://qeuroal.top/2020/06/07/106/image-20230512164413647.png">


<link rel="canonical" href="http://qeuroal.top/2020/06/07/106/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://qeuroal.top/2020/06/07/106/","path":"2020/06/07/106/","title":"106. ArchLinux安装与配置"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>106. ArchLinux安装与配置 | Qeuroal's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Qeuroal's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">静幽正治</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87"><span class="nav-number">1.</span> <span class="nav-text">安装前的准备</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8C%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.1.</span> <span class="nav-text">双系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-number">1.2.</span> <span class="nav-text">虚拟机</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E9%A1%BA%E5%BA%8F-%E5%BF%85%E9%80%89"><span class="nav-number">1.2.1.</span> <span class="nav-text">启动顺序(必选)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9-%E5%8F%AF%E9%80%89"><span class="nav-number">1.2.2.</span> <span class="nav-text">共享文件夹(可选)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F-%E5%8F%AF%E9%80%89"><span class="nav-number">1.2.3.</span> <span class="nav-text">应用程序(可选)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%8D%B0%E6%9C%BA-%E5%8F%AF%E9%80%89"><span class="nav-number">1.2.4.</span> <span class="nav-text">打印机(可选)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CD-DVD-%E5%8F%AF%E9%80%89"><span class="nav-number">1.2.5.</span> <span class="nav-text">CD&#x2F;DVD(可选)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%94%E7%A6%BB-linux-%E4%B8%8E-mac"><span class="nav-number">1.2.6.</span> <span class="nav-text">隔离 linux 与 mac</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%AD3d%E5%8A%A0%E9%80%9F"><span class="nav-number">1.2.7.</span> <span class="nav-text">关闭3d加速</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#archlinux-%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85"><span class="nav-number">2.</span> <span class="nav-text">archlinux 基础安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0-%E8%BF%9B%E5%85%A5%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83"><span class="nav-number">2.1.</span> <span class="nav-text">0. 进入安装环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%A6%81%E7%94%A8-reflector-%E6%9C%8D%E5%8A%A1"><span class="nav-number">2.2.</span> <span class="nav-text">1. 禁用 reflector 服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%86%8D%E6%AC%A1%E7%A1%AE%E8%AE%A4%E6%98%AF%E5%90%A6%E4%B8%BA-UEFI-%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.3.</span> <span class="nav-text">2. 再次确认是否为 UEFI 模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C"><span class="nav-number">2.4.</span> <span class="nav-text">3. 连接网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8B%A5%E4%BD%BF%E7%94%A8%E6%97%A0%E7%BA%BF%E8%BF%9E%E6%8E%A5"><span class="nav-number">2.4.1.</span> <span class="nav-text">若使用无线连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8B%A5%E4%BD%BF%E7%94%A8%E6%9C%89%E7%BA%BF%E8%BF%9E%E6%8E%A5"><span class="nav-number">2.4.2.</span> <span class="nav-text">若使用有线连接</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E8%BF%9E%E9%80%9A%E6%80%A7"><span class="nav-number">2.5.</span> <span class="nav-text">4. 测试网络连通性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E6%9B%B4%E6%96%B0%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%92%9F"><span class="nav-number">2.6.</span> <span class="nav-text">5. 更新系统时钟</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E6%9B%B4%E6%8D%A2%E5%9B%BD%E5%86%85%E8%BD%AF%E4%BB%B6%E4%BB%93%E5%BA%93%E9%95%9C%E5%83%8F%E6%BA%90%E5%8A%A0%E5%BF%AB%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6"><span class="nav-number">2.7.</span> <span class="nav-text">6. 更换国内软件仓库镜像源加快下载速度</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E5%88%86%E5%8C%BA%E5%92%8C%E6%A0%BC%E5%BC%8F%E5%8C%96%EF%BC%88%E4%BD%BF%E7%94%A8-Btrfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%EF%BC%89"><span class="nav-number">2.8.</span> <span class="nav-text">7. 分区和格式化（使用 Btrfs 文件系统）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E5%88%86%E5%8C%BA"><span class="nav-number">2.8.1.</span> <span class="nav-text">7-1. 分区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B9%B6%E5%88%9B%E5%BB%BA-Btrfs-%E5%AD%90%E5%8D%B7"><span class="nav-number">2.8.2.</span> <span class="nav-text">7-2. 格式化并创建 Btrfs 子卷</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-0-%E6%A0%BC%E5%BC%8F%E5%8C%96-EFI-%E5%88%86%E5%8C%BA"><span class="nav-number">2.8.2.1.</span> <span class="nav-text">7-2.0. 格式化 EFI 分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-1-%E6%A0%BC%E5%BC%8F%E5%8C%96-Swap-%E5%88%86%E5%8C%BA"><span class="nav-number">2.8.2.2.</span> <span class="nav-text">7-2-1. 格式化 Swap 分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-2-%E6%A0%BC%E5%BC%8F%E5%8C%96-Btrfs-%E5%88%86%E5%8C%BA"><span class="nav-number">2.8.2.3.</span> <span class="nav-text">7-2-2. 格式化 Btrfs 分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-%E5%88%9B%E5%BB%BA-Btrfs-%E5%AD%90%E5%8D%B7"><span class="nav-number">2.8.2.4.</span> <span class="nav-text">7-2-3. 创建 Btrfs 子卷</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%8C%82%E8%BD%BD"><span class="nav-number">2.9.</span> <span class="nav-text">8. 挂载</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F"><span class="nav-number">2.10.</span> <span class="nav-text">9. 安装系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-%E7%94%9F%E6%88%90-fstab-%E6%96%87%E4%BB%B6"><span class="nav-number">2.11.</span> <span class="nav-text">10. 生成 fstab 文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-change-root"><span class="nav-number">2.12.</span> <span class="nav-text">11. change root</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-%E8%AE%BE%E7%BD%AE%E4%B8%BB%E6%9C%BA%E5%90%8D%E4%B8%8E%E6%97%B6%E5%8C%BA"><span class="nav-number">2.13.</span> <span class="nav-text">12. 设置主机名与时区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-%E7%A1%AC%E4%BB%B6%E6%97%B6%E9%97%B4%E8%AE%BE%E7%BD%AE"><span class="nav-number">2.14.</span> <span class="nav-text">13. 硬件时间设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-%E8%AE%BE%E7%BD%AE-Locale"><span class="nav-number">2.15.</span> <span class="nav-text">14. 设置 Locale</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-%E4%B8%BA-root-%E7%94%A8%E6%88%B7%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="nav-number">2.16.</span> <span class="nav-text">15. 为 root 用户设置密码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-%E5%AE%89%E8%A3%85%E5%BE%AE%E7%A0%81"><span class="nav-number">2.17.</span> <span class="nav-text">16. 安装微码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-%E5%AE%89%E8%A3%85%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F"><span class="nav-number">2.18.</span> <span class="nav-text">17. 安装引导程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-%E5%AE%8C%E6%88%90%E5%AE%89%E8%A3%85"><span class="nav-number">2.19.</span> <span class="nav-text">18. 完成安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A5%9D%E8%B4%BA%EF%BC%81"><span class="nav-number">2.20.</span> <span class="nav-text">祝贺！</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%98%BE%E5%8D%A1%E9%A9%B1%E5%8A%A8"><span class="nav-number">3.</span> <span class="nav-text">显卡驱动</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1"><span class="nav-number">3.1.</span> <span class="nav-text">集成显卡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Intel-%E6%A0%B8%E8%8A%AF%E6%98%BE%E5%8D%A1"><span class="nav-number">3.1.1.</span> <span class="nav-text">Intel 核芯显卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AMD-%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1"><span class="nav-number">3.1.2.</span> <span class="nav-text">AMD 集成显卡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E9%A9%B1%E5%8A%A8"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">选择驱动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">安装驱动</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1"><span class="nav-number">3.2.</span> <span class="nav-text">独立显卡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NVIDIA-%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1"><span class="nav-number">3.2.1.</span> <span class="nav-text">NVIDIA 独立显卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AMD-%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1"><span class="nav-number">3.2.2.</span> <span class="nav-text">AMD 独立显卡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8C%E6%98%BE%E5%8D%A1%EF%BC%88%E9%9B%86%E6%98%BE-%E7%8B%AC%E6%98%BE%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">双显卡（集显 + 独显）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NVIDIA-%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1-1"><span class="nav-number">3.3.1.</span> <span class="nav-text">NVIDIA 独立显卡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%88%87%E6%8D%A2"><span class="nav-number">3.3.1.1.</span> <span class="nav-text">动态切换</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#prime-run-%E6%96%B9%E6%B3%95"><span class="nav-number">3.3.1.1.1.</span> <span class="nav-text">prime-run 方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%96%B9%E6%B3%95"><span class="nav-number">3.3.1.1.2.</span> <span class="nav-text">环境变量方法</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E8%BE%93%E5%85%A5"><span class="nav-number">3.3.1.1.2.1.</span> <span class="nav-text">手动输入</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="nav-number">3.3.1.1.2.2.</span> <span class="nav-text">全局变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86"><span class="nav-number">3.3.1.2.</span> <span class="nav-text">电源管理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AMD-%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1-1"><span class="nav-number">3.3.2.</span> <span class="nav-text">AMD 独立显卡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="nav-number">3.4.</span> <span class="nav-text">性能测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#glxgears"><span class="nav-number">3.4.1.</span> <span class="nav-text">glxgears</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#glmark2"><span class="nav-number">3.4.2.</span> <span class="nav-text">glmark2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Unigine-benchmark"><span class="nav-number">3.4.3.</span> <span class="nav-text">Unigine benchmark</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%98%BE%E5%8D%A1%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B"><span class="nav-number">3.5.</span> <span class="nav-text">显卡信息查看</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NVIDIA-%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1-2"><span class="nav-number">3.5.1.</span> <span class="nav-text">NVIDIA 独立显卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AMD-%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1-%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1"><span class="nav-number">3.5.2.</span> <span class="nav-text">AMD 独立显卡 &#x2F; 集成显卡</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85%E8%AF%A6%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">基础安装详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E5%92%8C%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">4.1.</span> <span class="nav-text">分区和格式化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8-Btrfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">4.1.1.</span> <span class="nav-text">为什么要用 Btrfs 文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%A0%E7%BB%9F-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%AF%B4%E6%98%8E"><span class="nav-number">4.1.2.</span> <span class="nav-text">传统 ext4 文件系统说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E6%96%B0%E5%AE%89%E8%A3%85"><span class="nav-number">4.1.3.</span> <span class="nav-text">全新安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%BB%BA%E7%AB%8B%E6%96%B0%E7%9A%84-GPT-%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">4.1.3.1.</span> <span class="nav-text">1. 建立新的 GPT 分区表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%BB%BA%E7%AB%8B-EFI-%E5%88%86%E5%8C%BA"><span class="nav-number">4.1.3.2.</span> <span class="nav-text">2. 建立 EFI 分区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%A0%BC%E5%BC%8F%E5%8C%96-EFI-%E5%88%86%E5%8C%BA"><span class="nav-number">4.1.3.3.</span> <span class="nav-text">3. 格式化 EFI 分区</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Swap-%E5%88%86%E5%8C%BA%E5%92%8C-Swap-%E6%96%87%E4%BB%B6"><span class="nav-number">4.1.4.</span> <span class="nav-text">Swap 分区和 Swap 文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E5%92%8C%E6%96%B0%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">4.2.</span> <span class="nav-text">安装环境和新系统的关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%BB%BA%E6%88%BF%E5%AD%90"><span class="nav-number">4.2.1.</span> <span class="nav-text">1. 建房子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BB%BA%E7%AB%8B%E9%80%9A%E9%81%93"><span class="nav-number">4.2.2.</span> <span class="nav-text">2. 建立通道</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%B7%BB%E7%BD%AE%E5%AE%B6%E5%85%B7"><span class="nav-number">4.2.3.</span> <span class="nav-text">3. 添置家具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%90%AC%E8%BF%9B%E6%96%B0%E5%AE%B6"><span class="nav-number">4.2.4.</span> <span class="nav-text">4. 搬进新家</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F"><span class="nav-number">4.3.</span> <span class="nav-text">多系统配置引导程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB-QAs"><span class="nav-number">4.4.</span> <span class="nav-text">杂七杂八 + QAs</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83%E4%B8%8E%E5%B8%B8%E7%94%A8%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85"><span class="nav-number">5.</span> <span class="nav-text">桌面环境与常用应用安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A1%AE%E4%BF%9D%E7%B3%BB%E7%BB%9F%E4%B8%BA%E6%9C%80%E6%96%B0"><span class="nav-number">5.1.</span> <span class="nav-text">确保系统为最新</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE-root-%E8%B4%A6%E6%88%B7%E7%9A%84%E9%BB%98%E8%AE%A4%E7%BC%96%E8%BE%91%E5%99%A8"><span class="nav-number">5.2.</span> <span class="nav-text">配置 root 账户的默认编辑器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E9%9D%9E-root-%E7%94%A8%E6%88%B7"><span class="nav-number">5.3.</span> <span class="nav-text">准备非 root 用户</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%90%AF-32-%E4%BD%8D%E6%94%AF%E6%8C%81%E5%BA%93%E4%B8%8E-Arch-Linux-%E4%B8%AD%E6%96%87%E7%A4%BE%E5%8C%BA%E4%BB%93%E5%BA%93%EF%BC%88archlinuxcn%EF%BC%89"><span class="nav-number">5.4.</span> <span class="nav-text">开启 32 位支持库与 Arch Linux 中文社区仓库（archlinuxcn）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-KDE-Plasma-%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83"><span class="nav-number">5.5.</span> <span class="nav-text">安装 KDE Plasma 桌面环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%B9%B6%E5%90%AF%E5%8A%A8-greeter-sddm"><span class="nav-number">5.6.</span> <span class="nav-text">配置并启动 greeter sddm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E5%8C%85"><span class="nav-number">5.7.</span> <span class="nav-text">安装基础功能包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E5%AE%B6%E7%9B%AE%E5%BD%95"><span class="nav-number">5.8.</span> <span class="nav-text">检查家目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9D%9E-root-%E8%B4%A6%E6%88%B7%E7%9A%84%E9%BB%98%E8%AE%A4%E7%BC%96%E8%BE%91%E5%99%A8"><span class="nav-number">5.9.</span> <span class="nav-text">配置非 root 账户的默认编辑器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E7%B3%BB%E7%BB%9F%E4%B8%BA%E4%B8%AD%E6%96%87"><span class="nav-number">5.10.</span> <span class="nav-text">设置系统为中文</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E8%BE%93%E5%85%A5%E6%B3%95"><span class="nav-number">5.11.</span> <span class="nav-text">安装输入法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E8%93%9D%E7%89%99%EF%BC%88%E8%8B%A5%E6%9C%89%EF%BC%89"><span class="nav-number">5.12.</span> <span class="nav-text">启动蓝牙（若有）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE-Timeshift-%E5%BF%AB%E7%85%A7"><span class="nav-number">5.13.</span> <span class="nav-text">设置 Timeshift 快照</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8B%A5%E4%BD%BF%E7%94%A8-Btrfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">5.13.1.</span> <span class="nav-text">若使用 Btrfs 文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8B%A5%E4%BD%BF%E7%94%A8-ext4-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">5.13.2.</span> <span class="nav-text">若使用 ext4 文件系统</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%AA%E6%A3%92%E4%BA%86"><span class="nav-number">5.14.</span> <span class="nav-text">太棒了</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Qeuroal"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Qeuroal</p>
  <div class="site-description" itemprop="description">大人者，不失其赤子之心</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">185</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Qeuroal" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Qeuroal" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://qeuroal.top/2020/06/07/106/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Qeuroal">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Qeuroal's Blog">
      <meta itemprop="description" content="大人者，不失其赤子之心">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="106. ArchLinux安装与配置 | Qeuroal's Blog">
      <meta itemprop="description" content="ArchLinux一条龙教程">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          106. ArchLinux安装与配置
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-06-07 00:00:00" itemprop="dateCreated datePublished" datetime="2020-06-07T00:00:00+08:00">2020-06-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-10-02 07:18:39" itemprop="dateModified" datetime="2025-10-02T07:18:39+08:00">2025-10-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a>
        </span>
    </span>

  
</div>

            <div class="post-description">ArchLinux一条龙教程</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="安装前的准备"><a href="#安装前的准备" class="headerlink" title="安装前的准备"></a>安装前的准备</h1><h2 id="双系统"><a href="#双系统" class="headerlink" title="双系统"></a>双系统</h2><ul>
<li>选择安装选项时, 在 <code>Arch Linux install medium (x86_64, UEFI)</code> 选项时, 按 <code>e</code> 键, 末尾添加 <code>nomodeset</code></li>
</ul>
<h2 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h2><h3 id="启动顺序-必选"><a href="#启动顺序-必选" class="headerlink" title="启动顺序(必选)"></a>启动顺序(<strong>必选</strong>)</h3><p>启动顺序 -&gt; 高级 -&gt; BIOS:EFI 64位</p>
<img data-src="/2020/06/07/106/image-20230512164413647.png" class="" title="image-20230512164413647"> 

<h3 id="共享文件夹-可选"><a href="#共享文件夹-可选" class="headerlink" title="共享文件夹(可选)"></a>共享文件夹(可选)</h3><p>选择 整个 <code>$HOME</code> 目录吧</p>
<img data-src="/2020/06/07/106/image-20230512165115342.png" class="" title="image-20230512165115342">

<img data-src="/2020/06/07/106/image-20230525145603785.png" class="" title="image-20230525145603785">



<h3 id="应用程序-可选"><a href="#应用程序-可选" class="headerlink" title="应用程序(可选)"></a>应用程序(可选)</h3><img data-src="/2020/06/07/106/image-20230512165139951.png" class="" title="image-20230512165139951">

<h3 id="打印机-可选"><a href="#打印机-可选" class="headerlink" title="打印机(可选)"></a>打印机(可选)</h3><img data-src="/2020/06/07/106/image-20230512164127212.png" class="" title="image-20230512164127212">

<h3 id="CD-DVD-可选"><a href="#CD-DVD-可选" class="headerlink" title="CD&#x2F;DVD(可选)"></a>CD&#x2F;DVD(可选)</h3><img data-src="/2020/06/07/106/image-20230512165321543.png" class="" title="image-20230512165321543">

<h3 id="隔离-linux-与-mac"><a href="#隔离-linux-与-mac" class="headerlink" title="隔离 linux 与 mac"></a>隔离 linux 与 mac</h3><p>不建议打开</p>
<h3 id="关闭3d加速"><a href="#关闭3d加速" class="headerlink" title="关闭3d加速"></a>关闭3d加速</h3><img data-src="/2020/06/07/106/image-20230525145635511.png" class="" title="image-20230525145635511">



<h1 id="archlinux-基础安装"><a href="#archlinux-基础安装" class="headerlink" title="archlinux 基础安装"></a>archlinux 基础安装</h1><blockquote>
<p>⛵ 万事俱备，只欠东风</p>
<p>经过了上一节的准备工作，我们可以开始正式安装 archlinux 了。如果你还没有完成前面的阅读，请先仔细阅读章节 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/pre-install.html">安装前的准备</a>。如果对本节的步骤不理解或者有疑问，请阅读下一节 <a href="#%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85%E8%AF%A6%E8%A7%A3">基础安装详解</a></p>
</blockquote>
<p>本节从安装最基础的、无图形化界面的 archlinux 系统开始。如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchWiki 官方安装指南</a>。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>本节中的截图来自虚拟机和已经安装好的 archlinux。不用担心！和你在实体机看到的是一样的。</p>
</blockquote>
<blockquote>
<p>⚠️ 注意</p>
<p>请按照指南的步骤一步一步进行！不要跳步、也不要在步骤中添加多余的动作！</p>
<p>另外，如果安装中有报错，请弄清楚报错的原因（这要求你起码能看懂有报错）！常见的原因包括但不限于输错了命令、添加了多余的步骤等。在解决了问题之后再进行下一步！</p>
</blockquote>
<h2 id="0-进入安装环境"><a href="#0-进入安装环境" class="headerlink" title="0. 进入安装环境"></a>0. 进入安装环境</h2><img data-src="/2020/06/07/106/pre-virt_vb-14.f584a45d.png" class="" title="archlinux-iso-1">

<ol>
<li><p>在第一个选项回车</p>
<img data-src="/2020/06/07/106/pre-virt_vb-15.a31fe3d1.png" class="" title="archlinux-iso-2">
</li>
<li><p>进入安装环境后，便可以开始通过命令安装 archlinux 了</p>
</li>
</ol>
<h2 id="1-禁用-reflector-服务"><a href="#1-禁用-reflector-服务" class="headerlink" title="1. 禁用 reflector 服务"></a>1. 禁用 reflector 服务</h2><p>2020 年，archlinux 安装镜像中加入了 <code>reflector</code> 服务，它会自己更新 <code>mirrorlist</code>（软件包管理器 <code>pacman</code> 的软件源）。在特定情况下，它会误删某些有用的源信息。这里进入安装环境后的第一件事就是将其禁用。也许它是一个好用的工具，但是很明显，因为地理上造成的特殊网络环境，这项服务并不适合启用。</p>
<ol>
<li><p>通过以下命令将该服务禁用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop reflector.service</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过以下命令查看该服务是否被禁用，按下 <code>q</code> 退出结果输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status reflector.service</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_reflector.bec7fc17.png" class="" title="stop-reflector"></li>
</ol>
<blockquote>
<p>ℹ️ 提示</p>
<p>在命令行中你可以使用如下命令清屏：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clear</span><br></pre></td></tr></table></figure>

<p>同时，你可以使用 <code>Tab</code> 键在输入命令的时候对命令、参数或文件路径进行自动补全，提高效率的同时降低输入错误的风险。</p>
</blockquote>
<h2 id="2-再次确认是否为-UEFI-模式"><a href="#2-再次确认是否为-UEFI-模式" class="headerlink" title="2. 再次确认是否为 UEFI 模式"></a>2. 再次确认是否为 UEFI 模式</h2><p>禁用 <code>reflector</code> 服务后，我们再来确认一下是否为 <code>UEFI</code> 模式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /sys/firmware/efi/efivars</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_check-efi.3587e9b5.png" class="" title="check-efi">

<p>若输出了一堆东西（<code>efi</code> 变量），则说明已在 <code>UEFI</code> 模式。否则请确认你的启动方式是否为 <code>UEFI</code>。</p>
<h2 id="3-连接网络"><a href="#3-连接网络" class="headerlink" title="3. 连接网络"></a>3. 连接网络</h2><blockquote>
<p>ℹ️ 提示</p>
<p>archlinux 的安装<strong>必须</strong>要求网络环境。</p>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>若为虚拟机且按照上一节 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/pre-virt.html#_3-%E9%85%8D%E7%BD%AE-virtualbox">虚拟机安装前的准备</a> 进行了配置；同时宿主机连接了网络，那么虚拟机应该已经连接网络了。</p>
</blockquote>
<h3 id="若使用无线连接"><a href="#若使用无线连接" class="headerlink" title="若使用无线连接"></a>若使用<strong>无线连接</strong></h3><p>使用 <code>iwctl</code> 进行连接：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">iwctl <span class="comment"># 进入交互式命令行</span></span><br><span class="line">device list <span class="comment"># 列出无线网卡设备名，比如无线网卡看到叫 wlan0</span></span><br><span class="line">station wlan0 scan <span class="comment"># 扫描网络</span></span><br><span class="line">station wlan0 get-networks <span class="comment"># 列出所有 wifi 网络</span></span><br><span class="line">station wlan0 connect wifi-name <span class="comment"># 进行连接，注意这里无法输入中文。回车后输入密码即可</span></span><br><span class="line"><span class="built_in">exit</span> <span class="comment"># 连接成功后退出</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ℹ️ 提示</p>
<p>若无线网卡无法显示，请按照上一节 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/pre-install.html#_1-%E7%A1%AE%E4%BF%9D%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83">确保网络环境</a> 的说明<strong>确保你的无线网卡硬件开关处于打开状态</strong>。</p>
<p>你可以使用如下命令查看内核是否加载了你的无线网卡驱动。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci -k | grep Network</span><br></pre></td></tr></table></figure>

<p>以我的硬件为例，输出如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00:14.3 Network controller: Intel Corporation Wi-Fi 6 AX201 (rev 20)</span><br></pre></td></tr></table></figure>

<p>如果你的 BIOS 没有开启无线网卡的开关可以参考下列的命令来开启 <code>WIFI</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rfkill list <span class="comment">#查看无线连接 是否被禁用(blocked: yes)</span></span><br><span class="line">ip <span class="built_in">link</span> <span class="built_in">set</span> wlan0 up <span class="comment">#比如无线网卡看到叫 wlan0</span></span><br></pre></td></tr></table></figure>

<p>若看到类似<code>Operation not possible due to RF-kill</code>的报错，继续尝试<code>rfkill unblock wifi</code>来解锁无线网卡。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rfkill unblock wifi</span><br></pre></td></tr></table></figure>

<p>部分无线网卡不兼容，请考虑使用有线连接安装 archlinux。</p>
</blockquote>
<h3 id="若使用有线连接"><a href="#若使用有线连接" class="headerlink" title="若使用有线连接"></a>若使用<strong>有线连接</strong></h3><p>正常来说，只要插上一个已经联网的路由器分出的网线（DHCP），直接就能联网。</p>
<p>可以等待几秒等网络建立连接后再进行下一步测试网络的操作。</p>
<p>若笔记本没有网线接口请使用带网线接口的扩展坞。</p>
<h2 id="4-测试网络连通性"><a href="#4-测试网络连通性" class="headerlink" title="4. 测试网络连通性"></a>4. 测试网络连通性</h2><p>通过 <code>ping</code> 命令测试网络连通性：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.bilibili.com</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_ping.e5fdc927.png" class="" title="ping">

<p>稍等片刻，若能看到数据返回，即说明已经联网。与 Windows 不同的是，需要按下 <code>Ctrl</code> + <code>C</code> 手动退出 <code>ping</code> 命令。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>如果无线网络还是无法连接，请使用 <code>ip link</code> 命令查看无线网卡设备，使用 <code>ip link set &lt;设备名&gt; up</code> 命令激活对应的无线网卡。若看到类似 <code>Operation not possible due to RF-kill</code> 的报错，继续尝试 <code>rfkill unblock wifi</code> 来解锁无线网卡。</p>
<p>如有需要，可以参考 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Network_configuration_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)/Wireless_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E6%A3%80%E6%9F%A5%E8%AE%BE%E5%A4%87%E7%8A%B6%E6%80%81">ArchWiki 相关内容</a>。</p>
</blockquote>
<h2 id="5-更新系统时钟"><a href="#5-更新系统时钟" class="headerlink" title="5. 更新系统时钟"></a>5. 更新系统时钟</h2><p>使用 <code>timedatectl</code> 确保系统时间是准确的。这一步<strong>不是</strong>可选的，正确的系统时间对于部分程序来说非常重要：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">timedatectl set-ntp <span class="literal">true</span> <span class="comment"># 将系统时间与网络时间进行同步</span></span><br><span class="line">timedatectl status <span class="comment"># 检查服务状态</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_time.8c373965.png" class="" title="time">

<h2 id="6-更换国内软件仓库镜像源加快下载速度"><a href="#6-更换国内软件仓库镜像源加快下载速度" class="headerlink" title="6. 更换国内软件仓库镜像源加快下载速度"></a>6. 更换国内软件仓库镜像源加快下载速度</h2><p>使用 <code>vim</code> 编辑器修改 <code>/etc/pacman.d/mirrorlist</code> 文件。将 <code>pacman</code> 软件仓库源更换为国内软件仓库镜像源：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pacman.d/mirrorlist</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ℹ️ 提示</p>
<p>如果不会使用 <code>vim</code> 编辑器，请参阅 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/advanced/system-ctl.html#%E7%BB%88%E7%AB%AF%E7%BC%96%E8%BE%91%E5%99%A8-vim-%E7%9A%84%E4%BD%BF%E7%94%A8">这里</a>。</p>
<p><code>vim</code> 编辑器在安装和配置系统的过程中还需要使用多次。</p>
</blockquote>
<p>放在最上面的是会使用的软件仓库镜像源，推荐的镜像源如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch # 中国科学技术大学开源镜像站</span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch # 清华大学开源软件镜像站</span><br><span class="line">Server = https://repo.huaweicloud.com/archlinux/$repo/os/$arch # 华为开源镜像站</span><br><span class="line">Server = http://mirror.lzu.edu.cn/archlinux/$repo/os/$arch # 兰州大学开源镜像站</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mirrorlist-1.2fbb4cac.png" class="" title="mirrorlist-1">

<p>修改完成的 <code>/etc/pacman.d/mirrorlist</code> 文件如图所示。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>如果发现 <code>/etc/pacman.d/mirrorlist</code> 是如图这个样子的，那么说明你禁用 <code>reflector</code> 服务晚了。<code>reflector</code> 已经自动帮你生成了新的软件仓库镜像源列表。不过没有关系，手动将国内软件仓库镜像源放在最前面即可。</p>
<img data-src="/2020/06/07/106/basic-install_mirrorlist-2.d629c732.png" class="" title="mirrorlist-2">

</blockquote>
<blockquote>
<p>⚠️ 注意</p>
<p>前车之鉴 —— 请不在这一步中添加 <code>archlinuxcn</code> 源！如果你在 <code>/etc/pacman.conf</code> 中添加了内容，请将它们删掉。</p>
</blockquote>
<h2 id="7-分区和格式化（使用-Btrfs-文件系统）"><a href="#7-分区和格式化（使用-Btrfs-文件系统）" class="headerlink" title="7. 分区和格式化（使用 Btrfs 文件系统）"></a>7. 分区和格式化（使用 Btrfs 文件系统）</h2><h3 id="7-1-分区"><a href="#7-1-分区" class="headerlink" title="7-1. 分区"></a>7-1. 分区</h3><blockquote>
<p>ℹ️ 提示</p>
<p>虚拟机安装请同时参阅步骤 <a href="#%E5%85%A8%E6%96%B0%E5%AE%89%E8%A3%85">🆕 全新安装</a>。</p>
<p>分区步骤对于有些人来说是个难点，如果有不理解的地方请参阅下一节 <a href="#%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85%E8%AF%A6%E8%A7%A3">基础安装详解</a>。</p>
<p>同时，分区其它说明也会在下一节 <a href="#%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85%E8%AF%A6%E8%A7%A3">基础安装详解</a> 详细列出。</p>
</blockquote>
<blockquote>
<p>☢️ 警告</p>
<p>分区操作的部分命令具有危险性！除非你知道每一个命令在干什么，否则请不要执行！</p>
<p>同时，请提前做好数据备份，防止数据丢失！</p>
</blockquote>
<p>本指南考虑到多数情况，在这里首先介绍 win10 和 archlinux 在一个磁盘上双系统的分区配置。</p>
<ul>
<li><code>/</code> 根目录：<code>&gt;= 128GB</code>（和用户主目录在同一个 <code>Btrfs</code> 文件系统上）</li>
<li><code>/home</code> 用户主目录：<code>&gt;= 128GB</code>（和根目录在同一个 <code>Btrfs</code> 文件系统上）</li>
<li><code>/boot</code> EFI 分区：<code>256MB</code>（由电脑厂商或 Windows 决定，无需再次创建）</li>
<li>Swap 分区：<code>&gt;= 电脑实际运行内存的 60%</code>（设置这个大小是为了配置休眠准备）</li>
</ul>
<blockquote>
<p>ℹ️ 提示</p>
<p>因为采用 <code>Btrfs</code> 文件系统，所以根目录和用户主目录实际在一个分区上，只是在不同的子卷上而已。这里根目录和用户主目录的大小仅为参考，一般来说日常使用的 linux 分配 128GB 已经够用了。</p>
</blockquote>
<ol>
<li><p>通过 <code>lsblk</code> 命令，区分要安装 archlinux 的磁盘（通过观察磁盘的大小、已存在的分区情况等判断）并显示当前磁盘的分区情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk <span class="comment"># 显示当前分区情况</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_partition-1.9b193f41.png" class="" title="partition-1">

<p>此处要分区和安装 archlinux 的磁盘即为 <code>sda</code>。请根据你的实际情况判断！</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>为了模拟真实的环境，笔者手动创建了三个分区分别代表：</p>
<ol>
<li><code>sda1</code> —— EFI 分区</li>
<li><code>sda2</code> —— win10 下的 C 盘（象征性的分了 <code>1GB</code>）</li>
<li><code>sda3</code> —— win10 下的 D 盘（象征性的分了 <code>1GB</code>）</li>
</ol>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>注意此处并不会显出出未分配的磁盘空间！只有在使用 <code>cfdisk</code> 执行分区操作后才会显示出来。</p>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>如果你的硬盘是 NVME 协议的固态硬盘，那么将不是 <code>sdx</code> 而是 <code>nvmexn1</code>。</p>
</blockquote>
</li>
<li><p>接下来使用 <code>cfdisk</code> 命令对磁盘分区（对于 SATA 协议的硬盘，<code>x</code> 为字母 <code>a</code>、<code>b</code> 或 <code>c</code> 等等；对于 NVME 协议的硬盘，<code>x</code> 为数字 <code>0</code>、<code>1</code> 或 <code>2</code> 等等，请根据实际情况判断）：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfdisk /dev/sdx <span class="comment"># 对安装 archlinux 的磁盘分区</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cfdisk /dev/nvmexn1 <span class="comment"># 对安装 archlinux 的磁盘分区</span></span><br></pre></td></tr></table></figure></li>
</ul>
<img data-src="/2020/06/07/106/basic-install_partition-2.7f37722f.png" class="" title="partition-2">

<p>进入 <code>cfdisk</code> 分区工具之后，你会看到如图所示的界面。通过方向键 <code>↑</code> 和 <code>↓</code> 可以在要操作磁盘分区或空余空间中移动；通过方向键 <code>←</code> 和 <code>→</code> 在对当前高亮的磁盘分区或空余空间要执行的操作中移动。</p>
</li>
<li><p>首先创建 Swap 分区。选中 <code>Free space</code> &gt; 再选中操作 <code>[New]</code> &gt; 然后按下回车 <code>Enter</code> 以新建 <code>swap</code> 分区（类似 Windows 的交换文件）</p>
<img data-src="/2020/06/07/106/basic-install_partition-3.6e0ec78d.png" class="" title="partition-3">
</li>
<li><p>按下回车后会提示输入 <code>分区大小</code>，Swap 分区建议为**电脑内存大小的 60%**，或者和内存大小相等 -&gt; 然后按下回车 <code>Enter</code></p>
<img data-src="/2020/06/07/106/basic-install_partition-4.663d6a2c.png" class="" title="partition-4">

<blockquote>
<p>ℹ️ 提示</p>
<p>单位可以自行输入，如 <code>GB</code>、<code>MB</code> 等等。</p>
</blockquote>
</li>
<li><p>默认新建的类型是 <code>Linux filesystem</code>，我们需要将类型更改为 <code>Linux swap</code>。选中操作 <code>[Type]</code> &gt; 然后按下回车 <code>Enter</code> &gt; 通过方向键 <code>↑</code> 和 <code>↓</code> 选中 <code>Linux swap</code> &gt; 最后按下回车 <code>Enter</code></p>
<img data-src="/2020/06/07/106/basic-install_partition-5.7730dea4.png" class="" title="partition-5">

<img data-src="/2020/06/07/106/basic-install_partition-6.3737931f.png" class="" title="partition-6">

<img data-src="/2020/06/07/106/basic-install_partition-7.0f3c6bbd.png" class="" title="partition-7">
</li>
<li><p>我们再只需要一个分区即可（因为使用 <code>Btrfs</code> 文件系统，所以根目录和用户主目录在一个分区上），所以类似的：选中 <code>Free space</code> &gt; 再选中操作 <code>[New]</code> &gt; 然后按下回车 <code>Enter</code> 以新建分区</p>
<img data-src="/2020/06/07/106/basic-install_partition-8.6b57cad5.png" class="" title="partition-8">
</li>
<li><p>输入 <code>分区大小</code>（默认是剩余的全部空间。请根据实际情况输入）&gt; 然后按下回车 <code>Enter</code></p>
<img data-src="/2020/06/07/106/basic-install_partition-9.fba9a5fd.png" class="" title="partition-9">
</li>
<li><p>分区类型默认即可，无需更改。接下来选中操作 <code>[Write]</code> 并回车 <code>Enter</code> &gt; 输入 <code>yes</code> 并回车 <code>Enter</code> 确认分区操作</p>
<img data-src="/2020/06/07/106/basic-install_partition-10.f9b2012a.png" class="" title="partition-10">

<img data-src="/2020/06/07/106/basic-install_partition-11.83f16eaa.png" class="" title="partition-11">

<blockquote>
<p>⚠️ 注意</p>
<p>只有写入了操作分区表才会更改。</p>
</blockquote>
</li>
<li><p>选中操作 <code>[Quit]</code> 并回车 <code>Enter</code> 以退出 <code>cfdisk</code> 分区工具</p>
<img data-src="/2020/06/07/106/basic-install_partition-12.0de4b9b6.png" class="" title="partition-12">

<blockquote>
<p>☢️ 警告</p>
<p>再次提醒！请仔细检查命令和操作的正确性，否则将出现不可预料的情况。最危险的是可能造成数据丢失！</p>
<p>常见的错误包括不小心把 Windows 的分区删掉了 😥。</p>
</blockquote>
</li>
<li><p>分区完成后，使用 <code>fdisk</code> 或 <code>lsblk</code> 命令复查分区情况：</p>
<ol>
<li><p>fdisk</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l <span class="comment"># 复查磁盘情况</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_partition-14.75c5863b.png" class="" title="partition-14">
</li>
<li><p>lsblk</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk <span class="comment"># 复查磁盘情况</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_partition-13.a9c4fea3.png" class="" title="partition-13"></li>
</ol>
</li>
</ol>
<h3 id="7-2-格式化并创建-Btrfs-子卷"><a href="#7-2-格式化并创建-Btrfs-子卷" class="headerlink" title="7-2. 格式化并创建 Btrfs 子卷"></a>7-2. 格式化并创建 Btrfs 子卷</h3><h4 id="7-2-0-格式化-EFI-分区"><a href="#7-2-0-格式化-EFI-分区" class="headerlink" title="7-2.0. 格式化 EFI 分区"></a>7-2.0. 格式化 EFI 分区</h4><ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.fat -F32 /dev/sdxn</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.fat -F32 /dev/nvmexn1pn</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>⚠️ 注意</p>
<p>如果目标是双系统（Win10&#x2F;Win11 + Arch Linux），并且 Win10&#x2F;Win11 和 Arch Linux 将要共存在一个硬盘上的话，不要重新格式化原有的 EFI 分区，因为它可能包含启动其他操作系统所需的文件。</p>
</blockquote>
<h4 id="7-2-1-格式化-Swap-分区"><a href="#7-2-1-格式化-Swap-分区" class="headerlink" title="7-2-1. 格式化 Swap 分区"></a>7-2-1. 格式化 Swap 分区</h4><p>通过以下命令格式化对应的 Swap 分区，请按照实际情况替换 <code>x</code> 和 <code>n</code>（下同）：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkswap /dev/sdxn</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkswap /dev/nvmexn1pn</span><br></pre></td></tr></table></figure></li>
</ul>
<img data-src="/2020/06/07/106/basic-install_mkswap.92fdda71.png" class="" title="mkswap">

<h4 id="7-2-2-格式化-Btrfs-分区"><a href="#7-2-2-格式化-Btrfs-分区" class="headerlink" title="7-2-2. 格式化 Btrfs 分区"></a>7-2-2. 格式化 Btrfs 分区</h4><ol>
<li><p>首先我们需要将整一个分区格式化为 <code>Btrfs</code> 文件系统。使用如下命令进行格式化：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.btrfs -L myArch /dev/sdxn</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.btrfs -L myArch /dev/nvmexn1pn</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><code>-L</code> 选项后指定该分区的 <code>LABLE</code>，这里以 <code>myArch</code> 为例，也可以自定义，但不能使用特殊字符以及空格，且最好有意义</li>
</ul>
</blockquote>
<img data-src="/2020/06/07/106/basic-install_mkbtrfs-1.8feffffd.png" class="" title="mkbtrfs_step-1">
</li>
<li><p>为了创建子卷，我们需要先将 <code>Btrfs</code> 分区挂载到 <code>/mnt</code> 下：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o compress=zstd /dev/sdxn /mnt</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o compress=zstd /dev/nvmexn1pn /mnt</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><p><code>-t</code> 选项后指定挂载分区文件系统类型</p>
</li>
<li><p><code>-o</code> 选项后添加挂载参数：<br>- <code>compress=zstd</code> —— 开启透明压缩</p>
</li>
</ul>
</blockquote>
</li>
<li><p>使用 <code>df</code> 命令复查挂载情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h <span class="comment"># -h 选项会使输出以人类可读的单位显示</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mkbtrfs-2.74f8990b.png" class="" title="mkbtrfs_step-2"></li>
</ol>
<h4 id="7-2-3-创建-Btrfs-子卷"><a href="#7-2-3-创建-Btrfs-子卷" class="headerlink" title="7-2-3. 创建 Btrfs 子卷"></a>7-2-3. 创建 Btrfs 子卷</h4><ol>
<li><p>通过以下命令创建两个 <code>Btrfs</code> 子卷，之后将分别挂载到 <code>/</code> 根目录和 <code>/home</code> 用户主目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">btrfs subvolume create /mnt/@ <span class="comment"># 创建 / 目录子卷</span></span><br><span class="line">btrfs subvolume create /mnt/@home <span class="comment"># 创建 /home 目录子卷</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mkbtrfs-3.84a4679a.png" class="" title="mkbtrfs_step-3">

<blockquote>
<p>⚠️ 注意</p>
<p>除非你清楚你的操作产生的后果，否则请保持子卷名称和结构与本指南一致，因为在后面我们会设置的快照工具 <code>timeshift</code> 只支持这种子卷布局。</p>
</blockquote>
</li>
<li><p>通过以下命令复查子卷情况：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btrfs subvolume list -p /mnt</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mkbtrfs-4.8e3e329b.png" class="" title="mkbtrfs_step-4">
</li>
<li><p>子卷创建好后，我们需要将 <code>/mnt</code> 卸载掉，以挂载子卷：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount /mnt</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mkbtrfs-5.fac45751.png" class="" title="mkbtrfs_step-5"></li>
</ol>
<h2 id="8-挂载"><a href="#8-挂载" class="headerlink" title="8. 挂载"></a>8. 挂载</h2><ol>
<li><p>在挂载时，挂载是有顺序的，需要从根目录开始挂载。使用如下命令挂载子卷：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o subvol=/@,compress=zstd /dev/sdxn /mnt <span class="comment"># 挂载 / 目录</span></span><br><span class="line"><span class="built_in">mkdir</span> /mnt/home <span class="comment"># 创建 /home 目录</span></span><br><span class="line">mount -t btrfs -o subvol=/@home,compress=zstd /dev/sdxn /mnt/home <span class="comment"># 挂载 /home 目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/boot <span class="comment"># 创建 /boot 目录</span></span><br><span class="line">mount /dev/sdxn /mnt/boot <span class="comment"># 挂载 /boot 目录</span></span><br><span class="line">swapon /dev/sdxn <span class="comment"># 挂载交换分区</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mount -t btrfs -o subvol=/@,compress=zstd /dev/nvmexn1pn /mnt <span class="comment"># 挂载 / 目录</span></span><br><span class="line"><span class="built_in">mkdir</span> /mnt/home <span class="comment"># 创建 /home 目录</span></span><br><span class="line">mount -t btrfs -o subvol=/@home,compress=zstd /dev/nvmexn1pn /mnt/home <span class="comment"># 挂载 /home 目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/boot <span class="comment"># 创建 /boot 目录</span></span><br><span class="line">mount /dev/nvmexn1pn /mnt/boot <span class="comment"># 挂载 /boot 目录</span></span><br><span class="line">swapon /dev/nvmexn1pn <span class="comment"># 挂载交换分区</span></span><br></pre></td></tr></table></figure></li>
</ul>
<img data-src="/2020/06/07/106/basic-install_mount-1.28218290.png" class="" title="mount_step-1">

<img data-src="/2020/06/07/106/basic-install_mount-2.8f986f8d.png" class="" title="mount_step-2">
</li>
<li><p>使用 <code>df</code> 命令复查挂载情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mount-3.c6d2697c.png" class="" title="mount_step-3">
</li>
<li><p>使用 <code>free</code> 命令复查 Swap 分区挂载情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -h <span class="comment"># -h 选项会使输出以人类可读的单位显示</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_mount-4.f161aad4.png" class="" title="mount_step-4"></li>
</ol>
<h2 id="9-安装系统"><a href="#9-安装系统" class="headerlink" title="9. 安装系统"></a>9. 安装系统</h2><ol>
<li><p>通过如下命令使用 <code>pacstrap</code> 脚本安装基础包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacstrap /mnt base base-devel linux linux-firmware btrfs-progs</span><br><span class="line"><span class="comment"># 如果使用btrfs文件系统，额外安装一个btrfs-progs包</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><code>base-devel</code> —— <code>base-devel</code> 在 <code>AUR</code> 包的安装过程中是必须用到的</li>
<li><code>linux</code> —— 内核软件包，这里建议先不要替换为其它内核</li>
</ul>
</blockquote>
<img data-src="/2020/06/07/106/basic-install_pacstrap-1.5e46be8d.png" class="" title="pacstrap_step-1">

<p>如果提示 GPG 证书错误，可能是因为使用的不是最新的镜像文件，可以通过更新 <code>archlinux-keyring</code> 解决此问题</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S archlinux-keyring</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过如下命令使用 <code>pacstrap</code> 脚本安装其它必要的功能性软件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacstrap /mnt networkmanager vim sudo zsh zsh-completions</span><br></pre></td></tr></table></figure>

<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><code>zsh</code> —— <code>zsh-completions</code> 如果你是 bash 的爱好者，请把这两个包换成<code>bash-completion</code></li>
<li>如果你是第一次接触*nix 系统的新手，不建议换成 bash</li>
</ul>
</blockquote>
<img data-src="/2020/06/07/106/basic-install_pacstrap-2.4c230553.png" class="" title="pacstrap_step-2">

<p>经过一系列安装时提示信息的刷屏，这些包就安装好了。</p>
<blockquote>
<p>⚠️ 注意</p>
<p>在执行命令前，请仔细检查命令的拼写正确；同时注意不要漏装东西。</p>
<p>很多人在后续的步骤中报错就是因为这里漏装了东西。</p>
<p>如果报错，请<strong>检查拼写</strong>，同时请确保之前的步骤 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_6-%E6%9B%B4%E6%8D%A2%E5%9B%BD%E5%86%85%E8%BD%AF%E4%BB%B6%E4%BB%93%E5%BA%93%E9%95%9C%E5%83%8F%E6%BA%90%E5%8A%A0%E5%BF%AB%E4%B8%8B%E8%BD%BD%E9%80%9F%E5%BA%A6">更换国内软件仓库镜像源加快下载速度</a> 中<strong>没有</strong>添加 <code>archlinuxcn</code> 源。</p>
</blockquote>
</li>
</ol>
<h2 id="10-生成-fstab-文件"><a href="#10-生成-fstab-文件" class="headerlink" title="10. 生成 fstab 文件"></a>10. 生成 fstab 文件</h2><ol>
<li><p><code>fstab</code> 用来定义磁盘分区。它是 Linux 系统中重要的文件之一。使用 <code>genfstab</code> 自动根据当前挂载情况生成并写入 <code>fstab</code> 文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genfstab -U /mnt &gt; /mnt/etc/fstab</span><br></pre></td></tr></table></figure>
</li>
<li><p>复查一下 <code>/mnt/etc/fstab</code> 确保没有错误：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /mnt/etc/fstab</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_fstab.2facd1ee.png" class="" title="fstab">

<p>若为 NVME 协议的硬盘，输出结果应该与此类似：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># /dev/nvme0n1p6  /  btrfs  rw,relatime,compress=zstd:3,ssd,space_cache,subvolid=256,subvol=/@,subvol=@ 0 0</span><br><span class="line">UUID=d01a3ca5-0798-462e-9a30-97065e7e36e1 /  btrfs  rw,relatime,compress=zstd:3,ssd,space_cache,subvolid=256,subvol=/@,subvol=@  0 0</span><br><span class="line"></span><br><span class="line"># /dev/nvme0n1p1  /boot vfat  rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro      0 2</span><br><span class="line">UUID=522C-80C6  /boot vfat  rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=ascii,shortname=mixed,utf8,errors=remount-ro 0 2</span><br><span class="line"></span><br><span class="line"># /dev/nvme0n1p6  /home btrfs rw,relatime,compress=zstd:3,ssd,space_cache,subvolid=257,subvol=/@home,subvol=@home 0 0</span><br><span class="line">UUID=d01a3ca5-0798-462e-9a30-97065e7e36e1 /home btrfs rw,relatime,compress=zstd:3,ssd,space_cache,subvolid=257,subvol=/@home,subvol=@home 0 0</span><br><span class="line"></span><br><span class="line"># /dev/nvme0n1p5  none  swap  defaults  0 0</span><br><span class="line">UUID=8e40dbed-590f-4cb8-80de-5cef8343a9fc none  swap  defaults  0 0</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="11-change-root"><a href="#11-change-root" class="headerlink" title="11. change root"></a>11. change root</h2><p>使用以下命令把系统环境切换到新系统下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arch-chroot /mnt</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_chroot.673ef529.png" class="" title="arch-chroot">

<p>此时，原来安装盘下的 <code>/mnt</code> 目录就变成了新系统的 <code>/</code> 目录。同时，可以发现命令行的提示符颜色和样式也发生了改变。</p>
<h2 id="12-设置主机名与时区"><a href="#12-设置主机名与时区" class="headerlink" title="12. 设置主机名与时区"></a>12. 设置主机名与时区</h2><ol>
<li><p>首先在 <code>/etc/hostname</code> 设置主机名：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hostname</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_set-name-and-timezone-1.a309cba5.png" class="" title="set-name-and-timezone_step-1">

<p>加入你想为主机取的主机名，这里比如叫 myarch。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>主机名不要包含特殊字符以及空格。</p>
</blockquote>
</li>
<li><p>接下来在 <code>/etc/hosts</code> 设置与其匹配的条目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br></pre></td></tr></table></figure>

<p>加入如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost</span><br><span class="line">::1         localhost</span><br><span class="line">127.0.1.1   myarch.localdomain myarch</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_set-name-and-timezone-2.15374034.png" class="" title="set-name-and-timezone_step-2">

<blockquote>
<p>ℹ️ 提示<br>你可以使用 <code>Tab</code> 对齐。</p>
</blockquote>
<blockquote>
<p>ℹ️ 提示<br>某些情况下如不设置主机名，在 KDE 下可能会存在网络情况变更时无法启动 GUI 应用的问题，在终端中出现形如 <code>No protocol specified qt.qpa.xcb: could not connect to display</code> 的错误。这种情况极为少见。<br>但不管如何，即使没有问题，我们都应该设置好主机名。</p>
</blockquote>
</li>
<li><p>随后设置时区，在 <code>/etc/localtime</code> 下用 <code>/usr</code> 中合适的时区创建符号链接：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_set-name-and-timezone-3.fd00d670.png" class="" title="set-name-and-timezone_step-3">

<blockquote>
<p>🍧 碎碎念</p>
<p>不要找北京啦！这里没有北京，只有上海啦！🚀</p>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>同时，你也可以使用其它时区：</p>
<img data-src="/2020/06/07/106/basic-install_set-name-and-timezone-4.48ebabec.png" class="" title="set-name-and-timezone_step-4"></blockquote>
</li>
</ol>
<h2 id="13-硬件时间设置"><a href="#13-硬件时间设置" class="headerlink" title="13. 硬件时间设置"></a>13. 硬件时间设置</h2><p>使用如下命令将系统时间同步到硬件时间：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwclock --systohc</span><br></pre></td></tr></table></figure>

<h2 id="14-设置-Locale"><a href="#14-设置-Locale" class="headerlink" title="14. 设置 Locale"></a>14. 设置 Locale</h2><p><code>Locale</code> 决定了软件使用的语言、书写习惯和字符集。</p>
<ol>
<li><p>编辑 <code>/etc/locale.gen</code>，去掉 <code>en_US.UTF-8 UTF-8</code> 以及 <code>zh_CN.UTF-8 UTF-8</code> 行前的注释符号（<code>#</code>）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/locale.gen</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_locale-1.59ffa6db.png" class="" title="locale_step-1">

<img data-src="/2020/06/07/106/basic-install_locale-2.25d6b784.png" class="" title="locale_step-2">

<blockquote>
<p>ℹ️ 提示</p>
<p>有几个选项极具迷惑性，请不要取消注释错了。</p>
</blockquote>
</li>
<li><p>然后使用如下命令生成 <code>locale</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locale-gen</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_locale-3.ee2c4269.png" class="" title="locale_step-3">
</li>
<li><p>向 <code>/etc/locale.conf</code> 输入内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;LANG=en_US.UTF-8&#x27;  &gt; /etc/locale.conf</span><br></pre></td></tr></table></figure>

<blockquote>
<p>⚠️ 注意</p>
<p>不推荐在此设置任何中文 <code>locale</code>，会导致 <code>tty</code> 乱码。</p>
</blockquote>
</li>
</ol>
<h2 id="15-为-root-用户设置密码"><a href="#15-为-root-用户设置密码" class="headerlink" title="15. 为 root 用户设置密码"></a>15. 为 root 用户设置密码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd root</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_passwd.72a75688.png" class="" title="password">

<blockquote>
<p>ℹ️ 提示</p>
<p>根据提示操作即可。注意输入密码时不会显示哦，不要以为 ⌨ 键盘坏了。</p>
</blockquote>
<h2 id="16-安装微码"><a href="#16-安装微码" class="headerlink" title="16. 安装微码"></a>16. 安装微码</h2><p>通过以下命令安装对应芯片制造商的微码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pacman -S intel-ucode # Intel</span><br><span class="line">pacman -S amd-ucode # AMD</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ℹ️ 提示</p>
<p>🎉 恭喜你！这是你在新系统中第一次使用 <code>pacman</code> 软件包管理器安装软件！在这里一路回车完成安装即可。</p>
<p>如果你不会使用，请参阅 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/.html">这里</a>。</p>
</blockquote>
<h2 id="17-安装引导程序"><a href="#17-安装引导程序" class="headerlink" title="17. 安装引导程序"></a>17. 安装引导程序</h2><p>如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/GRUB_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchWiki 相关内容</a>。</p>
<ol>
<li><p>安装相应的包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S grub efibootmgr os-prober</span><br></pre></td></tr></table></figure>

<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><p><code>-S</code>选项后指定要通过</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman</span><br></pre></td></tr></table></figure>
<p> 包管理器安装的包：</p>
<ul>
<li><code>grub</code> —— 启动引导器</li>
<li><code>efibootmgr</code> —— <code>efibootmgr</code> 被 <code>grub</code> 脚本用来将启动项写入 NVRAM</li>
<li><code>os-prober</code> —— 为了能够引导 win10，需要安装 <code>os-prober</code> 以检测到它</li>
</ul>
</li>
</ul>
</blockquote>
</li>
<li><p>安装 GRUB 到 EFI 分区：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=ARCH</span><br></pre></td></tr></table></figure>

<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><code>--efi-directory=/boot</code> —— 将 <code>grubx64.efi</code> 安装到之前的指定位置（EFI 分区）</li>
<li><code>--bootloader-id=ARCH</code> —— 取名为 <code>ARCH</code></li>
</ul>
</blockquote>
<img data-src="/2020/06/07/106/basic-install_grub-1.53b319a1.png" class="" title="grub_step-1">
</li>
<li><p>接下来使用 <code>vim</code> 编辑 <code>/etc/default/grub</code> 文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/default/grub</span><br></pre></td></tr></table></figure>

<p>进行如下修改：</p>
<ul>
<li><p>去掉 <code>GRUB_CMDLINE_LINUX_DEFAULT</code> 一行中最后的 <code>quiet</code> 参数</p>
</li>
<li><p>把 <code>loglevel</code> 的数值从 <code>3</code> 改成 <code>5</code>。这样是为了后续如果出现系统错误，方便排错</p>
</li>
<li><p>加入 <code>nowatchdog</code> 参数，这可以显著提高开关机速度</p>
 <img data-src="/2020/06/07/106/basic-install_grub-2.e9c8c11f.png" class="" title="grub_step-2">
</li>
<li><p>为了引导 win10，则还需要添加新的一行 <code>GRUB_DISABLE_OS_PROBER=false</code></p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#GRUB boot loader configuration</span><br><span class="line"></span><br><span class="line">GRUB_DEFAULT=0</span><br><span class="line">GRUB_TIMEOUT=5</span><br><span class="line">GRUB_DISTRIBUTOR=&quot;Arch&quot;</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;loglevel=5 nowatchdog&quot;</span><br><span class="line">GRUB_CMDLINE_LINUX=&quot;&quot;</span><br><span class="line">GRUB_DISABLE_OS_PROBER=false</span><br><span class="line">...</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>最后生成 <code>GRUB</code> 所需的配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_grub-3.d220f785.png" class="" title="grub_step-3">

<p>若引导了 win10，则输出应该包含倒数第二行：</p>
<img data-src="/2020/06/07/106/os-prober-1.d6dd12a6.png" class="" title="os-prober-1">

<p>若 win10 安装在另一个硬盘中则不会输出 <strong>可在进入系统后挂载硬盘并重新执行该命令</strong>, 具体步骤<a href="#%E5%A4%9A%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F">见这里</a></p>
<blockquote>
<p>ℹ️ 提示</p>
<p>1.在某些主板安装完成后，你会发现没有启动条目。这是因为某些主板的 UEFI 固件在显示 UEFI NVRAM 引导条目之前，需要在特定的位置存放可引导文件，不支持自定义存放 <code>efi</code> 文件（如微星 Z170-A Gaming PRO）。解决方案是在默认启动路径下安装 <code>GRUB</code>。重新插入安装优盘，按原先顺序挂载目录（不需要再次创建文件夹了），<code>chroot</code> 到 <code>/mnt</code>，然后你可以直接把已经生成好的 <code>efi</code> 文件移动到默认目录下，如下命令所示。只有安装完成后你的主板不出现启动条目才需要尝试如下命令，正常安装无需执行。如有需要可以参考 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/GRUB#%E7%BC%BA%E7%9C%81/%E5%90%8E%E5%A4%87%E5%90%AF%E5%8A%A8%E8%B7%AF%E5%BE%84">ArchWiki 对应内容</a>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /boot/EFI/grub /boot/EFI/BOOT</span><br><span class="line"><span class="built_in">mv</span> /boot/EFI/GRUB/grubx64.efi /boot/EFI/BOOT/BOOTX64.EFI</span><br></pre></td></tr></table></figure>

<p>2.<code>os-prober</code> 在 chroot 环境中可能无法正常运作。如果遇到这种情况，重启并引导进入系统后再次尝试生成配置文件。</p>
</blockquote>
</li>
</ol>
<h2 id="18-完成安装"><a href="#18-完成安装" class="headerlink" title="18. 完成安装"></a>18. 完成安装</h2><ol>
<li><p>输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span> <span class="comment"># 退回安装环境</span></span><br><span class="line">umount -R /mnt <span class="comment"># 卸载新分区</span></span><br><span class="line">reboot <span class="comment"># 重启</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_finish.3543840a.png" class="" title="finish-install">

<blockquote>
<p>注意，<strong>重启前要先拔掉优盘</strong>，否则你重启后还是进安装程序而不是安装好的系统。</p>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>虚拟机直接重启即可。</p>
</blockquote>
<img data-src="/2020/06/07/106/basic-install_last-step-1.5ed5cd59.png" class="" title="last-step-1">

<p>如图即为 GRUB 引导界面。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>若引导了 win10 也会显示出来。</p>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>若 win10 分区使用了 🔐 Bitlocker 加密，则第一次从 GRUB 进入需要输入解锁密钥。</p>
<p>你应该在步骤 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/pre-install.html#_5-%E8%8E%B7%E5%8F%96-bitlocker-%E6%81%A2%E5%A4%8D%E5%AF%86%E9%92%A5">5. 获取 Bitlocker 恢复密钥</a> 中已经知晓了 Bitlocker 解锁密钥。</p>
<p>若无法从 <a target="_blank" rel="noopener" href="https://aka.ms/myrecoverykey">aka.ms 相关页面</a> 获取解锁密钥，请尝试在 BIOS 中将 Windows Boot Manager 移动到启动顺序首位再尝试进入 win10。</p>
</blockquote>
</li>
<li><p>重启后使用 root 账户登录系统：</p>
<img data-src="/2020/06/07/106/basic-install_last-step-2.c76786d2.png" class="" title="last-step-2">
</li>
<li><p>设置开机自启并立即启动 networkmanager 服务，即可连接网络：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> --now NetworkManager <span class="comment"># 设置开机自启并立即启动 NetworkManager 服务</span></span><br><span class="line">ping www.bilibili.com <span class="comment"># 测试网络连接</span></span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_last-step-3.59f72c70.png" class="" title="last-step-3">
</li>
<li><p>若为无线连接，则需要在启动 <code>networkmanager</code> 后使用 <code>nmcli</code> 连接网络：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmcli dev wifi list <span class="comment"># 显示附近的 Wi-Fi 网络</span></span><br><span class="line">nmcli dev wifi connect <span class="string">&quot;Wi-Fi名（SSID）&quot;</span> password <span class="string">&quot;网络密码&quot;</span> <span class="comment"># 连接指定的无线网络</span></span><br></pre></td></tr></table></figure>

<p>也可以使用 <code>nmtui</code> 来配置网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmtui</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>neofetch</code> 可以将系统信息和发行版 logo 一并打印出来。通过 <code>pacman</code> 安装 <code>neofetch</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S neofetch</span><br></pre></td></tr></table></figure>

<p>使用 <code>neofetch</code> 打印系统信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">neofetch</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/basic-install_neofetch.d338d5c5.png" class="" title="neofetch">

<blockquote>
<p>🍧 碎碎念</p>
<p>又到了 <code>neofetch</code> 的时间了吗？</p>
</blockquote>
</li>
</ol>
<h2 id="祝贺！"><a href="#祝贺！" class="headerlink" title="祝贺！"></a>祝贺！</h2><p>到此为止，一个基础的、无图形界面的 archlinux 已经安装完成了！这时你应该可以感到满满的满足感（即使你还没有见到图形化的界面）。好好享受一下成功安装 archlinux 的喜悦吧！</p>
<p>如果你对本节的部分步骤不理解，请仔细阅读下一节 <a href="#%E5%9F%BA%E7%A1%80%E5%AE%89%E8%A3%85%E8%AF%A6%E8%A7%A3">基础安装详解</a>。在此之后，我们来安装图形界面。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>你可以使用以下命令关机：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shutdown -h now</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">poweroff</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>archlinux 在 2021 年 4 月在安装镜像中内置了一个 <a target="_blank" rel="noopener" href="https://archlinux.org/packages/extra/any/archinstall/">安装脚本</a>，类似一个一键安装脚本，提供一些选项，即可快速安装（填问卷安系统）。和所有一键安装脚本类似，提供自动化，但不灵活的安装过程。缺陷包括但不限于：</p>
<ol>
<li>只提供有限的文件系统格式</li>
<li>只可限定在一个磁盘</li>
<li>不能指定软件仓库镜像源</li>
<li>只提供有限的桌面选择</li>
<li>自动分区不可手动干预</li>
<li>输入错误直接崩溃退出</li>
<li>仅支持 UEFI 等</li>
</ol>
<p>不建议使用这个安装脚本，除了以上各种原因，初学者也无法在这种安装过程中学到任何东西。如果你因为某些原因需要快速启动一个基础的 archlinux 环境，那么可以尝试此脚本。</p>
</blockquote>
<h1 id="显卡驱动"><a href="#显卡驱动" class="headerlink" title="显卡驱动"></a>显卡驱动</h1><p>近年来，archlinux 的显卡驱动安装已经变得非常容易。本小节区分集成显卡、独立显卡和双显卡（集显 + 独显）三大类讨论 archlinux 显卡驱动的安装</p>
<p>所有 AMD 显卡建议使用开源驱动，英伟达显卡建议使用闭源驱动。</p>
<blockquote>
<ol>
<li>进行本小节内容时建议按照步骤 <a href="desktop-env-and-app.md#_12-%E8%AE%BE%E7%BD%AE-timeshift-%E5%BF%AB%E7%85%A7">12. 设置 Timeshift 快照</a> 设置了 Timeshift 快照，并且已经有至少一张快照。</li>
<li>虚拟机不需要安装显卡驱动。</li>
<li>若在设置过程中导致黑屏无法进入桌面，请尝试使用使用 <code>Ctrl</code> + <code>Alt</code> + <code>F1 ~ F6</code> 在 <code>tty1 ~ tty6</code> 之间切换。将导致黑屏的配置删掉或使用快照恢复后重新启动电脑。</li>
</ol>
</blockquote>
<p>请确保已经按照本指南之前的章节安装配置好系统再向下进行，<strong>不要多个教程混着看（尤其是一些过时的教程）</strong>。因为可能导致漏掉本指南前置步骤中的某些操作，从而造成问题。</p>
<h2 id="集成显卡"><a href="#集成显卡" class="headerlink" title="集成显卡"></a>集成显卡</h2><h3 id="Intel-核芯显卡"><a href="#Intel-核芯显卡" class="headerlink" title="Intel 核芯显卡"></a>Intel 核芯显卡</h3><p>如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Intel_graphics">ArchWiki 相关内容</a>。</p>
<p>通过以下命令安装如下几个包即可：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不建议安装 <code>xf86-video-intel</code>，而应使用 Xorg 的 modesetting 驱动（也就是什么都不用装的意思）<br>注意，只有 Intel HD 4000 及以上的集显才支持 vulkan。</p>
</blockquote>
<h3 id="AMD-集成显卡"><a href="#AMD-集成显卡" class="headerlink" title="AMD 集成显卡"></a>AMD 集成显卡</h3><p>如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/ATI">ArchWiki 相关内容</a>。</p>
<h4 id="选择驱动"><a href="#选择驱动" class="headerlink" title="选择驱动"></a>选择驱动</h4><p>对于具有集成显卡的 AMD 处理器，需要先确定集显架构（Architecture）是什么，再决定安装什么驱动。</p>
<p>推荐在 <a target="_blank" rel="noopener" href="https://www.techpowerup.com/">TECHPOWERUP</a> 进行查询，信息非常全面。在确定了显卡架构后，再根据架构对照下表决定安装什么驱动。</p>
<table>
<thead>
<tr>
<th align="center">GPU 架构</th>
<th align="center">Radeon 显卡</th>
<th align="center">开源驱动</th>
<th align="center">非开源驱动</th>
</tr>
</thead>
<tbody><tr>
<td align="center">GCN 4 及之后</td>
<td align="center">多种*</td>
<td align="center">AMDGPU*</td>
<td align="center">AMDGPU PRO*</td>
</tr>
<tr>
<td align="center">GCN 3</td>
<td align="center">多种</td>
<td align="center">AMDGPU</td>
<td align="center">AMDGPU PRO</td>
</tr>
<tr>
<td align="center">GCN 2</td>
<td align="center">多种</td>
<td align="center">AMDGPU&#x2F; ATI*</td>
<td align="center">不支持</td>
</tr>
<tr>
<td align="center">GCN 1</td>
<td align="center">多种</td>
<td align="center">AMDGPU &#x2F; ATI</td>
<td align="center">不支持</td>
</tr>
<tr>
<td align="center">TeraScale 2&amp;3</td>
<td align="center">HD 5000 - HD 6000</td>
<td align="center">ATI</td>
<td align="center">不支持</td>
</tr>
<tr>
<td align="center">TeraScale 1</td>
<td align="center">HD 2000 - HD 4000</td>
<td align="center">ATI</td>
<td align="center">不支持</td>
</tr>
<tr>
<td align="center">旧型号</td>
<td align="center">X1000 及之前</td>
<td align="center">ATI</td>
<td align="center">不支持</td>
</tr>
</tbody></table>
<p>*<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_AMD_graphics_processing_units">多种</a></p>
<p>*<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/AMDGPU_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">AMDGPU</a></p>
<p>*<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/AMDGPU_PRO">AMDGPU PRO</a></p>
<p>*<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/ATI_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ATI</a></p>
<blockquote>
<p>对于 <code>GCN 2.0</code> 及以下架构的老显卡，<strong>直接安装开源 ATI 驱动即可</strong>，原本老旧的闭源 Catalyst 驱动在 2021 年已被废弃。<br><code>GCN 2.0</code> 及以下架构的老显卡也<strong>不要使用开源 AMPGPU 驱动</strong>，因为其仅处于实验性质，需要各种自定义内核编译选项与配置，非常麻烦、得不偿失。<br>对于新型号（<code>GCN 3</code> 架构及更新）的集成显卡，<strong>直接安装开源驱动 AMDGPU 即可</strong>。</p>
</blockquote>
<p>下面是一些例子：</p>
<ul>
<li><p>你的笔记本 cpu 是目前常见的 AMD Ryzen™ 7 4800U，它的集显为 Vega 8。通过查询，可知其为 <code>GCN 5.0</code> 架构，那么对照上表，你应该安装 AMDGPU 开源驱动。</p>
</li>
<li><p>你的台式机 cpu 是目前常见的 AMD Ryzen™ 5 3400G，它的集显为 Vega 11。通过查询，可知其为 <code>GCN 5.0</code> 架构，那么对照上表，你应该安装 AMDGPU 开源驱动。</p>
</li>
<li><p>再老一些的 7th Gen A10-9700 APU 处理器 ，它的集显为 Radeon R7。通过查询，可知其为 <code>GCN 2.0</code> 架构，那么对照上表，你应该安装 ATI 开源驱动。</p>
</li>
</ul>
<h4 id="安装驱动"><a href="#安装驱动" class="headerlink" title="安装驱动"></a>安装驱动</h4><p>通过以下命令安装如下几个包即可：</p>
<figure class="highlight bash"><figcaption><span>[开源驱动 AMDGPU]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mesa lib32-mesa xf86-video-amdgpu vulkan-radeon lib32-vulkan-radeon</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><figcaption><span>[开源 ATI 驱动]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mesa lib32-mesa xf86-video-ati</span><br></pre></td></tr></table></figure>

<h2 id="独立显卡"><a href="#独立显卡" class="headerlink" title="独立显卡"></a>独立显卡</h2><h3 id="NVIDIA-独立显卡"><a href="#NVIDIA-独立显卡" class="headerlink" title="NVIDIA 独立显卡"></a>NVIDIA 独立显卡</h3><blockquote>
<p>部分 NVIDIA 独立显卡目前在 archlinux 下体验非常不好，存在以下问题：</p>
<ol>
<li>部分桌面特效（如窗口惯性晃动）很卡</li>
<li>游戏无法正常运行</li>
<li>画面撕裂</li>
</ol>
<p>若遇到了上述问题，建议在 archlinux 中还是单独使用集成显卡（如果有）吧（还可以节省电量）。如果要 🎮 打游戏不妨重启到 win10。</p>
</blockquote>
<p>如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/NVIDIA_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchWiki 相关内容</a>。</p>
<ul>
<li><p>对于 <a target="_blank" rel="noopener" href="https://nouveau.freedesktop.org/CodeNames.html#NV160">Turing (NV160&#x2F;TUXXX)</a> 系列或更新的显卡，需要安装 nvidia-open 驱动</p>
<blockquote>
<p>该驱动的质量目前处于 ‘alpha quality’ 状态，所以也许会有问题。并且它暂时不适用于具有 AMD 集成 GPU 的系统。</p>
</blockquote>
 <figure class="highlight bash"><figcaption><span>[linux]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S nvidia-open nvidia-settings lib32-nvidia-utils <span class="comment"># 必须安装</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><figcaption><span>[others]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S nvidia-open-dkms nvidia-settings lib32-nvidia-utils <span class="comment"># 必须安装</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>其他较新型号的独立显卡使用以下命令直接安装如下几个包即可：</p>
 <figure class="highlight bash"><figcaption><span>[linux]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S nvidia nvidia-settings lib32-nvidia-utils <span class="comment"># 必须安装</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><figcaption><span>[others]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S nvidia-dkms nvidia-settings lib32-nvidia-utils <span class="comment"># 必须安装</span></span><br></pre></td></tr></table></figure></li>
<li><p>如果是 GeForce 630 以下到 GeForce 400 系列的老卡，使用以下命令安装 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/nvidia-390xx-dkms/">nvidia-390xx-dkms</a><sup>aur</sup> 及其 32 位支持包：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S nvidia-390xx-dkms nvidia-settings lib32-nvidia-390xx-utils</span><br></pre></td></tr></table></figure>
</li>
<li><p>再老的显卡直接使用以下命令安装 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Nouveau_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">开源驱动</a> 即可：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mesa lib32-mesa xf86-video-nouveau</span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>安装 NVIDIA 官方的驱动之后，需要编辑 <code>/etc/mkinitcpio.conf</code>，在 <code>HOOKS</code> 一行删除 <code>kms</code> 并保存，然后执行 <code>mkinitcpio -P</code> 重新生成一次镜像。这能防止 initramfs 包含 nouveau 模块，避免 nouveau 和官方驱动的冲突。</p>
</blockquote>
<h3 id="AMD-独立显卡"><a href="#AMD-独立显卡" class="headerlink" title="AMD 独立显卡"></a>AMD 独立显卡</h3><p>AMD 独立显卡的驱动安装步骤实际上<strong>和 AMD 集成显卡是相同的</strong>，都需要先确定架构，然后选定正确的驱动安装即可。参考步骤 <a href="graphic-driver.md#amd-%E9%9B%86%E6%88%90%E6%98%BE%E5%8D%A1">AMD 集成显卡</a>。</p>
<h2 id="双显卡（集显-独显）"><a href="#双显卡（集显-独显）" class="headerlink" title="双显卡（集显 + 独显）"></a>双显卡（集显 + 独显）</h2><p>如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/PRIME_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchWiki 相关内容</a>。</p>
<h3 id="NVIDIA-独立显卡-1"><a href="#NVIDIA-独立显卡-1" class="headerlink" title="NVIDIA 独立显卡"></a>NVIDIA 独立显卡</h3><blockquote>
<p>optimus-manager 已经支持 AMD 集成显卡 + NVIDIA 独立显卡组合。</p>
</blockquote>
<p>如有需要可以参考 <a target="_blank" rel="noopener" href="https://github.com/Askannz/optimus-manager/wiki">optimus-manager 官方文档</a>。</p>
<p>同时拥有集成显卡与独立显卡的笔记本电脑，同样需要<strong>按照上述步骤先安装各个对应的软件包</strong>。除此之外还需要安装 optimus-manager<sup>cn &#x2F; aur</sup> 以及其图形前端 optimus-manager-qt<sup>aur</sup>。通过该程序可以在集成显卡和独立显卡间轻松切换。optimus-manager 提供三种模式 —— 分别为仅用独显、仅用集显以及 hybrid 动态切换模式。</p>
<ol>
<li><p>使用以下命令安装相关软件包：</p>
<figure class="highlight bash"><figcaption><span>[cn]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S optimus-manager optimus-manager-qt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><figcaption><span>[aur]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S aur/optimus-manager optimus-manager-qt</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装完成后重启即可使用。optimus-manager 安装完成后会默认设置 <code>optimus-manager.service</code> 服务自动启动，但建议还是通过以下命令手动设置一下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> optimus-manager.service</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启后在在菜单栏打开 optimus-manager 即可使用。可在其设置中设置开机自动启动：</p>
</li>
</ol>
<p>此时你应该已经可以进行显卡切换了。</p>
<blockquote>
<p>如果有问题，请详细阅读 optimus-manager 的文档，里面有详细的描述。由于各类问题太多，本文不再赘述。此处仅列出几项较为重要的注意事项:</p>
<ul>
<li>如果需要在独显和集显模式间切换，要注意你没安装各类 GPU 监控插件，它们会阻止显卡切换，导致不可预料的错误</li>
<li>不要使用 Nvidia Control Panel 中的 <code>Save to X Configuration file</code> ，会导致配置冲突</li>
<li>在显卡之间的切换时，重新登陆后如在 splash screen 卡住或者黑屏，可以尝试按照上述提示在 <code>tty1 ~ tty6</code> 之间进行切换</li>
</ul>
</blockquote>
<h4 id="动态切换"><a href="#动态切换" class="headerlink" title="动态切换"></a>动态切换</h4><blockquote>
<p>hybrid 动态切换模式并不是自动的（类似 win10），需要手动添加环境变量。</p>
</blockquote>
<p>hybrid 动态切换模式本质上是使用<strong>针对使用闭源驱动</strong>的双显卡 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/PRIME#PRIME_render_offload">PRIME</a> 方法进行切换 —— 这需要设置三个环境变量。有两种方法：</p>
<ol>
<li><p>通过命令手动添加前缀，也可直接添加环境变量在全局环境下（不推荐）。如果加在了全局环境中，在从 hybrid 动态切换模式切换到其他模式之前一定要去掉这三个环境变量，否则会黑屏</p>
</li>
<li><p>用 nvidia-prime 包提供的命令 <code>prime-run</code></p>
</li>
</ol>
<h5 id="prime-run-方法"><a href="#prime-run-方法" class="headerlink" title="prime-run 方法"></a>prime-run 方法</h5><blockquote>
<p><code>prime-run</code> 部分应用可以不需要安装 optimus-manager，直接运行。</p>
<p>但不推荐这样，因为除了部分应用会报错之外也无法使用仅独立显卡模式。</p>
</blockquote>
<ol>
<li><p>通过以下命令安装 nvidia-prime 包：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S nvidia-prime</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过以下命令（请将 <code>%command%</code> 替换为要运行的命令）以使用 NVIDIA 独立显卡运行程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prime-run %<span class="built_in">command</span>%</span><br></pre></td></tr></table></figure></li>
</ol>
<p>运行 steam 游戏的例子：</p>
   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prime-run steam steam://rungameid/570 <span class="comment"># 运行 Dota 2</span></span><br><span class="line">prime-run steam steam://rungameid/730 <span class="comment"># 运行 CS:GO</span></span><br></pre></td></tr></table></figure>

<p>steam 游戏的启动参数 <code>steam://rungameid/xxx</code> 可通过以下方式查找：</p>
<ol>
<li><p>右键需要运行的游戏图标 &gt; 点击 <code>编辑应用程序...</code>：</p>

</li>
<li><p>在 <code>应用程序</code> 选项卡 &gt; <code>命令</code> 处查看：</p>
</li>
</ol>
<h5 id="环境变量方法"><a href="#环境变量方法" class="headerlink" title="环境变量方法"></a>环境变量方法</h5><h6 id="手动输入"><a href="#手动输入" class="headerlink" title="手动输入"></a>手动输入</h6><p>通过以下命令（请将 <code>%command%</code> 替换为要运行的命令）以使用 NVIDIA 独立显卡运行程序：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=<span class="string">&quot;nvidia&quot;</span> __VK_LAYER_NV_optimus=<span class="string">&quot;NVIDIA_only&quot;</span> %<span class="built_in">command</span>%</span><br></pre></td></tr></table></figure>

<p>运行 steam 游戏的例子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=<span class="string">&quot;nvidia&quot;</span> __VK_LAYER_NV_optimus=<span class="string">&quot;NVIDIA_only&quot;</span>  steam steam://rungameid/570 <span class="comment"># 运行 Dota 2</span></span><br><span class="line">__NV_PRIME_RENDER_OFFLOAD=1 __GLX_VENDOR_LIBRARY_NAME=<span class="string">&quot;nvidia&quot;</span> __VK_LAYER_NV_optimus=<span class="string">&quot;NVIDIA_only&quot;</span>  steam steam://rungameid/730 <span class="comment"># 运行 CS:GO</span></span><br></pre></td></tr></table></figure>

<h6 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h6><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Askannz/optimus-manager/wiki/Nvidia-GPU-offloading-for-%22hybrid%22-mode#setup">optimus-manager 官方文档</a> 中不推荐将此环境变量添加到全局环境。</p>
<p><em>It is not recommended to set those variables system-wide (like in <code>/etc/environment</code>), since it would defeat the point of hybrid mode, and can also break desktop compositing on some environment (resulting in a black screen).</em><br>也就是说会遇到这些问题：</p>
<ol>
<li>Kwin &#x2F; 显示特效混合器（混成器）奔溃（毛玻璃效果消失，原本是透明或毛玻璃效果的背景变黑）</li>
<li>黑屏</li>
</ol>
</blockquote>
<ol>
<li><p>使用 <code>vim</code> 编辑 <code>/etc/environment</code> 文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/environment</span><br></pre></td></tr></table></figure>

<p>加入以下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__NV_PRIME_RENDER_OFFLOAD=1</span><br><span class="line">__GLX_VENDOR_LIBRARY_NAME=<span class="string">&quot;nvidia&quot;</span></span><br><span class="line">__VK_LAYER_NV_optimus=<span class="string">&quot;NVIDIA_only&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>保存并退出 <code>vim</code></p>
</li>
</ol>
<h4 id="电源管理"><a href="#电源管理" class="headerlink" title="电源管理"></a>电源管理</h4><blockquote>
<p>如果不是强烈追求能效控制以及注重电池寿命的用户，那么可以略过此段。配置电源管理需要针对你的硬件以及笔记本型号尝试正确的电源管理方式。</p>
</blockquote>
<blockquote>
<p>此部分的设置可能导致黑屏，并且尝试过程可能较长，也可能会遇到各类问题。请根据自身需求和能力选择是否操作。</p>
</blockquote>
<p>电源管理做的事情是，<strong>在只用集显的模式下，确保正确关闭独立显卡</strong>；而在混合模式下，绝大多数情况下 NVIDIA 模块实际是始终开启的，<strong>电源管理并不生效</strong>。</p>
<p>这件事情其实很复杂，因为对于不同的显卡型号，以及笔记本型号的组合，可行的方案都是不同的。笼统来说，最广泛适用的办法是 Bbswitch。但<strong>不建议上来就按照此方式安装使用</strong>，因为某些特定的硬件就是会出问题（黑屏）。</p>
<p>建议按照 <a target="_blank" rel="noopener" href="https://github.com/Askannz/optimus-manager/wiki/A-guide--to-power-management-options">optimus-manager 官方文档</a> 一步步尝试，最后找到属于你自己电脑合适的电源管理方式。<strong>此文档必须详细阅读！</strong></p>
<p>针对大多数笔记本适用的 Bbswitch，此处进行安装使用的讲解。</p>
<ol>
<li><p>通过以下命令安装包 <code>bbswitch</code>；若使用其它内核，则安装包 <code>bbswitch-dkms</code>：</p>
<figure class="highlight bash"><figcaption><span>[linux]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S bbswitch</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><figcaption><span>[others]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S bbswitch-dkms</span><br></pre></td></tr></table></figure>
</li>
<li><p>右键 optimus-manager 的托盘图标 &gt; 点击 <code>设置</code> &gt; 在 Optimus 选项卡中的 <code>switch method</code> 中选择 <code>Bbswitch</code> 即可：</p>

</li>
<li><p>重启之后，若使用仅集显模式使用如下命令验证 NVIDIA 独立显卡是否被禁用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci | grep NVIDIA</span><br></pre></td></tr></table></figure>



<p>若有 <code>rev ff</code> 字样，则表示独显已经成功禁用。</p>
</li>
</ol>
<h3 id="AMD-独立显卡-1"><a href="#AMD-独立显卡-1" class="headerlink" title="AMD 独立显卡"></a>AMD 独立显卡</h3><p>虽然 AMD 独立显卡无法使用 optimus-manager，但可以使用<strong>针对使用开源驱动</strong>的双显卡 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/PRIME#For_open_source_drivers_-_PRIME">PRIME</a> 方法进行切换。也就是使用 <code>DRI_PRIME=1</code> 前缀使用独立显卡（可能还更简单了？🤔）。</p>
<ul>
<li><p>通过以下命令（请将 <code>%command%</code> 替换为要运行的命令）以使用 AMD 独立显卡运行程序：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DRI_PRIME=1 %<span class="built_in">command</span>%</span><br></pre></td></tr></table></figure>

<p> 运行 steam 游戏的例子：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DRI_PRIME=1 steam steam://rungameid/570 <span class="comment"># 运行 Dota 2</span></span><br><span class="line">DRI_PRIME=1 steam steam://rungameid/730 <span class="comment"># 运行 CS:GO</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以使用以下命令分别对集成显卡和独立显卡进行性能测试，选择分数更高的一个使用：</p>
 <figure class="highlight bash"><figcaption><span>[集成显卡]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glmark2</span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><figcaption><span>[独立显卡]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DRI_PRIME=1 glmark2</span><br></pre></td></tr></table></figure>

<p> 关于 glmark2 的说明请参阅 <a href="graphic-driver.md#glmark2">glmark2</a>。</p>
</li>
<li><p>可以在 steam 游戏的启动前缀中加入 <code>DRI_PRIME=1 mangohud %command%</code> 来使用独显的同时显示帧数等信息。关于 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/mangohud">mangohud</a><sup>aur</sup> 的使用请参阅 <a href="">这里</a>。</p>
</li>
</ul>
<h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><p>如有需要可以参考 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Benchmarking_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchWiki 相关内容</a>。</p>
<h3 id="glxgears"><a href="#glxgears" class="headerlink" title="glxgears"></a>glxgears</h3><p>最传统和广为人知的方式是使用 <code>glxgears</code> 命令进行测试，其属于 <a target="_blank" rel="noopener" href="https://www.archlinux.org/packages/extra/x86_64/mesa-utils/">mesa-utils</a> 包。</p>
<ol>
<li><p>通过以下命令安装 <a target="_blank" rel="noopener" href="https://www.archlinux.org/packages/extra/x86_64/mesa-utils/">mesa-utils</a> 包（可能已经安装了）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mesa-utils</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过以下命令进行测试：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glxgears</span><br></pre></td></tr></table></figure>

<p>随后会弹出一个小窗口运行测试程序：</p>


<p>帧数会打印在终端中：</p>

</li>
<li><p>使用 <code>Ctrl</code> + <code>C</code> 退出测试</p>
<p><code>glxgears</code> 仅仅只能提供简单的测试场景及帧数显示，只测试了当前 OpenGL 功能的一小部分，功能明显不足。笔者推荐如下两种工具。</p>
</li>
</ol>
<h3 id="glmark2"><a href="#glmark2" class="headerlink" title="glmark2"></a>glmark2</h3><p>glmark2 提供了一系列丰富的测试，涉及图形单元性能（缓冲、建筑、照明、纹理等）的不同方面，允许进行更全面和有意义的测试。每次测试单独计算帧速率。最终，程序根据之前的所有测试给出一个最终分数。在 archlinux 上属于包 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/glmark2/">glmark2</a><sup>cn &#x2F; aur</sup>。</p>
<ol>
<li><p>使用以下命令安装 glmark2：</p>
<figure class="highlight bash"><figcaption><span>[cn]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S glmark2</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><figcaption><span>[aur]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S aur/glmark2</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用以下命令启动 glmark2：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">glmark2</span><br></pre></td></tr></table></figure>

<p>随后会弹出一个小窗口运行测试程序：</p>


<p>以笔者的硬件为例（集成显卡），测试结果如下：</p>
</li>
</ol>
<h3 id="Unigine-benchmark"><a href="#Unigine-benchmark" class="headerlink" title="Unigine benchmark"></a>Unigine benchmark</h3><p>Unigine 3D 引擎是一个更全面的基准测试工具。截止目前有五个版本，从新到旧分别是：</p>
<ul>
<li>superposition<sup>EULA</sup>（2017）</li>
<li>valley<sup>EULA</sup>（2013）</li>
<li>heaven<sup>EULA</sup>（2009）</li>
<li>tropics<sup>EULA</sup>（2008）</li>
<li>sanctuary<sup>EULA</sup>（2007）</li>
</ul>
<ol>
<li><p>可以使用以下命令从 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/?O=0&K=unigine">AUR</a> 下载全部版本（选一个即可）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yay -S unigine-superposition</span><br><span class="line">yay -S unigine-valley</span><br><span class="line">yay -S unigine-heaven</span><br><span class="line">yay -S unigine-tropics</span><br><span class="line">yay -S unigine-sanctuary</span><br></pre></td></tr></table></figure>


</li>
<li><p>使用以下命令启动 Unigine benchmark（输入对应安装的版本）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">unigine-superposition</span><br><span class="line">unigine-valley</span><br><span class="line">unigine-heaven</span><br><span class="line">unigine-tropics</span><br><span class="line">unigine-sanctuary</span><br></pre></td></tr></table></figure>


</li>
<li><p>调整参数后，点击 <code>RUN</code> 即可进入测试，帧数会显示在右上角</p>
</li>
<li><p>点击左上角 <code>基准</code> 开始基准测试</p>
</li>
<li><p>点击左上角 <code>退出</code> 并 <code>确定</code> 即可退出测试</p>
</li>
</ol>
<p>此基准测试工具拥有实时的环境遮挡、来自不同来源的相互关联的灯光、HDR 效果图、逼真的水和具有大气光散射的动态天空。此外还可以设置抗锯齿级别、纹理质量和滤波、各向异性和着色器质量。</p>
<h2 id="显卡信息查看"><a href="#显卡信息查看" class="headerlink" title="显卡信息查看"></a>显卡信息查看</h2><h3 id="NVIDIA-独立显卡-2"><a href="#NVIDIA-独立显卡-2" class="headerlink" title="NVIDIA 独立显卡"></a>NVIDIA 独立显卡</h3><p><code>nvidia-settings</code> 这个包即可全面的展示显卡相关信息（在步骤 <a href="graphic-driver.md#%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1">NVIDIA 独立显卡</a> 中已经安装）。</p>
<h3 id="AMD-独立显卡-集成显卡"><a href="#AMD-独立显卡-集成显卡" class="headerlink" title="AMD 独立显卡 &#x2F; 集成显卡"></a>AMD 独立显卡 &#x2F; 集成显卡</h3><ol>
<li><p>通过以下命令安装 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/?O=0&SeB=nd&K=radeon-profile-git&outdated=&SB=n&SO=a&PP=50&do_Search=Go">radeon-profile-git</a><sup>aur</sup> 包以及其依赖 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/?O=0&SeB=nd&K=radeon-profile-daemon-git&outdated=&SB=n&SO=a&PP=50&do_Search=Go">radeon-profile-daemon-git</a><sup>aur</sup>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S radeon-profile-git radeon-profile-daemon-git</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用以下命令启动这个进程，即可以图形化的方式查看 AMD 显卡信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> --now radeon-profile-daemon.service</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>不要对左下角的 <code>auto low high</code> 进行更改，有 bug 会导致卡死。</p>
<p>同时，显存占用在某些型号显卡上展示可能有误。</p>
</blockquote>
<h1 id="基础安装详解"><a href="#基础安装详解" class="headerlink" title="基础安装详解"></a>基础安装详解</h1><blockquote>
<p> 🔭 知其然，知其所以然</p>
<p>这一节对 [archlinux 基础安装](#archlinux 基础安装) 中关键的几步做出了更进一步的解释，知其然知其所以然。此节没有特定顺序，可根据需要选择性阅读</p>
<p>需要说明的是，本指南假定你有一定的 Linux 基础知识，基础知识相关的话题<strong>不会</strong>被讨论</p>
</blockquote>
<h2 id="分区和格式化"><a href="#分区和格式化" class="headerlink" title="分区和格式化"></a>分区和格式化</h2><blockquote>
<ol>
<li>因本指南介绍使用的文件系统是 <code>Btrfs</code>，很多萌新可能有些不理解。这里有必要说明一下</li>
<li>若<strong>执意要用传统的 <code>ext4</code> 文件系统</strong>，本指南也给出了示例</li>
<li>对于全盘格式化后<strong>全新安装</strong>的（单 archlinux 系统）同学，这里也给出了需要做的额外步骤的说明</li>
<li>对于 <strong>Swap 分区还是 Swap 文件</strong> 的话题，也会在此讨论</li>
</ol>
</blockquote>
<h3 id="为什么要用-Btrfs-文件系统"><a href="#为什么要用-Btrfs-文件系统" class="headerlink" title="为什么要用 Btrfs 文件系统"></a>为什么要用 Btrfs 文件系统</h3><img data-src="/2020/06/07/106/btrfs-logo.1e008039.svg" class="" title="Btrfs">

<p>纵观 Btrfs 的历史，可以说 Btrfs 未来的发展是道阻且长的。也让我们感受到开源社区也并不是一根绳上的蚂蚱 —— 开源社区之间也有着各种各样的分歧。</p>
<p>但不管怎么说，Btrfs 的未来现在来看是光明的；我们也可以在 archlinux 上享受到 Btrfs 文件系统的特性带来的好处：</p>
<ol>
<li><p>快照 —— archlinux 作为滚动发行版，若滚挂了可以使用 Btrfs 的快照特性快速回滚</p>
<p>若使用传统的 <code>ext4</code> 文件系统，我们可以使用 <code>timeshift</code> 的 <code>RSYNC</code> 模式进行增量备份。但是，一般来说 RSYNC 方式的快照大小略大于当前实际使用大小，也就是说实际上开启了 <code>timeshift</code> 的 <code>RSYNC</code> 模式快照相当于磁盘可用空间直接少了一半多。因为虽然 RSYNC 方式的快照是增量的，但历史最久远的快照依然是完整备份，随后才是增量的</p>
</li>
<li><p>透明压缩 —— 可以大大减少磁盘的使用空间（压缩率大概在 10% 左右）</p>
</li>
</ol>
<blockquote>
<p>ℹ️ 提示</p>
<p>更多 Btrfs 文件系统介绍和操作请参阅 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/advanced/btrfs.html">Btrfs 介绍与相关操作</a>。</p>
</blockquote>
<h3 id="传统-ext4-文件系统说明"><a href="#传统-ext4-文件系统说明" class="headerlink" title="传统 ext4 文件系统说明"></a>传统 ext4 文件系统说明</h3><p>若执意使用传统的 <code>ext4</code> 文件系统，那么分区的建议为：</p>
<ol>
<li>若 archlinux 安装分区小于 <code>256GB</code>：<ul>
<li><code>/</code> 根目录：<code>全部空间</code>（用户主目录不单独分区）</li>
<li><code>/boot</code> EFI 分区：<code>256MB</code></li>
<li>Swap 分区：<code>&gt;= 电脑实际运行内存的 60%</code></li>
</ul>
</li>
<li>若 archlinux 安装分区大于 <code>256GB</code>：<ul>
<li><code>/</code> 根目录：<code>128GB</code></li>
<li><code>/home</code> 用户主目录：<code>剩余的全部空间</code></li>
<li><code>/boot</code> EFI 分区：<code>256MB</code></li>
<li>Swap 分区：<code>&gt;= 电脑实际运行内存的 60%</code></li>
</ul>
</li>
</ol>
<p>分区同样使用 <code>cfdisk</code> 工具，具体操作类似上一节 [7-1. 分区](#7-1. 分区) 所述，这里不再赘述。</p>
<ul>
<li><p>使用以下命令格式化 <code>ext4</code> 分区：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 /dev/sdax</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.ext4 /dev/nvmexn1pn</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>使用以下命令挂载 <code>ext4</code> 分区：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/sdxn /mnt</span><br><span class="line"><span class="built_in">mkdir</span> /mnt/home <span class="comment"># 若 /home 目录单独分区</span></span><br><span class="line">mount /dev/sdxn /mnt/home <span class="comment"># 若 /home 目录单独分区</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/boot</span><br><span class="line">mount /dev/sdxn /mnt/boot</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/nvmexn1pn /mnt</span><br><span class="line"><span class="built_in">mkdir</span> /mnt/home <span class="comment"># 若 /home 目录单独分区</span></span><br><span class="line">mount /dev/nvmexn1pn /mnt/home <span class="comment"># 若 /home 目录单独分区</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/boot</span><br><span class="line">mount /dev/nvmexn1pn /mnt/boot</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="全新安装"><a href="#全新安装" class="headerlink" title="全新安装"></a>全新安装</h3><p>若为全新安装（单 archlinux 系统），首先要对磁盘建立新的 GPT 分区表；同时，由于没有现存的 EFI 分区，所以我们还需要手动创建它（这一步在 [7. 分区和格式化（使用 Btrfs 文件系统）](#7. 分区和格式化（使用 Btrfs 文件系统）) 步骤之前）：</p>
<h4 id="1-建立新的-GPT-分区表"><a href="#1-建立新的-GPT-分区表" class="headerlink" title="1. 建立新的 GPT 分区表"></a>1. 建立新的 GPT 分区表</h4><ol>
<li><p>同样的，先通过 <code>lsblk</code> 命令，区分要全新安装 archlinux 的磁盘（通过观察磁盘的大小等判断）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk <span class="comment"># 显示当前分区情况</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过以下命令将磁盘转换为 <code>gpt</code> 类型：</p>
<ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parted /dev/sdx <span class="comment"># 执行 parted，进行磁盘类型变更</span></span><br><span class="line">(parted) mktable <span class="comment"># 输入 mktable</span></span><br><span class="line">New disk label <span class="built_in">type</span>? gpt <span class="comment"># 输入 gpt，将磁盘类型转换为 GPT 类型。如磁盘有数据会警告，输入 Yes 即可</span></span><br><span class="line">(parted) quit <span class="comment"># 退出 parted 命令行交互</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parted /dev/nvmexn1 <span class="comment"># 执行 parted，进行磁盘类型变更</span></span><br><span class="line">(parted) mktable <span class="comment"># 输入 mktable</span></span><br><span class="line">New disk label <span class="built_in">type</span>? gpt <span class="comment"># 输入 gpt，将磁盘类型转换为 GPT 类型。如磁盘有数据会警告，输入 Yes 即可</span></span><br><span class="line">(parted) quit <span class="comment"># 退出 parted 命令行交互</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<blockquote>
<p>☢️ 警告</p>
<p>重建分区表会使磁盘所有数据丢失，请事先确认。</p>
</blockquote>
<h4 id="2-建立-EFI-分区"><a href="#2-建立-EFI-分区" class="headerlink" title="2. 建立 EFI 分区"></a>2. 建立 EFI 分区</h4><p>进入 <code>cfdisk</code> 分区工具之后，类似上一节步骤 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_7-1-%E5%88%86%E5%8C%BA">7-1. 分区</a> 的分区说明，建立 EFI 分区：</p>
<ol>
<li>选中 <code>Free space</code> &gt; 再选中操作 <code>[New]</code> &gt; 然后按下回车 <code>Enter</code> 以新建 <code>EFI</code> 分区</li>
<li>输入 <code>分区大小</code>（建议 &gt;&#x3D; <code>256MB</code>、&lt;&#x3D; <code>1024MB</code>；推荐 <code>512MB</code>）&gt; 然后按下回车 <code>Enter</code></li>
<li>选中操作 <code>[Type]</code> &gt; 然后按下回车 <code>Enter</code> &gt; 通过方向键 <code>↑</code> 和 <code>↓</code> 选中 <code>EFI System</code> &gt; 最后按下回车 <code>Enter</code></li>
<li>接下来可以按照上一节 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_7-1-%E5%88%86%E5%8C%BA">7-1. 分区</a> 的步骤创建其它分区</li>
</ol>
<h4 id="3-格式化-EFI-分区"><a href="#3-格式化-EFI-分区" class="headerlink" title="3. 格式化 EFI 分区"></a>3. 格式化 EFI 分区</h4><ul>
<li><p>SATA</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.vfat /dev/sdxn</span><br></pre></td></tr></table></figure>
</li>
<li><p>NVME</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs.vfat /dev/nvmexn1pn</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Swap-分区和-Swap-文件"><a href="#Swap-分区和-Swap-文件" class="headerlink" title="Swap 分区和 Swap 文件"></a>Swap 分区和 Swap 文件</h3><p>如果希望使用 Swap 文件替换 Swap 分区，那么在分区和挂载中不必创建和开启 Swap 分区。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>但是，使用 Swap 文件会更加复杂。因为若使用 Swap 文件在 <code>Btrfs</code> 文件系统中设置休眠（hibernate）的时候需要额外的步骤，而且可能有兼容性问题。若没有动态改变 Swap 大小的需求，建议使用 Swap 分区。</p>
</blockquote>
<p>通过以下步骤创建和挂载 Swap 文件（这一步在 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_18-%E5%AE%8C%E6%88%90%E5%AE%89%E8%A3%85">18. 完成安装</a> 步骤之后）：</p>
<ol>
<li><p>通过以下命令创建 Swap File：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1M count=16384 status=progress <span class="comment"># 创建 16G 的交换空间（大小 &gt;= 电脑实际运行内存的 60%）</span></span><br><span class="line">sudo <span class="built_in">chmod</span> 600 /swapfile <span class="comment"># 设置正确的权限</span></span><br><span class="line">sudo mkswap /swapfile <span class="comment"># 格式化 Swap 文件</span></span><br><span class="line">sudo swapon /swapfile <span class="comment"># 挂载 Swap 文件</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过以下命令挂载 Swap 文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapon /swapfile</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>free</code> 命令复查 Swap 文件挂载情况：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -h <span class="comment"># -h 选项会使输出以人类可读的单位显示</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>最后，向 <code>/etc/fstab</code> 中追加如下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/swapfile  none  swap  defaults  0 0</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="安装环境和新系统的关系"><a href="#安装环境和新系统的关系" class="headerlink" title="安装环境和新系统的关系"></a>安装环境和新系统的关系</h2><blockquote>
<p>理解安装环境和新系统的关系，对于理解 archlinux 安装时所做的步骤具有重大意义。可以说，理解了它们的关系基本上就理解了 archlinux 的安装</p>
</blockquote>
<p>为了生动形象的理解安装环境和新系统的关系，我们可以将安装系统的过程想象成搬家 🏠。</p>
<h3 id="1-建房子"><a href="#1-建房子" class="headerlink" title="1. 建房子"></a>1. 建房子</h3><p>我们可以将安装环境比喻成一个临时的家。为了住进新家，我们需要先把新家的房子建起来。这个过程就是 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_7-%E5%88%86%E5%8C%BA%E5%92%8C%E6%A0%BC%E5%BC%8F%E5%8C%96-%E4%BD%BF%E7%94%A8-btrfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">7. 分区和格式化</a>。在磁盘上建立新的分区并格式化，就好比在空余的土地上建立起新的房子。</p>
<h3 id="2-建立通道"><a href="#2-建立通道" class="headerlink" title="2. 建立通道"></a>2. 建立通道</h3><p>新房建好了，我们首先还要建立一条联通旧家和新家之间的通道 —— 不然我们怎么走到新家去呢！更不要提将家具什么的安置到新家去了。这个步骤就是 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_8-%E6%8C%82%E8%BD%BD">8. 挂载</a>。通过将新的分区挂载到 <code>/mnt</code> 下，我们才能对新的分区进行操作。</p>
<h3 id="3-添置家具"><a href="#3-添置家具" class="headerlink" title="3. 添置家具"></a>3. 添置家具</h3><p>光有一个空荡荡的房子是没有用的。为了变成一个能够生活的温馨小窝，我们还需要添置家具。这个步骤就是 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_9-%E5%AE%89%E8%A3%85%E7%B3%BB%E7%BB%9F">9. 安装系统</a>。在执行 <code>pacstrap</code> 脚本的过程中，其实就是将系统运行需要的一些基础的东西安装到新的系统中 —— 类似把家具放到新的家里。</p>
<h3 id="4-搬进新家"><a href="#4-搬进新家" class="headerlink" title="4. 搬进新家"></a>4. 搬进新家</h3><p>最后，新家建好了，装修啊、家具啊也弄好了，我们可以搬进新家了！这一步骤就是 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_11-change-root">11. change root</a>。<code>arch-chroot</code> 脚本是软件包 <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=arch-install-scripts"><code>arch-install-scripts</code></a> 的一部分，但本质上只是在 <code>chroot</code> 命令的基础上添加了一些功能，简化了“搬家”的流程。其类似（注意，只是类似，<code>arch-chroot</code> 还会做一些其它的工作，安装时请使用 <code>arch-chroot</code>）以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mount -t proc none /mnt/proc</span><br><span class="line">mount -t sysfs none /mnt/sys</span><br><span class="line">mount -o <span class="built_in">bind</span> /dev /mnt/dev</span><br><span class="line"><span class="built_in">chroot</span> /mnt bash</span><br></pre></td></tr></table></figure>

<p><code>chroot</code> 顾名思义，就是 <strong>ch</strong>ange <strong>root</strong> 的意思。<code>chroot</code> 命令把根目录换成指定的目录。通常，切换根目录一般的目的是为了系统维护，例如重装引导程序或者重置遗忘的密码；而在安装时则是为了安装（大雾 🌫️。在安装过程中，新的根目录就是 <code>/mnt</code>。这个过程就好比从原来的家搬到了新的家一样，是不是这样理解起来就简单一点了呢？</p>
<h2 id="多系统配置引导程序"><a href="#多系统配置引导程序" class="headerlink" title="多系统配置引导程序"></a>多系统配置引导程序</h2><ol>
<li><p>查看系统的安装的磁盘: </p>
<p>使用命令 <code>lsblk</code> 或 <code>fdisk -l</code> 可以列出系统中所有的硬盘和分区信息。找到你想要挂载的硬盘和分区。</p>
<p>使用 <code>fdisk -l</code>, 找到固态盘的分区情况</p>
<img data-src="/2020/06/07/106/image-20231231101859855.png" class="" title="image-20231231101859855">
</li>
<li><p>挂载磁盘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/nvme0n1p1 /mnt/win/</span><br><span class="line">mount /dev/nvme0n1p4 /mnt/ubuntu/</span><br></pre></td></tr></table></figure>

<blockquote>
<p>提示:</p>
<ol>
<li><p>你可以使用 <code>blkid</code> 命令来查看系统上的块设备（包括硬盘和分区）以及它们的文件系统类型。如: <code>sudo blkid /dev/sda1</code></p>
</li>
<li><p>archlinux unkonwn fillesystem type ntfs</p>
<p>系统缺少对 NTFS 文件系统的支持。在Arch Linux中，通常可以通过安装 <code>ntfs-3g</code> 包来添加对 NTFS 文件系统的支持。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Sy</span><br><span class="line">sudo pacman -S ntfs-3g</span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
</li>
<li><p>安装引导程序: <code>grub-mkconfig -o /boot/grub/grub.cfg</code></p>
</li>
<li><p>卸载磁盘</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount -R /mnt/*</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启: <code>reboot</code></p>
</li>
</ol>
<h2 id="杂七杂八-QAs"><a href="#杂七杂八-QAs" class="headerlink" title="杂七杂八 + QAs"></a>杂七杂八 + QAs</h2><p>其它琐碎的问题不在一一展开叙述，这里通过列表统一说明：</p>
<ol>
<li><p>EFI 分区（又称 esp 分区）不一定要挂载在 <code>/boot</code> 目录下；也可以是 <code>/efi</code> 或者其他非常见路径（当然一般推荐挂载在 <code>/boot</code> 下，方便引导程序读取同样在这个目录下的内核、微码等启动系统的必要文件）</p>
</li>
<li><p>若为<strong>联想小新 Pro14 &#x2F; YOGA 14s 2021</strong> 机型，发现安装前后键盘都无法正常工作。此时安装时请使用外接键盘。为了解决该问题，在 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_17-%E5%AE%89%E8%A3%85%E5%BC%95%E5%AF%BC%E7%A8%8B%E5%BA%8F">17. 安装引导程序</a> 步骤中编辑 <code>/etc/default/grub</code> 文件时添加额外的 GRUB 参数 —— 在 <code>GRUB_CMDLINE_LINUX_DEFAULT</code> 这一行中添加参数 <code>i8042.dumbkbd</code></p>
<p>修改后复查：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head /etc/default/grub</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># GRUB boot loader configuration</span><br><span class="line"></span><br><span class="line">GRUB_DEFAULT_SUBMENU=y</span><br><span class="line">GRUB_DEFAULT=saved</span><br><span class="line">GRUB_SAVEDEFAULT=true</span><br><span class="line">GRUB_TIMEOUT=2</span><br><span class="line">GRUB_DISTRIBUTOR=&quot;Arch&quot;</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;loglevel=5 nowatchdog i8042.dumbkbd&quot;</span><br><span class="line">GRUB_CMDLINE_LINUX=&quot;&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Q: EFI分区写入失败: EFI扩容</strong></p>
<ol>
<li><p>右键单击EFI盘并选择“<strong>调整分区大小</strong>”。</p>
<img data-src="/2020/06/07/106/resize-partition-efi.png" class="" title="调整EFI分区">
</li>
<li><p>通过向右拖动滑块来扩展系统分区。</p>
<img data-src="/2020/06/07/106/drage-efi-partition.png" class="" title="移动EFI分区">
</li>
<li><p>返回主菜单，点击“<strong>提交</strong>”执行挂起的操作。</p>
<img data-src="/2020/06/07/106/apply.png" class="" title="提交"></li>
</ol>
</li>
</ol>
<h1 id="桌面环境与常用应用安装"><a href="#桌面环境与常用应用安装" class="headerlink" title="桌面环境与常用应用安装"></a>桌面环境与常用应用安装</h1><blockquote>
<p>两岸猿声啼不住，轻舟已过万重山</p>
<p>没有图形界面的 archlinux 显然作为日常使用的操作系统是不合适的。但经过这一节的安装和配置后，我们的系统就可以当作日常的操作系统使用了</p>
</blockquote>
<p>这一小节，我们开始着手安装桌面环境和一些常用的软件。如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/General_recommendations_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">ArchWiki 一般性建议</a>。</p>
<blockquote>
<p>ℹ️ 提示</p>
<p>指南中带有 aur 角标的软件代表是在 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/">AUR</a>（Arch User Repository）中用户自行打包的软件。不在 arch 官方支持范围内，可能会出现各种问题如更新不及时、无法安装、使用出错等。</p>
<p>指南中带有 cn 角标的软件代表是在 <a target="_blank" rel="noopener" href="https://www.archlinuxcn.org/archlinux-cn-repo-and-mirror/">archlinuxcn</a>（Arch Linux 中文社区仓库）中用户自行打包的软件。不在 arch 官方支持范围内，可能会出现各种问题如更新不及时、无法安装、使用出错等。</p>
<p>指南中带有 EULA 角标的软件代表是 <a target="_blank" rel="noopener" href="https://www.gnu.org/proprietary/proprietary.html">专有软件</a>。请自行斟酌是否使用。</p>
</blockquote>
<h2 id="确保系统为最新"><a href="#确保系统为最新" class="headerlink" title="确保系统为最新"></a>确保系统为最新</h2><p>如果你在做完章节 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html">archlinux 基础安装</a> 的内容后，关机并放置过一段时间，那么需要先按照 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_18-%E5%AE%8C%E6%88%90%E5%AE%89%E8%A3%85">18. 完成安装</a> 中连接网络的方法重新连网，然后使用以下命令更新系统：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -Syu # 升级系统中全部包</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_update.457f4324.png" class="" title="update">

<h2 id="配置-root-账户的默认编辑器"><a href="#配置-root-账户的默认编辑器" class="headerlink" title="配置 root 账户的默认编辑器"></a>配置 root 账户的默认编辑器</h2><p>默认情况下，archlinux 在一些终端编辑场景调用 <code>vi</code> 编辑器，但是我们使用 <code>vim</code> 编辑器。</p>
<p>如果不做额外配置且不显式的指定编辑器，在一些终端场景下（如下面的 <code>visudo</code>、<code>git</code> 等）调用编辑器时会出错。</p>
<ol>
<li>使用 <code>vim</code> 编辑 <code>~/.bash_profile</code> 文件：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure>

<p>在适当位置加入以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export EDITOR=&#x27;vim&#x27;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ℹ️ 提示</p>
<p>也可以添加到 <code>~/.bashrc</code> 中，但是（如果不做其它配置或显式的执行）在登录命令行 <code>tty</code> 后不会被执行，也就失去了意义。</p>
<p>一般来说我们登录 root 账户时很可能是在命令行 <code>tty</code> 登录的（有时也会 <code>su</code>）。</p>
</blockquote>
<ol>
<li>保存并退出 <code>vim</code></li>
</ol>
<h2 id="准备非-root-用户"><a href="#准备非-root-用户" class="headerlink" title="准备非 root 用户"></a>准备非 root 用户</h2><ol>
<li><p>通过以下命令添加用户，比如新增加的用户叫 <code>myusername</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -m -G wheel -s /bin/bash myusername</span><br></pre></td></tr></table></figure>

<blockquote>
<p>📑 命令参数说明：</p>
<ul>
<li><p><code>-m</code> 创建用户的同时创建用户家目录</p>
</li>
<li><p><code>-G</code>选项后指定附加组</p>
<ul>
<li><code>wheel</code> —— <code>wheel</code> 附加组可 <code>sudo</code> 进行提权</li>
</ul>
</li>
<li><p><code>-s</code> 选项后指定 shell 程序</p>
</li>
<li><p><code>myusername</code> —— 用户名（<strong>请自定义</strong>，但不要包含空格和特殊字符）</p>
</li>
</ul>
</blockquote>
</li>
<li><p>通过以下命令根据提示设置新用户 <code>myusername</code> 的密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd myusername</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ℹ️ 提示</p>
<p>弱密码已经不被接受，请设置一个较为复杂的密码，如 <code>i_love_archlinux</code>。</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_add-user.4be22c6e.png" class="" title="add-user">
</blockquote>
</li>
<li><p>使用 <code>vim</code> 编辑器通过 <code>visudo</code> 命令编辑 <code>sudoers</code> 文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EDITOR=vim visudo # 这里需要显式的指定编辑器，因为上面的环境变量还未生效</span><br></pre></td></tr></table></figure>
</li>
<li><p>找到如下这样的一行，把前面的注释符号 <code>#</code> 去掉：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#%wheel ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_visudo.d1333ce0.png" class="" title="visudo">

<blockquote>
<p>📑 这里稍微解释一下：</p>
<ul>
<li><code>%wheel</code> —— 用户名或用户组，此处则代表是 <code>wheel</code> 组，<code>%</code> 是用户组的前缀</li>
<li><code>ALL=</code> —— 主机名，此处则代表在所有主机上都生效（如果把同样的 <code>sudoers</code> 文件下发到了多个主机上）</li>
<li><code>(ALL:ALL)</code> —— (任意用户:任意用户组)，此处则代表可以成为任意目标用户&#x2F;用户组</li>
<li>最后的 <code>ALL</code> —— 代表可以执行任意命令</li>
</ul>
<p>几个更详细的例子:</p>
<ol>
<li>在 <code>mailadmin</code> 组里的用户可以作为 <code>root</code> 用户，在 <code>snow</code> 和 <code>rain</code> 这两台主机执行一些邮件服务器控制命令（命令之间用 <code>,</code> 分隔）：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%mailadmin  snow,rain=(root)  /usr/sbin/postfix, /usr/sbin/postsuper, /usr/bin/doveadm</span><br></pre></td></tr></table></figure>

<ol>
<li>用户 <code>whoami</code> 可以在所有主机上以 <code>root</code> 用户不输入密码执行 <code>rndc reload</code> 这条命令（正常来说 <code>sudo</code> 都是要求输入调用方的密码的）：</li>
</ol>
<p>sudoers</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whoami  ALL=(root)  NOPASSWD: /usr/sbin/rndc reload</span><br></pre></td></tr></table></figure>

<ol>
<li>当在 <code>users</code> 组里的用户以 <code>sudo passwd</code> 或者 <code>sudo passwd root</code> 方式运行命令的时候，可以直接把 <code>root</code> 用户的密&gt; 码 改掉，这真是太危险了！必须要把这两条命令禁止掉，但我们又希望用户可以通过 <code>sudo passwd</code> 修改其它用户的密码。那么我们可以在命令前面加上 <code>!</code> 来表示不可执行的命令：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%users  ALL=(root)  !/usr/bin/passwd, /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd root</span><br></pre></td></tr></table></figure>

<p>总结一下，语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用户名/%用户组名 主机名=(目标用户名) 命令1, 命令2, !命令3</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>保存并退出 <code>vim</code> 编辑器</p>
</li>
</ol>
<h2 id="开启-32-位支持库与-Arch-Linux-中文社区仓库（archlinuxcn）"><a href="#开启-32-位支持库与-Arch-Linux-中文社区仓库（archlinuxcn）" class="headerlink" title="开启 32 位支持库与 Arch Linux 中文社区仓库（archlinuxcn）"></a>开启 32 位支持库与 Arch Linux 中文社区仓库（archlinuxcn）</h2><ol>
<li><p>编辑 <code>/etc/pacman.conf</code> 文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pacman.conf</span><br></pre></td></tr></table></figure>
</li>
<li><p>去掉 <code>[multilib]</code> 一节中两行的注释，来开启 32 位库支持</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_multilib.26b3c128.png" class="" title="multilib">
</li>
<li><p>在文档结尾处加入下面的文字，来添加 <code>archlinuxcn</code> 源。推荐的镜像源（选一个即可）也一并列出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch # 中国科学技术大学开源镜像站</span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch # 清华大学开源软件镜像站</span><br><span class="line">Server = https://mirrors.hit.edu.cn/archlinuxcn/$arch # 哈尔滨工业大学开源镜像站</span><br><span class="line">Server = https://repo.huaweicloud.com/archlinuxcn/$arch # 华为开源镜像站</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_archlinuxcn.9cf33e22.png" class="" title="archlinuxcn">

<blockquote>
<p>ℹ️ 提示</p>
<p>此外，还有其它镜像源在 <a target="_blank" rel="noopener" href="https://github.com/archlinuxcn/mirrorlist-repo#arch-linux-cn-community-repo-mirrors-list">archlinuxcn 官方 Github Repo</a> 列出，可以根据自己实际情况另行选择。</p>
<p>archlinuxcn 仓库服务器位于欧洲，在中国大陆、中国香港、美国有镜像。</p>
<ol>
<li>保存并退出 <code>vim</code> 编辑器</li>
<li>通过以下命令刷新 <code>pacman</code> 数据库并更新：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -Syyu</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_syyu.5317b0de.png" class="" title="syyu"></blockquote>
</li>
</ol>
<h2 id="安装-KDE-Plasma-桌面环境"><a href="#安装-KDE-Plasma-桌面环境" class="headerlink" title="安装 KDE Plasma 桌面环境"></a>安装 KDE Plasma 桌面环境</h2><blockquote>
<p>ℹ️ 提示</p>
<p>新手推荐安装 KDE Plasma 桌面环境，此外有 GNOME、 Xfce 等<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Desktop_environment">桌面环境</a>和一众<a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/Window_manager">窗口管理器</a>可供选择。本教程仅列出 KDE 安装使用教程。</p>
</blockquote>
<ol>
<li><p>通过以下命令安装相关软件包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S plasma-meta konsole dolphin # plasma-meta 元软件包、konsole 终端模拟器和 dolphin 文件管理器</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_install-kde.8c320ccd.png" class="" title="install-kde">
</li>
<li><p>kde 默认安装的是<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/zh-hans/Xorg">xorg</a>，如果想使用<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/Wayland">wayland</a>的话安装以下包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pacman -S  plasma-wayland-session xdg-desktop-portal</span><br><span class="line"># N卡用户需要额外安装egl-wayland,xdg-desktop-portal包是为了如obs此类工具录制屏幕使用</span><br><span class="line"># xdg-desktop-portal包组提供了不同环境下使用的软件包</span><br><span class="line"># 例如kde用户可选择xdg-desktop-portal-kde包</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装完成后，可以在后续登录时选择使用 xorg 还是 wayland</p>
</li>
</ol>
<h2 id="配置并启动-greeter-sddm"><a href="#配置并启动-greeter-sddm" class="headerlink" title="配置并启动 greeter sddm"></a>配置并启动 greeter sddm</h2><ol>
<li><p>开启 sddm.service 守护进程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable sddm</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过以下命令启动显示管理器或重启电脑，即可看到欢迎界面：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start sddm  # 直接启动显示管理器，与以下reboot命令二选一即可</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p><img data-src="https://arch.icekylin.online/assets/desktop-env-and-app_sign-in.f000e4d3.png" alt="sign-in"></p>
</li>
<li><p>输入新用户的密码并回车 <code>Enter</code> 即可登录桌面</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_desktop.0a567cbc.png" class="" title="desktop">

<blockquote>
<p>ℹ️ 提示</p>
<p>若虚拟机下在 sddm 输入密码登录后无法进入桌面，只有黑屏和光标，请确认在步骤 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/pre-virt.html#_3-%E9%85%8D%E7%BD%AE-virtualbox">3. 配置 VirtualBox</a> 中<strong>没有</strong>勾选 <code>启用3D加速</code>。</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_sddm.38c7878b.png" class="" title="enable-sddm">
</blockquote>
<blockquote>
<p>ℹ️ 提示</p>
<p>值得注意的是此时操作系统尚未安装相应的显卡驱动。如在进入桌面环境时遭遇闪退花屏等意外情况，建议尝试安装相应的显卡驱动。详情请参阅<a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/graphic-driver.html">显卡驱动</a>。</p>
</blockquote>
</li>
</ol>
<h2 id="安装基础功能包"><a href="#安装基础功能包" class="headerlink" title="安装基础功能包"></a>安装基础功能包</h2><ol>
<li><p>进入桌面后，在开始菜单搜索并打开 Konsole。它是 KDE 桌面环境默认的终端模拟器</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_konsole.5943a6a3.png" class="" title="konsole">
</li>
<li><p>首先进行桌面环境中的网络设置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping www.bilibili.com # 测试网络连通性</span><br></pre></td></tr></table></figure>

<p>KDE 桌面环境中连接网络和 win10 一样，这里不再赘述。</p>
</li>
<li><p>接下来安装一些基础功能包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S sof-firmware alsa-firmware alsa-ucm-conf # 声音固件</span><br><span class="line">sudo pacman -S ntfs-3g # 使系统可以识别 NTFS 格式的硬盘</span><br><span class="line">sudo pacman -S adobe-source-han-serif-cn-fonts wqy-zenhei # 安装几个开源中文字体。一般装上文泉驿就能解决大多 wine 应用中文方块的问题</span><br><span class="line">sudo pacman -S noto-fonts noto-fonts-cjk noto-fonts-emoji noto-fonts-extra # 安装谷歌开源字体及表情</span><br><span class="line">sudo pacman -S firefox chromium # 安装常用的火狐、chromium 浏览器</span><br><span class="line">sudo pacman -S ark # 压缩软件。在 dolphin 中可用右键解压压缩包</span><br><span class="line">sudo pacman -S packagekit-qt5 packagekit appstream-qt appstream # 确保 Discover（软件中心）可用，需重启</span><br><span class="line">sudo pacman -S gwenview # 图片查看器</span><br><span class="line">sudo pacman -S steam # 游戏商店。稍后看完显卡驱动章节再使用</span><br></pre></td></tr></table></figure>
</li>
<li><p>最后执行安装 <code>archlinuxcn</code> 源所需的相关步骤：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S archlinuxcn-keyring # cn 源中的签名（archlinuxcn-keyring 在 archlinuxcn）</span><br><span class="line">sudo pacman -S yay # yay 命令可以让用户安装 AUR 中的软件（yay 在 archlinuxcn）</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ℹ️ 提示</p>
<p>若安装 <code>archlinuxcn-keyring</code> 时报错，是由于密钥环的问题。可先按照 <a target="_blank" rel="noopener" href="https://www.archlinuxcn.org/gnupg-2-1-and-the-pacman-keyring/">archlinuxcn 官方说明</a> 执行其中的命令，再安装 <code>archlinuxcn-keyring</code>。</p>
<p><code>archlinuxcn</code> 社区源的 <code>keyring</code> 包 <code>archlinuxcn-keyring</code> 由 <code>farseerfc</code> 的 key 签署验证，而 <code>Arch Linux</code> 官方 <code>keyring</code> 中包含了 farseerfc 的 key 。自 12 月初 <code>archlinux-keyring</code> 中删除了一个退任的 <a target="_blank" rel="noopener" href="https://gitlab.archlinux.org/archlinux/archlinux-keyring/-/issues/246">master key</a> 导致 <code>farseerfc</code> 的 key 的信任数不足，由 <code>GnuPG</code> 的 <code>web of trust</code> 推算为 <code>marginal trust</code>，从而不再能自动信任 <code>archlinuxcn-keyring</code> 包的签名。</p>
<p>如果你在新系统中尝试安装 <code>archlinuxcn-keyring</code> 包时遇到如下报错：</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error: archlinuxcn-keyring: Signature from &quot;Jiachen YANG (Arch Linux Packager Signing Key) &lt;farseerfc@archlinux.org&gt;&quot; is marginal trust</span><br></pre></td></tr></table></figure>

<p>请使用以下命令在本地信任 <code>farseerfc 的 key</code> 。此 <code>key</code> 已随 <code>archlinux-keyring</code> 安装在系统中，只是缺乏信任：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman-key --lsign-key &quot;farseerfc@archlinux.org&quot;</span><br></pre></td></tr></table></figure>

<p>之后继续安装 <code>archlinuxcn-keyring</code> ： <code>sudo pacman -S archlinuxcn-keyring</code><a target="_blank" rel="noopener" href="https://www.archlinuxcn.org/archlinuxcn-keyring-manually-trust-farseerfc-key/">https://www.archlinuxcn.org/archlinuxcn-keyring-manually-trust-farseerfc-key/</a></p>
</li>
</ol>
<h2 id="检查家目录"><a href="#检查家目录" class="headerlink" title="检查家目录"></a>检查家目录</h2><p>检查家目录下的各个常见目录是否已经创建，若没有则需通过以下命令手动创建：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">ls -hl</span><br><span class="line">mkdir Desktop Documents Downloads Music Pictures Videos</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_mkdir.93abe33a.png" class="" title="mkdir">

<h2 id="配置非-root-账户的默认编辑器"><a href="#配置非-root-账户的默认编辑器" class="headerlink" title="配置非 root 账户的默认编辑器"></a>配置非 root 账户的默认编辑器</h2><ol>
<li>使用 <code>vim</code> 编辑 <code>~/.bashrc</code> 文件：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure>
<ol>
<li>在适当位置加入以下内容：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export EDITOR=&#x27;vim&#x27;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ℹ️ 提示</p>
<p>也可以添加到 <code>~/.bash_profile</code> 中。</p>
</blockquote>
<h2 id="设置系统为中文"><a href="#设置系统为中文" class="headerlink" title="设置系统为中文"></a>设置系统为中文</h2><ol>
<li><p>打开 <code>System Settings</code> &gt; <code>Language and Regional Settings</code> &gt; 在 <code>Language</code> 中点击 <code>Add languages...</code> &gt; 选择中文加入 <code>ADD</code>，再拖拽到第一位 &gt; 点击 <code>Apply</code></p>
<img data-src="/2020/06/07/106/desktop-env-and-app_language.166a6bff.png" class="" title="language">
</li>
<li><p>注销并重新登陆即可生效</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_effect.007423fd.png" class="" title="language-effect"></li>
</ol>
<p>ℹ️ 提示</p>
<p>很多人会错误的更改 <code>System Settings</code> &gt; <code>Regional Settings</code> &gt; <code>Formats</code> 中的值为中文蒙古、默认或者其他值。这会导致系统中一半英文一半中文。这里的值要保持默认的 <code>en_US</code> 或 <code>zh_CN</code>，或者改为你在 <code>locale.gen</code> 中添加的任意一种语言。</p>
<h2 id="安装输入法"><a href="#安装输入法" class="headerlink" title="安装输入法"></a>安装输入法</h2><p>如有需要可以参阅 <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Fcitx5 官方文档</a>。</p>
<ol>
<li><p>通过以下命令安装相关软件包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S fcitx5-im # 输入法基础包组</span><br><span class="line">sudo pacman -S fcitx5-chinese-addons # 官方中文输入引擎</span><br><span class="line">sudo pacman -S fcitx5-anthy # 日文输入引擎</span><br><span class="line">sudo pacman -S fcitx5-pinyin-moegirl # 萌娘百科词库。二刺猿必备（archlinuxcn）</span><br><span class="line">sudo pacman -S fcitx5-material-color # 输入法主题</span><br></pre></td></tr></table></figure>
</li>
<li><p>此外，我们还需要设置环境变量。通过 <code>vim</code> 编辑文件 <code>/etc/environment</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/environment</span><br></pre></td></tr></table></figure>
</li>
<li><p>在文件中加入以下内容并保存退出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GTK_IM_MODULE=fcitx</span><br><span class="line">QT_IM_MODULE=fcitx</span><br><span class="line">XMODIFIERS=@im=fcitx</span><br><span class="line">SDL_IM_MODULE=fcitx</span><br><span class="line">GLFW_IM_MODULE=ibus</span><br></pre></td></tr></table></figure>

<img data-src="/2020/06/07/106/desktop-env-and-app_fcitx5-1.12c3b346.png" class="" title="fcitx5_step-1">

<p>Konsole 以及 Dolphin 都需要这些环境变量，倒是 Firefox 和 Chromium 都不需要就可以输入中文。</p>
<blockquote>
<p>ℹ️ 提示</p>
<ol>
<li>如果使用 Wayland 而非 X11，请参照如下方式进行配置而非上面的配置方法：</li>
</ol>
<blockquote>
<p>在「系统设置 - 输入设备 - 虚拟键盘」中选中 Fcitx 5；<code>environment</code> 仅保留 <code>XMODIFIERS=@im=fcitx</code> 一行；在基于 Chromium 的程序（包括浏览器和使用 Electron 的程序）中加入 <code>--enable-features=UseOzonePlatform --ozone-platform=wayland --enable-wayland-ime</code> 启动参数。</p>
</blockquote>
<ol>
<li>检查一下是否有拼写错误，如果输入法无法正常切换，可尝试执行 <code>fcitx5-diagnose</code> 命令来诊断问题的原因。</li>
</ol>
<p>由于存在<a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4708">安全性问题</a>，自 2022 年 10 月 21 日起，<a target="_blank" rel="noopener" href="https://github.com/archlinux/svntogit-packages/commit/891610cfcc202916cf5eb46d6df56e885062f78e">Arch Linux 默认不再读取</a> <code>~/.pam_environment</code> 文件中的设置。</p>
</blockquote>
</li>
<li><p>打开 <code>系统设置</code> &gt; <code>区域设置</code> &gt; <code>输入法</code></p>
</li>
<li><p>点击提示信息中的 <code>运行 Fcitx</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_fcitx5-2.f9355fb6.png" class="" title="fcitx5_step-2">
</li>
<li><p>点击 <code>添加输入法</code> &gt; 找到简体中文下的 <code>Pinyin</code> &gt; 点击 <code>添加</code> 即可加入拼音输入法：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_fcitx5-3.3c06dd53.png" class="" title="fcitx5_step-3">
</li>
<li><p>接下来点击 <code>Pinyin</code> 右侧的配置按钮 &gt; 点选 <code>云拼音</code> 和 <code>在程序中显示预编辑文本</code> &gt; 最后点击 <code>应用</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_fcitx5-4.9b027a55.png" class="" title="fcitx5_step-4">
</li>
<li><p>回到输入法设置 &gt; 点击 <code>配置附加组件</code> &gt; 找到 <code>Classic User Interface</code> &gt; 在主题里选择一个你喜欢的颜色 &gt; 最后点击 <code>应用</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_fcitx5-5.cc71ac31.png" class="" title="fcitx5_step-5">
</li>
<li><p>注销并重新登陆，发现已经可以在各个软件中输入中文了：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_fcitx5-6.63c4d105.png" class="" title="fcitx5_step-6"></li>
</ol>
<blockquote>
<p>ℹ️ 提示</p>
<p>通过 <code>Ctrl</code> + <code>空格</code> 切换中英文输入。</p>
</blockquote>
<h2 id="启动蓝牙（若有）"><a href="#启动蓝牙（若有）" class="headerlink" title="启动蓝牙（若有）"></a>启动蓝牙（若有）</h2><p>通过以下命令开启蓝牙相关服务并设置开机自动启动：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable --now bluetooth</span><br></pre></td></tr></table></figure>

<h2 id="设置-Timeshift-快照"><a href="#设置-Timeshift-快照" class="headerlink" title="设置 Timeshift 快照"></a>设置 Timeshift 快照</h2><ol>
<li><p>通过以下命令安装 Timeshiftcn &#x2F; aur：</p>
<ul>
<li><p>cn</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S timeshift</span><br></pre></td></tr></table></figure>
</li>
<li><p>aur</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S aur/timeshift</span><br></pre></td></tr></table></figure></li>
</ul>
<img data-src="/2020/06/07/106/desktop-env-and-app_timeshift-install.e7a38ed8.png" class="" title="timeshift-install">

<blockquote>
<p>ℹ️ 提示</p>
<p>若安装 AUR 时无法正常下载，请先参照章节 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/transparent.html">透明代理</a> 配置透明代理。</p>
</blockquote>
</li>
<li><p>打开 Timeshift，第一次启动会自动启动设置向导</p>
</li>
</ol>
<h3 id="若使用-Btrfs-文件系统"><a href="#若使用-Btrfs-文件系统" class="headerlink" title="若使用 Btrfs 文件系统"></a>若使用 Btrfs 文件系统</h3><p>若按照步骤 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_7-%E5%88%86%E5%8C%BA%E5%92%8C%E6%A0%BC%E5%BC%8F%E5%8C%96-%E4%BD%BF%E7%94%A8-btrfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">7. 分区和格式化（使用 Btrfs 文件系统）</a> 使用的 Btrfs 文件系统，则进行如下操作。</p>
<ol>
<li><p>快照类型选择 <code>BTRFS</code>，点击 <code>下一步</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_timeshift-cfg-1.c882772d.png" class="" title="timeshift-config_step-1">
</li>
<li><p>快照位置选择 <code>BTRFS</code> 分区，点击 <code>下一步</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_timeshift-cfg-2.9d0b654b.png" class="" title="timeshift-config_step-2">

<blockquote>
<p>ℹ️ 提示</p>
<p>Timeshift 只支持快照操作系统安装在具有 Ubuntu 类型的子卷布局（<code>@</code> 和 <code>@home</code> 子卷）的 BTRFS 分区。</p>
<p>若此处提示不支持的子卷布局，请确保按照步骤 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/rookie/basic-install.html#_7-%E5%88%86%E5%8C%BA%E5%92%8C%E6%A0%BC%E5%BC%8F%E5%8C%96-%E4%BD%BF%E7%94%A8-btrfs-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F">7. 分区和格式化（使用 Btrfs 文件系统）</a> 的说明分区。</p>
</blockquote>
</li>
<li><p>选择快照计划，点击 <code>下一步</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_timeshift-cfg-3.a0e8464e.png" class="" title="timeshift-config_step-3">

<blockquote>
<p>ℹ️ 提示</p>
<p>由于 BTRFS 类型快照占用空间相对较小，可以适当提高快照数量。</p>
</blockquote>
</li>
<li><p>若希望 <code>/home</code> 用户主目录也快照，则勾选在备份中包含 <code>@home</code> 子卷，然后点击 <code>下一步</code>：</p>
<img data-src="/2020/06/07/106/desktop-env-and-app_timeshift-cfg-4.72089020.png" class="" title="timeshift-config_step-4">
</li>
<li><p>点击 <code>完成</code> 结束配置</p>
<blockquote>
<p>⚠️ 注意</p>
<p>完成后建议执行下述指令删除 <code>subvolid</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sed -i -E &#x27;s/(subvolid=[0-9]+,)|(,subvolid=[0-9]+)//g&#x27; /etc/fstab</span><br></pre></td></tr></table></figure>

<p>否则，恢复 BTRFS 类型快照时，可能因子卷 ID 改变导致无法正常进入系统，参阅 <a target="_blank" rel="noopener" href="https://arch.icekylin.online/guide/advanced/system-ctl.html#%E6%81%A2%E5%A4%8D%E5%90%8E%E6%97%A0%E6%B3%95%E6%8C%82%E8%BD%BD%E7%9B%AE%E5%BD%95">恢复后无法挂载目录</a>。</p>
</blockquote>
</li>
</ol>
<h3 id="若使用-ext4-文件系统"><a href="#若使用-ext4-文件系统" class="headerlink" title="若使用 ext4 文件系统"></a>若使用 ext4 文件系统</h3><p>若使用的为传统的 ext4 文件系统，则进行如下操作。</p>
<ol>
<li>快照类型选择 <code>RSYNC</code>，点击 <code>下一步</code></li>
<li>快照位置选择较大的分区，快照将保存在此分区的 <code>/timeshift</code> 目录下</li>
<li>选择快照计划，点击 <code>下一步</code></li>
</ol>
<blockquote>
<p>ℹ️ 提示</p>
<p>由于 RSYNC 类型快照占用空间较大，请不要保存过多的历史快照。</p>
<ol>
<li><code>/home</code> 用户主目录可选全部包含，或者<strong>选择排除一切，在下一项中进行更详细配置</strong>。其中 <code>root</code> 默认全备份（即使选择排除一切）</li>
<li>若用户主目录选择排除一切，在包含&#x2F;排除模式中建议进行如下配置（注意顺序，可拖拽移动顺序）：<ul>
<li><code>+ /home/user/.config/***</code>（注意是 <code>***</code>）</li>
<li><code>+ /home/user/.local/***</code></li>
<li><code>- /home/user/.**</code></li>
<li><code>- /home/user/**</code></li>
<li><code>- /root/**</code></li>
</ul>
</li>
<li>点击 <code>完成</code> 结束配置</li>
</ol>
</blockquote>
<p>自此，Timeshift 快照已经成功设置。Timeshift 将按照计划快照系统并删除久远的快照。Timeshift 快照为系统增加了一层保障。</p>
<h2 id="太棒了"><a href="#太棒了" class="headerlink" title="太棒了"></a>太棒了</h2><p>自此，一个可以当作日常系统使用的 archlinux 已经基本配置完成了！KDE 桌面环境经过了多年的迭代更新，已经非常完善和强大了，将 archlinux 作为日常使用的主力系统不在话下。</p>
<blockquote>
<p>参考自<a target="_blank" rel="noopener" href="https://arch.icekylin.online/">arch.icekylin.online</a></p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Qeuroal
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://qeuroal.top/2020/06/07/106/" title="106. ArchLinux安装与配置">http://qeuroal.top/2020/06/07/106/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"><i class="fa fa-tag"></i> linux</a>
              <a href="/tags/archlinux/" rel="tag"><i class="fa fa-tag"></i> archlinux</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/06/06/105/" rel="prev" title="105. UEFI引导修复">
                  <i class="fa fa-angle-left"></i> 105. UEFI引导修复
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/09/08/108/" rel="next" title="108. Ubuntu给ss.AppImage创建快捷方式">
                  108. Ubuntu给ss.AppImage创建快捷方式 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Qeuroal</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Qeuroal" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.24/fancybox/fancybox.umd.js" integrity="sha256-oyhjPiYRWGXaAt+ny/mTMWOnN1GBoZDUQnzzgC7FRI4=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
